<div class="card card-body card-form">
    <form (ngSubmit)="onSubmitRessourcesFinancieresFoyerForm(ressourcesFinancieresFoyerForm)"
        [ngClass]="{'submitted':isRessourcesFinancieresFoyerFormSubmitted}" #ressourcesFinancieresFoyerForm="ngForm">
        <div class="form-group">
            <div class="form-group" *ngIf="deConnecteBeneficiaireAidesService.hasFoyerRSA()">
                <div class="row mb-2">
                    <label class="label headline-4-typo" for="allocationRSA">
                        * RSA (Revenu de Solidarité Active) perçu
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <input id="allocationRSA" name="allocationRSA" type="text"
                            data-testid="input-allocation-mensuelle-net-rsa-foyer"
                            pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                            (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" min="0"
                            maxlength="8" class="form-control d-inline"
                            [ngClass]="{'ng-invalid': this.ressourcesFinancieres.aidesCAF.allocationRSA && this.ressourcesFinancieres.aidesCAF.allocationRSA == 0}"
                            [(ngModel)]="ressourcesFinancieres.aidesCAF.allocationRSA" required placeholder="Montant"
                            inputmode="decimal" #allocationRSA="ngModel">
                        <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                    </div>
                </div>
                <span
                    *ngIf="this.ressourcesFinancieres.aidesCAF.allocationRSA && (this.ressourcesFinancieres.aidesCAF.allocationRSA == 0)"
                    class="row error-input-message">
                    {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
                </span>
                <span class="row error-input-message"
                    *ngIf="(isRessourcesFinancieresFormSubmitted || allocationRSA.touched)  && allocationRSA.errors?.required">
                    {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                </span>
                <span class="row error-input-message"
                    *ngIf="(isRessourcesFinancieresFormSubmitted || allocationRSA.touched)  && allocationRSA.errors?.pattern">
                    {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_2}}
                </span>
            </div>
            <div class="form-group">
                <div class="row mb-2">
                    <label class="label headline-4-typo" for="allocationRSA">
                        * Concernant votre logement, vous êtes :
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <label id="btn-situation-locataire-non-meuble" name="isLocataireNonMeuble"
                            aria-label="Vous êtes locataire d'un logement non meublé" class="radio-button-style-1"
                            data-testid="btn-situation-locataire-non-meuble"
                            [(ngModel)]="this.informationsPersonnelles.logement.statutOccupationLogement.isLocataireNonMeuble"
                            btnCheckbox tabindex="0" role="button" #isLocataireNonMeuble="ngModel"
                            (click)="onClickCheckBoxIsLocataireNonMeuble()"
                            (keyup)="handleKeyUpOnButtonStatutOccupationLogement($event, statutOccupationLogementEnum.LOCATAIRE_VIDE)">
                            <div>
                                <span class="body-2-typo">{{statutOccupationLogementLibelleEnum.LOCATAIRE_VIDE}}</span>
                            </div>
                        </label>
                        <label id="btn-situation-locataire-meuble" name="isLocataireMeuble"
                            aria-label="Vous êtes locataire d'un logement meublé" class="radio-button-style-1"
                            data-testid="btn-situation-locataire-meuble"
                            [(ngModel)]="this.informationsPersonnelles.logement.statutOccupationLogement.isLocataireMeuble"
                            btnCheckbox tabindex="0" role="button" #isLocataireMeuble="ngModel"
                            (click)="onClickCheckBoxIsLocataireMeuble()"
                            (keyup)="handleKeyUpOnButtonStatutOccupationLogement($event, statutOccupationLogementEnum.LOCATAIRE_MEUBLE)">
                            <div>
                                <span
                                    class="body-2-typo">{{statutOccupationLogementLibelleEnum.LOCATAIRE_MEUBLE}}</span>
                            </div>
                        </label>
                        <label id="btn-situation-locataire-hlm" name="isLocataireHLM"
                            aria-label="Vous êtes locataire d'un HLM" class="radio-button-style-1"
                            data-testid="btn-situation-locataire-hlm"
                            [(ngModel)]="this.informationsPersonnelles.logement.statutOccupationLogement.isLocataireHLM"
                            btnCheckbox tabindex="0" role="button" #isLocataireHLM="ngModel"
                            (click)="onClickCheckBoxIsLocataireHLM()"
                            (keyup)="handleKeyUpOnButtonStatutOccupationLogement($event, statutOccupationLogementEnum.LOCATAIRE_HLM)">
                            <div>
                                <span class="body-2-typo">{{statutOccupationLogementLibelleEnum.LOCATAIRE_HLM}}</span>
                            </div>
                        </label>
                        <label id="btn-situation-proprietaire-avec-emprunt" name="isProprietaireAvecEmprunt"
                            aria-label="Vous êtes propriétaire avec emprunt" class="radio-button-style-1"
                            data-testid="btn-situation-proprietaire-avec-emprunt"
                            [(ngModel)]="this.informationsPersonnelles.logement.statutOccupationLogement.isProprietaireAvecEmprunt"
                            btnCheckbox tabindex="0" role="button" #isProprietaireAvecEmprunt="ngModel"
                            (click)="onClickCheckBoxIsProprietaireAvecEmprunt()"
                            (keyup)="handleKeyUpOnButtonStatutOccupationLogement($event, statutOccupationLogementEnum.PROPRIETAIRE_AVEC_EMPRUNT)">
                            <div>
                                <span
                                    class="body-2-typo">{{statutOccupationLogementLibelleEnum.PROPRIETAIRE_AVEC_EMPRUNT}}</span>
                            </div>
                        </label>
                        <label id="btn-situation-proprietaire" name="isProprietaire"
                            aria-label="Vous êtes propriétaire sans emprunt" class="radio-button-style-1"
                            data-testid="btn-situation-proprietaire"
                            [(ngModel)]="this.informationsPersonnelles.logement.statutOccupationLogement.isProprietaire"
                            btnCheckbox tabindex="0" role="button" #isProprietaire="ngModel"
                            (click)="onClickCheckBoxIsProprietaire()"
                            (keyup)="handleKeyUpOnButtonStatutOccupationLogement($event, statutOccupationLogementEnum.PROPRIETAIRE)">
                            <div>
                                <span class="body-2-typo">{{statutOccupationLogementLibelleEnum.PROPRIETAIRE}}</span>
                            </div>
                        </label>
                        <label id="btn-situation-loge-gratuitement" name="isLogeGratuitement"
                            aria-label="Vous êtes logé à titre gratuit" class="radio-button-style-1"
                            data-testid="btn-situation-loge-gratuitement"
                            [(ngModel)]="informationsPersonnelles.logement.statutOccupationLogement.isLogeGratuitement"
                            btnCheckbox tabindex="0" role="button" #isLogeGratuitement="ngModel"
                            (click)="onClickCheckBoxIsLogeGratuitement()"
                            (keyup)="handleKeyUpOnButtonStatutOccupationLogement($event, statutOccupationLogementEnum.LOGE_GRATUITEMENT)">
                            <div>
                                <span
                                    class="body-2-typo">{{statutOccupationLogementLibelleEnum.LOGE_GRATUITEMENT}}</span>
                            </div>
                        </label>
                    </div>
                    <span class="row error-input-message"
                        *ngIf="isRessourcesFinancieresFoyerFormSubmitted  && !isStatutOccupationLogementSelectionne()">
                        {{controleChampFormulaireService.MESSAGE_SELECTION_AU_MOINS_UN_STATUT_OCCUPATION_LOGEMENT}}
                    </span>
                </div>
            </div>
            <div class="form-group" *ngIf="isConcerneParAideLogement()">
                <div class="row mb-2">
                    <label class="label headline-4-typo" for="allocationRSA">
                        * Votre logement est :
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <label id="btn-situation-logement-crous" name="isCrous"
                            aria-label="Votre logement est un logement CROUS" class="radio-button-style-1"
                            data-testid="btn-situation-logement-crous"
                            [(ngModel)]="this.informationsPersonnelles.logement.isCrous" btnCheckbox tabindex="0"
                            role="button" #isCrous="ngModel" (click)="onClickCheckBoxIsCrous()"
                            (keyup)="handleKeyUpOnButtonIsCrous($event)">
                            <div>
                                <span class="body-2-typo">Un logement CROUS</span>
                            </div>
                        </label>
                        <label id="btn-situation-logement-conventionne" name="isConventionne"
                            aria-label="Votre logement est un logement conventionné" class="radio-button-style-1"
                            data-testid="btn-situation-logement-conventionne"
                            [(ngModel)]="this.informationsPersonnelles.logement.isConventionne" btnCheckbox tabindex="0"
                            role="button" #isConventionne="ngModel" (click)="onClickCheckBoxIsConventionne()"
                            (keyup)="handleKeyUpOnButtonIsConventionne($event)">
                            <div>
                                <span class="body-2-typo">un logement conventionné</span>
                            </div>
                        </label>
                        <label id="btn-situation-logement-colloc" name="isColloc"
                            aria-label="Votre logement est un logement en collocation" class="radio-button-style-1"
                            data-testid="btn-situation-locataire-hlm"
                            [(ngModel)]="this.informationsPersonnelles.logement.isColloc" btnCheckbox tabindex="0"
                            role="button" #isColloc="ngModel" (click)="onClickCheckBoxIsColloc()"
                            (keyup)="handleKeyUpOnButtonIsColloc($event)">
                            <div>
                                <span class="body-2-typo">Une collocation</span>
                            </div>
                        </label>
                        <label id="btn-situation-logement-chambre" name="isChambre"
                            aria-label="Votre logement est une chambre" class="radio-button-style-1"
                            data-testid="btn-situation-logement-chambre"
                            [(ngModel)]="this.informationsPersonnelles.logement.isChambre" btnCheckbox tabindex="0"
                            role="button" #isChambre="ngModel" (click)="onClickCheckBoxIsChambre()"
                            (keyup)="handleKeyUpOnButtonIsChambre($event)">
                            <div>
                                <span class="body-2-typo">Une chambre</span>
                            </div>
                        </label>
                        <label id="btn-situation-aucun-cas" name="isAucunCas"
                            aria-label="Votre logement ne correspond à aucun des cas précédents"
                            class="radio-button-style-1" data-testid="btn-situation-aucun-cas"
                            [(ngModel)]="this.isAucunCas" btnCheckbox tabindex="0" role="button"
                            (click)="onClickCheckBoxIsAucunCas()" (keyup)="handleKeyUpOnButtonIsAucunCas($event)">
                            <div>
                                <span class="body-2-typo">Aucun de ces cas</span>
                            </div>
                        </label>
                    </div>
                    <span class="row error-input-message"
                        *ngIf="isRessourcesFinancieresFoyerFormSubmitted  && !isStatutOccupationLogementSelectionne()">
                        {{controleChampFormulaireService.MESSAGE_SELECTION_AU_MOINS_UN_STATUT_OCCUPATION_LOGEMENT}}
                    </span>
                </div>
            </div>
            <div class="form-group">
                <div class="row mb-2">
                    <label class="label headline-4-typo" for="situationFamilialeDemandeur">
                        Si vous percevez une de ces aides au logement, veuillez nous préciser laquelle :
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <label id="btn-beneficiaire-apl" #beneficiaireAPL="ngModel" (click)="onClickCheckBoxHasAPL()"
                            name="beneficiaireAPL" aria-label="Vous êtes bénéficiaire de l'APL"
                            class="radio-button-style-1 ms-1" data-testid="btn-beneficiaire-apl" btnCheckbox
                            tabindex="0" role="button" [(ngModel)]="beneficiaireAides.beneficiaireAPL"
                            (keyup)="handleKeyUpOnButtonAPL($event)">
                            <div>
                                <span class="body-2-typo">{{libellesAidesEnum.AIDE_PERSONNALISEE_LOGEMENT}}
                                    ({{codesAidesEnum.AIDE_PERSONNALISEE_LOGEMENT}})</span>
                            </div>
                        </label>
                        <label id="btn-beneficiaire-alf" #beneficiaireALF="ngModel" (click)="onClickCheckBoxHasALF()"
                            name="beneficiaireALF" aria-label="Vous êtes bénéficiaire de l'ALF"
                            class="radio-button-style-1 ms-1" data-testid="btn-beneficiaire-alf" btnCheckbox
                            tabindex="0" role="button" [(ngModel)]="beneficiaireAides.beneficiaireALF"
                            (keyup)="handleKeyUpOnButtonALF($event)">
                            <div>
                                <span class="body-2-typo">{{libellesAidesEnum.ALLOCATION_LOGEMENT_FAMILIALE}}
                                    ({{codesAidesEnum.ALLOCATION_LOGEMENT_FAMILIALE}})</span>
                            </div>
                        </label>
                        <label id="btn-beneficiaire-als" #beneficiaireALS="ngModel" (click)="onClickCheckBoxHasALS()"
                            name="beneficiaireALS" aria-label="Vous êtes bénéficiaire de l'ALS"
                            class="radio-button-style-1 ms-1" data-testid="btn-beneficiaire-als" btnCheckbox
                            tabindex="0" role="button" [(ngModel)]="beneficiaireAides.beneficiaireALS"
                            (keyup)="handleKeyUpOnButtonALS($event)">
                            <div>
                                <span class="body-2-typo">{{libellesAidesEnum.ALLOCATION_LOGEMENT_SOCIALE}}
                                    ({{codesAidesEnum.ALLOCATION_LOGEMENT_SOCIALE}})</span>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
            <div *ngIf="deConnecteBeneficiaireAidesService.isBeneficiaireAideLogement()" class="form-group">
                <div class="row mb-2">
                    <label class="label headline-4-typo" for="montantAllocationsLogement">
                        * Allocations logement perçues pour les 3 derniers mois
                    </label>
                </div>
                <div class="mb-2">
                    <div class="row">
                        <div class="col">
                            <input *ngIf="beneficiaireAides.beneficiaireAPL"
                                attr.aria-label="Allocations logement perçue au mois de {{this.dateUtileService.getDateFormateeAvantDateJour(1)}}"
                                name="aplMoisNMoins1" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                                data-testid="input-apl-mois-moins-1"
                                (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text"
                                min="0" maxlength="6" class="max-with-input-type-montant form-control d-inline"
                                placeholder="Montant"
                                [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesLogement.aidePersonnaliseeLogement.moisNMoins1"
                                inputmode="decimal" required (click)="$event.target.select()" #aplMoisNMoins1="ngModel">
                            <input *ngIf="beneficiaireAides.beneficiaireALF"
                                attr.aria-label="Allocations logement perçue au mois de {{this.dateUtileService.getDateFormateeAvantDateJour(1)}}"
                                name="alfMoisNMoins1" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                                data-testid="input-alf-mois-moins-1"
                                (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text"
                                min="0" maxlength="6" class="max-with-input-type-montant form-control d-inline"
                                placeholder="Montant"
                                [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesLogement.allocationLogementFamiliale.moisNMoins1"
                                inputmode="decimal" required (click)="$event.target.select()" #alfMoisNMoins1="ngModel">
                            <input *ngIf="beneficiaireAides.beneficiaireALS"
                                attr.aria-label="Allocations logement perçue au mois de {{this.dateUtileService.getDateFormateeAvantDateJour(1)}}"
                                name="alsMoisNMoins1" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                                data-testid="input-als-mois-moins-1"
                                (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text"
                                min="0" maxlength="6" class="max-with-input-type-montant form-control d-inline"
                                placeholder="Montant"
                                [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesLogement.allocationLogementSociale.moisNMoins1"
                                inputmode="decimal" required (click)="$event.target.select()" #alsMoisNMoins1="ngModel">
                            <app-text-with-euro-symbol *ngIf="!screenService.isExtraSmallScreen()"
                                [message]="'au mois de ' + this.dateUtileService.getDateFormateeAvantDateJour(1)">
                            </app-text-with-euro-symbol>
                            <app-text-with-euro-symbol *ngIf="screenService.isExtraSmallScreen()"
                                [message]="this.dateUtileService.getDateFormateeAvantDateJour(1)">
                            </app-text-with-euro-symbol>
                        </div>
                    </div>
                </div>
                <div class="mb-2">
                    <div class="row">
                        <div class="col">
                            <input *ngIf="beneficiaireAides.beneficiaireAPL"
                                attr.aria-label="Allocations logement perçue au mois de {{this.dateUtileService.getDateFormateeAvantDateJour(2)}}"
                                name="aplMoisNMoins2" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                                data-testid="input-apl-mois-moins-2"
                                (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text"
                                min="0" maxlength="6" class="max-with-input-type-montant form-control d-inline"
                                placeholder="Montant"
                                [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesLogement.aidePersonnaliseeLogement.moisNMoins2"
                                inputmode="decimal" required (click)="$event.target.select()" #aplMoisNMoins2="ngModel">
                            <input *ngIf="beneficiaireAides.beneficiaireALF"
                                attr.aria-label="Allocations logement perçue au mois de {{this.dateUtileService.getDateFormateeAvantDateJour(2)}}"
                                name="alfMoisNMoins2" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                                data-testid="input-alf-mois-moins-2"
                                (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text"
                                min="0" maxlength="6" class="max-with-input-type-montant form-control d-inline"
                                placeholder="Montant"
                                [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesLogement.allocationLogementFamiliale.moisNMoins2"
                                inputmode="decimal" required (click)="$event.target.select()" #alfMoisNMoins2="ngModel">
                            <input *ngIf="beneficiaireAides.beneficiaireALS"
                                attr.aria-label="Allocations logement perçue au mois de {{this.dateUtileService.getDateFormateeAvantDateJour(2)}}"
                                name="alsMoisNMoins2" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                                data-testid="input-als-mois-moins-2"
                                (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text"
                                min="0" maxlength="6" class="max-with-input-type-montant form-control d-inline"
                                placeholder="Montant"
                                [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesLogement.allocationLogementSociale.moisNMoins2"
                                inputmode="decimal" required (click)="$event.target.select()" #alsMoisNMoins2="ngModel">
                            <app-text-with-euro-symbol *ngIf="!screenService.isExtraSmallScreen()"
                                [message]="'au mois de ' + this.dateUtileService.getDateFormateeAvantDateJour(2)">
                            </app-text-with-euro-symbol>
                            <app-text-with-euro-symbol *ngIf="screenService.isExtraSmallScreen()"
                                [message]="this.dateUtileService.getDateFormateeAvantDateJour(2)">
                            </app-text-with-euro-symbol>
                        </div>
                    </div>
                </div>
                <div class="mb-2">
                    <div class="row">
                        <div class="col">
                            <input *ngIf="beneficiaireAides.beneficiaireAPL"
                                attr.aria-label="Allocations logement perçue au mois de {{this.dateUtileService.getDateFormateeAvantDateJour(3)}}"
                                name="aplMoisNMoins3" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                                data-testid="input-apl-mois-moins-3"
                                (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text"
                                min="0" maxlength="6" class="max-with-input-type-montant form-control d-inline"
                                placeholder="Montant"
                                [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesLogement.aidePersonnaliseeLogement.moisNMoins3"
                                inputmode="decimal" required (click)="$event.target.select()" #aplMoisNMoins3="ngModel">
                            <input *ngIf="beneficiaireAides.beneficiaireALF"
                                attr.aria-label="Allocations logement perçue au mois de {{this.dateUtileService.getDateFormateeAvantDateJour(3)}}"
                                name="alfMoisNMoins3" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                                data-testid="input-alf-mois-moins-3"
                                (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text"
                                min="0" maxlength="6" class="max-with-input-type-montant form-control d-inline"
                                placeholder="Montant"
                                [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesLogement.allocationLogementFamiliale.moisNMoins3"
                                inputmode="decimal" required (click)="$event.target.select()" #alfMoisNMoins3="ngModel">
                            <input *ngIf="beneficiaireAides.beneficiaireALS"
                                attr.aria-label="Allocations logement perçue au mois de {{this.dateUtileService.getDateFormateeAvantDateJour(3)}}"
                                name="alsMoisNMoins3" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                                data-testid="input-als-mois-moins-3"
                                (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text"
                                min="0" maxlength="6" class="max-with-input-type-montant form-control d-inline"
                                placeholder="Montant"
                                [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesLogement.allocationLogementSociale.moisNMoins3"
                                inputmode="decimal" required (click)="$event.target.select()" #alsMoisNMoins3="ngModel">
                            <app-text-with-euro-symbol *ngIf="!screenService.isExtraSmallScreen()"
                                [message]="'au mois de ' + this.dateUtileService.getDateFormateeAvantDateJour(3)">
                            </app-text-with-euro-symbol>
                            <app-text-with-euro-symbol *ngIf="screenService.isExtraSmallScreen()"
                                [message]="this.dateUtileService.getDateFormateeAvantDateJour(3)">
                            </app-text-with-euro-symbol>
                        </div>
                    </div>
                </div>
                <div class="mb-2">
                    <div class="row">
                        <div class="col">
                            <span class="error-input-message"
                                *ngIf="isRessourcesFinancieresFoyerFormSubmitted && isAuMoinsUneAideLogementSuperieureAZero();">
                                {{controleChampFormulaireService.MESSAGE_MONTANTS_0}}
                            </span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group" *ngIf="isConcerneParAideLogement()">
            <div class="row mb-2">
                <label class="label headline-4-typo" for="montantLoyer">
                    * Montant de votre loyer mensuel hors charges
                </label>
            </div>
            <div class="row">
                <div class="col">
                    <input id="montantLoyer" name="montantLoyer" type="text" data-testid="input-montant-loyer"
                        pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                        (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" min="0"
                        maxlength="8" class="form-control d-inline"
                        [ngClass]="{'ng-invalid': this.informationsPersonnelles.logement.montantLoyer && this.informationsPersonnelles.logement.montantLoyer == 0}"
                        [(ngModel)]="informationsPersonnelles.logement.montantLoyer" required placeholder="Montant"
                        inputmode="decimal" #montantLoyer="ngModel">
                    <app-text-with-euro-symbol></app-text-with-euro-symbol>
                </div>
            </div>
            <span
                *ngIf="this.informationsPersonnelles.logement.montantLoyer && this.informationsPersonnelles.logement.montantLoyer == 0"
                class="row error-input-message">
                {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
            </span>
            <span class="row error-input-message"
                *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || montantLoyer.touched)  && montantLoyer.errors?.required">
                {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
            </span>
            <span class="row error-input-message"
                *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || montantLoyer.touched)  && montantLoyer.errors?.pattern">
                {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_2}}
            </span>
        </div>
        <div class="form-group" *ngIf="isConcerneParAideLogement()">
            <div class="row mb-2">
                <label class="label headline-4-typo" for="montantCharges">
                    * Montant des charges mensuelles de votre logement
                </label>
            </div>
            <div class="row">
                <div class="col">
                    <input id="montantCharges" name="montantCharges" type="text" data-testid="input-montant-charges"
                        pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                        (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" min="0"
                        maxlength="8" class="form-control d-inline"
                        [ngClass]="{'ng-invalid': this.informationsPersonnelles.logement.montantCharges && this.informationsPersonnelles.logement.montantCharges == 0}"
                        [(ngModel)]="informationsPersonnelles.logement.montantCharges" required placeholder="Montant"
                        inputmode="decimal" #montantCharges="ngModel">
                    <app-text-with-euro-symbol></app-text-with-euro-symbol>
                </div>
            </div>
            <span
                *ngIf="this.informationsPersonnelles.logement.montantCharges && this.informationsPersonnelles.logement.montantCharges == 0"
                class="row error-input-message">
                {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
            </span>
            <span class="row error-input-message"
                *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || montantCharges.touched)  && montantCharges.errors?.required">
                {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
            </span>
            <span class="row error-input-message"
                *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || montantCharges.touched)  && montantCharges.errors?.pattern">
                {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_2}}
            </span>
        </div>
        <div class="form-group"
            *ngIf="deConnecteBeneficiaireAidesService.hasFoyerRSA() || deConnecteBeneficiaireAidesService.isBeneficiaireAAH() || isConcerneParAideLogement()">
            <div class="row flex-column">
                <label class="label mb-2 headline-4-typo" for="prochaineDeclarationTrimestrielle">
                    * Au cours de quel mois ferez-vous votre prochaine déclaration trimestrielle CAF ?
                </label>
                <div class="col">
                    <select id="prochaineDeclarationTrimestrielle" name="prochaineDeclarationTrimestrielle"
                        data-testid="select-prochaine-declaration-rsa-foyer"
                        [(ngModel)]="ressourcesFinancieres.aidesCAF.prochaineDeclarationTrimestrielle"
                        class="fit-content form-select"
                        [ngClass]="{'option-selected':ressourcesFinancieres.aidesCAF.prochaineDeclarationTrimestrielle !== null}"
                        data-width="auto" required #prochaineDeclarationTrimestrielle="ngModel">
                        <option [value]="null" disabled>
                            Sélectionner
                        </option>
                        <option
                            *ngFor="let moisProchaineDeclarationTrimestrielle of optionsProchaineDeclarationTrimestrielle"
                            [value]="moisProchaineDeclarationTrimestrielle.value">
                            {{ moisProchaineDeclarationTrimestrielle.label }}
                        </option>
                    </select>
                </div>
                <span class="row error-input-message"
                    *ngIf="(isRessourcesFinancieresFormSubmitted || prochaineDeclarationTrimestrielle.touched)  && prochaineDeclarationTrimestrielle.errors?.required">
                    {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                </span>
            </div>
        </div>
        <div class="form-group" *ngIf="deConnecteSituationFamilialeService.hasPersonneAChargeSuperieur(1)">
            <div class="row mb-2">
                <label class="label headline-4-typo" for="allocationsFamiliales">
                    * Allocations familiales
                </label>
            </div>
            <div class="row">
                <div class="col">
                    <input attr.aria-label="Allocations familiales du mois dernier" name="allocationsFamiliales"
                        data-testid="input-af" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                        (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text" min="0"
                        maxlength="6" class="max-with-input-type-montant form-control d-inline" placeholder="Montant"
                        [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesFamiliales.allocationsFamiliales"
                        inputmode="decimal" required (click)="$event.target.select()" #allocationsFamiliales="ngModel">
                    <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                </div>
            </div>
            <div class="row">
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || allocationsFamiliales?.touched)  && allocationsFamiliales?.errors?.required">
                    {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                </span>
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || allocationsFamiliales.touched)  && allocationsFamiliales.errors?.pattern">
                    {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR}}
                </span>
            </div>
        </div>
        <div class="form-group" *ngIf="deConnecteSituationFamilialeService.hasPersonneAChargeSuperieur(0)">
            <div class="row mb-2">
                <label class="label headline-4-typo" for="allocationSoutienFamilial">
                    * Allocation soutien familial
                </label>
            </div>
            <div class="row">
                <div class="col">
                    <input attr.aria-label="Allocation de soutien familiale du mois dernier"
                        name="allocationSoutienFamilial" data-testid="input-asf"
                        pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                        (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text" min="0"
                        maxlength="6" class="max-with-input-type-montant form-control d-inline" placeholder="Montant"
                        [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesFamiliales.allocationSoutienFamilial"
                        inputmode="decimal" required (click)="$event.target.select()"
                        #allocationSoutienFamilial="ngModel">
                    <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                </div>
            </div>
            <div class="row">
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || allocationSoutienFamilial?.touched)  && allocationSoutienFamilial?.errors?.required">
                    {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                </span>
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || allocationSoutienFamilial.touched)  && allocationSoutienFamilial.errors?.pattern">
                    {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR}}
                </span>
            </div>
        </div>
        <div class="form-group" *ngIf="deConnecteSituationFamilialeService.has3PersonnesAChargeEntre3Et21Ans()">
            <div class="row mb-2">
                <label class="label headline-4-typo" for="allocationsFamiliales">
                    * Complément familial
                </label>
            </div>
            <div class="row">
                <div class="col">
                    <input attr.aria-label="Complément familial du mois dernier" name="complementFamilial"
                        data-testid="input-cf" pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                        (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text" min="0"
                        maxlength="6" class="max-with-input-type-montant form-control d-inline" placeholder="Montant"
                        [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesFamiliales.complementFamilial"
                        inputmode="decimal" required (click)="$event.target.select()" #complementFamilial="ngModel">
                    <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                </div>
            </div>
            <div class="row">
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || complementFamilial?.touched)  && complementFamilial?.errors?.required">
                    {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                </span>
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || complementFamilial.touched)  && complementFamilial.errors?.pattern">
                    {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR}}
                </span>
            </div>
        </div>
        <div class="form-group" *ngIf="deConnecteSituationFamilialeService.hasPersonneAChargeMoinsDe3Ans();">
            <div class="row mb-2">
                <label class="label headline-4-typo" for="montantPAJEFoyer">
                    * PAJE (prestation d'accueil du jeune enfant)
                </label>
            </div>
            <div class="row">
                <div class="col">
                    <input id="montantPAJEFoyer" name="montantPAJEFoyer"
                        data-testid="input-prestation-accueil-jeune-enfant"
                        pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                        (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text" min="0"
                        maxlength="6" class="max-with-input-type-montant form-control d-inline" placeholder="Montant"
                        [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesFamiliales.prestationAccueilJeuneEnfant"
                        inputmode="decimal" required (click)="$event.target.select()"
                        #prestationAccueilJeuneEnfantFoyer="ngModel">
                    <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                </div>
            </div>
            <div class="row">
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || prestationAccueilJeuneEnfantFoyer?.touched)  && prestationAccueilJeuneEnfantFoyer?.errors?.required">
                    {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                </span>
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || prestationAccueilJeuneEnfantFoyer.touched)  && prestationAccueilJeuneEnfantFoyer.errors?.pattern">
                    {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR}}
                </span>
            </div>
        </div>
        <div class="form-group" *ngIf="deConnecteSituationFamilialeService.hasPersonneAChargeSuperieur(0)">
            <div class="row mb-2">
                <label class="label headline-4-typo" for="montantPersionsAlimentairesFoyer">
                    * Pensions alimentaires du foyer perçues
                </label>
            </div>
            <div class="row">
                <div class="col">
                    <input id="montantPersionsAlimentairesFoyer" name="montantPersionsAlimentairesFoyer"
                        pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                        (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text" min="0"
                        maxlength="6" class="max-with-input-type-montant form-control d-inline" placeholder="Montant"
                        [(ngModel)]="ressourcesFinancieres.aidesCAF.aidesFamiliales.pensionsAlimentairesFoyer"
                        inputmode="decimal" required (click)="$event.target.select()"
                        #pensionsAlimentairesFoyer="ngModel">
                    <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                </div>
            </div>
            <div class="row">
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || pensionsAlimentairesFoyer?.touched)  && pensionsAlimentairesFoyer?.errors?.required">
                    {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                </span>
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || pensionsAlimentairesFoyer.touched)  && pensionsAlimentairesFoyer.errors?.pattern">
                    {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR}}
                </span>
            </div>
        </div>
        <div class="form-group" *ngIf="deConnecteInfosPersonnellesService.hasRevenusImmobilier()">
            <div class="row mb-2">
                <label class="label headline-4-typo" for="revenusImmobilierFoyer">
                    * Revenus annuels de placement ou du patrimoine
                    <button id="infobulle-revenus-immobilier" role="tooltip" class="img-interrogation-icon"
                        [ngClass]="{'popover-open': popoverRevenusImmobiliers.isOpen}" placement="right"
                        tag-action="clic_infobulle_ressources_du_foyer_revenus_annuels_placement_patrimoine"
                        (click)="$event.preventDefault();" [popover]="popoverRevenusImmobiliersTemplate"
                        #popoverRevenusImmobiliers="bs-popover"></button>
                </label>
            </div>
            <div class="row">
                <div class="col">
                    <input id="revenusImmobilierFoyer" name="revenusImmobilier"
                        pattern="{{controleChampFormulaireService.REGEX_DECIMAL}}"
                        (keypress)="controleChampFormulaireService.isKeyAuthorizeForDecimal($event)" type="text"
                        maxlength="6" min="0" class="max-with-input-type-montant form-control d-inline"
                        placeholder="Montant" [(ngModel)]="ressourcesFinancieres.revenusImmobilier3DerniersMois"
                        [ngClass]="{'ng-invalid': this.ressourcesFinancieres.revenusImmobilier3DerniersMois && (this.ressourcesFinancieres.revenusImmobilier3DerniersMois == 0)}"
                        required inputmode="decimal" #revenusImmobilier="ngModel">
                    <app-text-with-euro-symbol message="net total 3 derniers mois"></app-text-with-euro-symbol>
                </div>
            </div>
            <div class="row">
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || revenusImmobilier?.touched)  && revenusImmobilier?.errors?.required">
                    {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                </span>
                <span class="error-input-message"
                    *ngIf="(isRessourcesFinancieresFoyerFormSubmitted || revenusImmobilier?.touched)  && revenusImmobilier?.errors?.pattern">
                    {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR}}
                </span>
                <span
                    *ngIf="this.ressourcesFinancieres.revenusImmobilier3DerniersMois && (this.ressourcesFinancieres.revenusImmobilier3DerniersMois == 0)"
                    class="error-input-message">
                    {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
                </span>
            </div>
        </div>
        <div class="row row-button-valider">
            <div class="col">
                <button id="btn-ressources-foyer-valider" aria-label="Valider ressources finançière de votre foyer"
                    class="btn-style-perso-3 button-typo" type="submit" data-testid="btn-ressources-foyer-valider"
                    tag-action="clic_bouton_valider_ressources_foyer">
                    <div>
                        <span>Valider</span>
                    </div>
                </button>
            </div>
        </div>
    </form>
</div>

<ng-template #popoverRevenusImmobiliersTemplate>
    <div class="container" (click)="onClickPopoverRevenusImmobiliers($event)">
        <div class="close-popover row">
            <div class="col"><i class="fas fa-times-circle mb-2 ms-auto float-end"
                    (click)="onClickClosePopoverRevenusImmobiliers($event)"></i>
            </div>
        </div>
        <div class="row">
            <h5>
                Retrouvez cette information sur le dernier avis d'imposition sur le revenu :
            </h5>
            <p> * revenus fonciers ou micro-fonciers
                <br>
                * revenus des capitaux (actions, obligations)
                <br>
                * bénéfices d'une rente viagère
            </p>
        </div>
    </div>
</ng-template>

<ng-template #popoverSituationLogementTemplate>
    <div class="container" (click)="onClickPopoverSituationLogement($event)">
        <div class="close-popover row">
            <div class="col">
                <i class="fas fa-times-circle mb-2 ms-auto float-end"
                    (click)="onClickClosePopoverSituationLogement($event)"></i>
            </div>
        </div>
        <div class="row">
            <p>
                Répondez par non si vous payez un loyer, vous êtes hébergé et vous payez une participation pour ce
                logement ou vous êtes propriétaire et remboursez un prêt.
            </p>
        </div>
    </div>
</ng-template>