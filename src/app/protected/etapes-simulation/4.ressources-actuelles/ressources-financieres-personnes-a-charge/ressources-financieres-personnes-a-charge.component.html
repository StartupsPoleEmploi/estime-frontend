<div class="card card-body card-form card-form-style-3">
    <form (ngSubmit)="onSubmitRessourcesFinancieresPersonnesChargeForm(ressourcesFinancieresPersonnesChargeForm)"
        [ngClass]="{'submitted':isRessourcesFinancieresPersonnesChargeFormSubmitted}"
        #ressourcesFinancieresPersonnesChargeForm="ngForm">
        <div *ngFor="let personneDTO of personnesDTO">
            <div class="row pb-3">
                <div class="col-12">
                    <span *ngIf="!personneRecoitRSASeulement(personneDTO)" class="libelle-personne headline-4-typo">
                        Personne {{personneDTO.index + 1}}
                        ({{dateUtileService.getDateStringFormat(personneDTO.personne.informationsPersonnelles.dateNaissance)}})
                    </span>
                </div>
            </div>
            <div *ngIf="personneDTO.personne.informationsPersonnelles.salarie">
                <div class="row pb-3">
                    <label class="label headline-4-typo" [for]="'salaireNetPersonneACharge'+personneDTO.index + 1">
                        * Salaire net per√ßu
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <input
                            attr.aria-label="Salaire per√ßu par personne {{personneDTO.index + 1}} ({{dateUtileService.getDateStringFormat(personneDTO.personne.informationsPersonnelles.dateNaissance)}})"
                            [name]="'salaireNetPersonneACharge'+personneDTO.index + 1"
                            [id]="'salaireNetPersonneACharge'+personneDTO.index + 1" type="text"
                            pattern="{{controleChampFormulaireService.REGEX_NUMERIC}}"
                            (keypress)="controleChampFormulaireService.isKeyAuthorizeForNumberOnly($event)" min="0"
                            maxlength="6" class="form-control d-inline"
                            [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.salaire.montantMensuelNet"
                            [ngClass]="{'ng-invalid': personneDTO.personne.ressourcesFinancieresAvantSimulation.salaire.montantMensuelNet && (personneDTO.personne.ressourcesFinancieresAvantSimulation.salaire.montantMensuelNet == 0)}"
                            required placeholder="Montant" inputmode="numeric" #salaireNet="ngModel">
                        <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                    </div>
                </div>
                <div class="row pb-3">
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || salaireNet?.touched)  && salaireNet?.errors?.required">
                            {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || salaireNet?.touched)  && salaireNet?.errors?.pattern">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_ENTIER}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="personneDTO.personne.ressourcesFinancieresAvantSimulation.salaire.montantMensuelNet && (personneDTO.personne.ressourcesFinancieresAvantSimulation.salaire.montantMensuelNet == 0)">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
                        </span>
                    </div>
                </div>
            </div>
            <div>
                <div class="row pb-3">
                    <label class="label headline-4-typo" for="hasTravailleAuCoursDerniersMois">
                        * Personne {{personneDTO.index + 1}} a-t-elle travaill√© au cours des
                        {{ressourcesFinancieresAvantSimulationUtileService.getNombreMaxMoisTravailleAuCoursDerniersMois()}}
                        derniers
                        mois ?
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <div class="form-check form-check-inline">
                            <input id="hasTravailleAuCoursDerniersMoisOuiPersonneACharge{{personneDTO.index + 1}}"
                                name="hasTravailleAuCoursDerniersMoisOuiPersonneACharge{{personneDTO.index + 1}}"
                                attr.aria-label="Vous avez travaill√© au cours des {{ressourcesFinancieresAvantSimulationUtileService.getNombreMaxMoisTravailleAuCoursDerniersMois()}} derniers mois"
                                data-testid="btn-has-travaille-au-cours-derniers-mois-oui-personne-a-charge-{{personneDTO.index + 1}}"
                                type="radio" class="form-check-input"
                                [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.hasTravailleAuCoursDerniersMois"
                                tag-action="clic_personne_a_charge_{{personneDTO.index + 1}}_a_travaille_au_cours_14_derniers_mois_oui"
                                (click)="onClickButtonRadioHasTravailleAuCoursDerniersMoisPersonne(personneDTO.personne, true)"
                                required [value]="true" #hasTravailleAuCoursDerniersMois="ngModel"
                                (keyup)="handleKeyUpOnButtonRadioHasTravailleAuCoursDerniersMoisPersonne(personneDTO.personne, $event, true)">
                            <label class="form-check-label"
                                for="hasTravailleAuCoursDerniersMoisOuiPersonneACharge{{personneDTO.index + 1}}">
                                oui
                            </label>
                        </div>
                        <div class="form-check form-check-inline ms-2">
                            <input id="hasTravailleAuCoursDerniersMoisNonPersonneACharge{{personneDTO.index + 1}}"
                                name="hasTravailleAuCoursDerniersMoisNonPersonneACharge{{personneDTO.index + 1}}"
                                data-testid="btn-has-travaille-au-cours-derniers-mois-non-personne-a-charge-{{personneDTO.index + 1}}"
                                attr.aria-label="Vous n'avez pas travaill√© au cours des {{ressourcesFinancieresAvantSimulationUtileService.getNombreMaxMoisTravailleAuCoursDerniersMois()}} derniers mois"
                                type="radio" class="form-check-input"
                                [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.hasTravailleAuCoursDerniersMois"
                                [value]="false"
                                tag-action="clic_personne_a_charge_{{personneDTO.index + 1}}_a_travaille_au_cours_14_derniers_mois_non"
                                (click)="onClickButtonRadioHasTravailleAuCoursDerniersMoisPersonne(personneDTO.personne, false)"
                                required #hasTravailleAuCoursDerniersMois="ngModel"
                                (keyup)="handleKeyUpOnButtonRadioHasTravailleAuCoursDerniersMoisPersonne(personneDTO.personne, $event, false)">
                            <label class="form-check-label"
                                for="hasTravailleAuCoursDerniersMoisNonPersonneACharge{{personneDTO.index + 1}}">
                                non
                            </label>
                        </div>
                    </div>
                </div>
                <div class="row pb-3">
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || hasTravailleAuCoursDerniersMois.touched)  && hasTravailleAuCoursDerniersMois.errors?.required">
                            {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                        </span>
                    </div>
                </div>
            </div>
            <div *ngIf="isAfficherChampsSalairesPersonne(personneDTO.personne);">
                <div>
                    <div class="row pb-3">
                        <label class="label headline-4-typo">
                            Indiquez le montant de vos salaires de
                            {{optionsNombreMoisTravailles[optionsNombreMoisTravailles.length-1].label}} √†
                            {{optionsNombreMoisTravailles[0].label}}.
                            <br>
                            <span class="body-2-typo">N√©cessaire pour calculer vos droits √† l'aide au
                                logement.</span>
                        </label>
                    </div>
                    <div class="row">
                        <div *ngFor="let optionNombreMoisTravailles of optionsNombreMoisTravailles"
                            class="col-12 col-md-4 mt-2"
                            [ngClass]="{'col-salaire-with-border':optionNombreMoisTravailles.index-12<0}">
                            <div class="ms-2 me-2">
                                <div class="row pb-3">
                                    <label class="label headline-4-typo"
                                        [for]="'salaireMoisMoins'+optionNombreMoisTravailles.index+'AvantSimulation'">
                                        * Salaire en {{ optionNombreMoisTravailles.label }}
                                    </label>
                                </div>
                                <div class="row mb-4">
                                    <div class="col">
                                        <input
                                            id="salaireMoisMoins{{optionNombreMoisTravailles.index}}AvantSimulationPersonneACharge{{personneDTO.index + 1}}"
                                            name="salaireMoisMoins{{optionNombreMoisTravailles.index}}AvantSimulationPersonneACharge{{personneDTO.index + 1}}"
                                            attr.data-testid="input-salaire-mois-moins-{{optionNombreMoisTravailles.index}}-avant-simulation-personne-a-charge-{{personneDTO.index + 1}}"
                                            pattern="{{controleChampFormulaireService.REGEX_NUMERIC}}"
                                            (keypress)="controleChampFormulaireService.isKeyAuthorizeForNumberOnly($event)"
                                            type="text" maxlength="6" min="0"
                                            class="max-with-input-type-montant form-control d-inline"
                                            placeholder="Montant"
                                            (blur)="this.ressourcesFinancieresAvantSimulationUtileService.calculSalaireMensuelBrut(personneDTO.personne.ressourcesFinancieresAvantSimulation.periodeTravailleeAvantSimulation.mois[optionNombreMoisTravailles.index].salaire);"
                                            [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.periodeTravailleeAvantSimulation.mois[optionNombreMoisTravailles.index].salaire.montantMensuelNet"
                                            [ngClass]="{'ng-invalid': hasDouzeMoisSansSalaire(personneDTO.personne)}"
                                            required inputmode="numeric" (click)="$event.target.select()"
                                            #salaireMoisAvantPeriodeSimulee="ngModel">
                                        <app-text-with-euro-symbol message="net"></app-text-with-euro-symbol>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-12">
                                        <span class="error-input-message"
                                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || salaireMoisAvantPeriodeSimulee?.touched)  && salaireMoisAvantPeriodeSimulee?.errors?.pattern">
                                            {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_ENTIER}}
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row pb-3">
                        <div class="col-12">
                            <span class="error-input-message"
                                *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted)  && erreurSaisieSalaires">
                                Vous avez d√©clar√© que Personne {{personneDTO.index + 1}} a travaill√© lors de ces
                                {{ressourcesFinancieresAvantSimulationUtileService.getNombreMaxMoisTravailleAuCoursDerniersMois()}}
                                derniers mois. Veuillez renseigner au moins un salaire.
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div *ngIf="personneDTO.personne.beneficiaireAides.beneficiaireARE">
                <div class="row pb-3">
                    <label class="label headline-4-typo"
                        [for]="'allocationMensuelleNetAREPersonneACharge_'+personneDTO.index + 1">
                        * ARE (Allocation Retour Emploi) per√ßue
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <input
                            attr.aria-label="ARE (Allocation Retour Emploi) per√ßue par personne {{personneDTO.index + 1}} ({{dateUtileService.getDateStringFormat(personneDTO.personne.informationsPersonnelles.dateNaissance)}})"
                            [id]="'allocationMensuelleNetAREPersonneACharge_'+personneDTO.index + 1"
                            [name]="'allocationMensuelleNetAREPersonneACharge_'+personneDTO.index + 1" type="text"
                            pattern="{{controleChampFormulaireService.REGEX_NUMERIC}}"
                            (keypress)="controleChampFormulaireService.isKeyAuthorizeForNumberOnly($event)" min="0"
                            maxlength="6" class="form-control d-inline"
                            [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesPoleEmploi.allocationARE.allocationMensuelleNet"
                            placeholder="Montant" inputmode="numeric" required #allocationMensuelleNetARE="ngModel">
                        <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                    </div>
                </div>
                <div class="row pb-3">
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || allocationMensuelleNetARE?.touched)  && allocationMensuelleNetARE?.errors?.required">
                            {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || allocationMensuelleNetARE?.touched)  && allocationMensuelleNetARE?.errors?.pattern">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_ENTIER}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesPoleEmploi.allocationARE.allocationMensuelleNet && (personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesPoleEmploi.allocationARE.allocationMensuelleNet == 0)">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
                        </span>
                    </div>
                </div>
            </div>
            <div *ngIf="personneDTO.personne.beneficiaireAides.beneficiaireASS">
                <div class="row pb-3">
                    <label class="label headline-4-typo"
                        [for]="'allocationMensuelleNetASSPersonneACharge'+personneDTO.index + 1">
                        * ASS (Allocation Solidarit√© Sp√©cifique) per√ßue
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <input [name]="'allocationMensuelleNetASSPersonneACharge'+personneDTO.index + 1"
                            [id]="'allocationMensuelleNetASSPersonneACharge'+personneDTO.index + 1"
                            attr.aria-label="ASS (Allocation Solidarit√© Sp√©cifique)) per√ßue par personne {{personneDTO.index + 1}} ({{dateUtileService.getDateStringFormat(personneDTO.personne.informationsPersonnelles.dateNaissance)}})"
                            type="text" pattern="{{controleChampFormulaireService.REGEX_NUMERIC}}"
                            (keypress)="controleChampFormulaireService.isKeyAuthorizeForNumberOnly($event)" min="0"
                            maxlength="6" class="form-control d-inline"
                            [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesPoleEmploi.allocationASS.allocationMensuelleNet"
                            [ngClass]="{'ng-invalid': personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesPoleEmploi.allocationASS.allocationMensuelleNet && (personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesPoleEmploi.allocationASS.allocationMensuelleNet == 0)}"
                            placeholder="Montant" inputmode="numeric" required #allocationMensuelleNetASS="ngModel">
                        <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                    </div>
                </div>
                <div class="row pb-3">
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || allocationMensuelleNetASS?.touched)  && allocationMensuelleNetASS?.errors?.required">
                            {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || allocationMensuelleNetASS?.touched)  && allocationMensuelleNetASS?.errors?.pattern">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_ENTIER}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesPoleEmploi.allocationASS.allocationMensuelleNet && (personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesPoleEmploi.allocationASS.allocationMensuelleNet == 0)">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
                        </span>
                    </div>
                </div>
            </div>
            <div *ngIf="personneDTO.personne.beneficiaireAides.beneficiaireAAH">
                <div class="row pb-3">
                    <label class="label headline-4-typo" [for]="'allocationAAHPersonneACharge'+personneDTO.index + 1">
                        * AAH (Allocation Adulte Handicap√©) per√ßue
                        <button id="infobulle-montant-aah" class="img-interrogation-icon" placement="right"
                            tag-action="clic_infobulle_aah" aria-label="Infobulle montant AAH"
                            (click)="modalService.openModal($event, modalMontantAAHTemplate)">
                        </button>
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <input [name]="'allocationAAHPersonneACharge'+personneDTO.index + 1"
                            [id]="'allocationAAHPersonneACharge'+personneDTO.index + 1"
                            attr.aria-label="AAH (Allocation Adulte Handicap√©) per√ßue par personne {{personneDTO.index + 1}} ({{dateUtileService.getDateStringFormat(personneDTO.personne.informationsPersonnelles.dateNaissance)}})"
                            type="text" pattern="{{controleChampFormulaireService.REGEX_NUMERIC}}"
                            (keypress)="controleChampFormulaireService.isKeyAuthorizeForNumberOnly($event)" min="0"
                            maxlength="6" class="form-control d-inline"
                            [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesCAF.allocationAAH"
                            [ngClass]="{'ng-invalid': personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesCAF.allocationAAH && (personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesCAF.allocationAAH == 0)}"
                            placeholder="Montant" inputmode="numeric" required #allocationAAH="ngModel">
                        <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                    </div>
                </div>
                <div class="row pb-3">
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || allocationAAH?.touched)  && allocationAAH?.errors?.required">
                            {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || allocationAAH.touched)  && allocationAAH.errors?.pattern">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_ENTIER}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesCAF.allocationAAH && (personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesCAF.allocationAAH == 0)">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
                        </span>
                    </div>
                </div>
            </div>
            <div *ngIf="personneDTO.personne.beneficiaireAides.beneficiairePensionInvalidite">
                <div class="row pb-3">
                    <label class="label headline-4-typo"
                        [for]="'pensionInvaliditePersonneACharge'+personneDTO.index + 1">
                        * Pension d'invalidit√© per√ßue
                        <button id="infobulle-pension-invalidite" class="img-interrogation-icon" placement="right"
                            tag-action="clic_infobulle_pension_invalidite"
                            aria-label="Infobulle montant pension invalidit√©"
                            (click)="modalService.openModal($event, modalPensionInvaliditeTemplate)">
                        </button>
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <input [name]="'pensionInvaliditePersonneACharge'+personneDTO.index + 1"
                            [id]="'pensionInvaliditePersonneACharge'+personneDTO.index + 1"
                            attr.aria-label="Pension d'invalidit√© per√ßue par personne {{personneDTO.index + 1}} ({{dateUtileService.getDateStringFormat(personneDTO.personne.informationsPersonnelles.dateNaissance)}})"
                            type="text" pattern="{{controleChampFormulaireService.REGEX_NUMERIC}}"
                            (keypress)="controleChampFormulaireService.isKeyAuthorizeForNumberOnly($event)" min="0"
                            maxlength="6" class="form-control d-inline"
                            [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesCPAM.pensionInvalidite"
                            [ngClass]="{'ng-invalid': personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesCPAM.pensionInvalidite && personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesCPAM.pensionInvalidite == 0}"
                            placeholder="Montant" inputmode="numeric" required #pensionInvalidite="ngModel">
                        <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                    </div>
                </div>
                <div class="row pb-3">
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || pensionInvalidite?.touched)  && pensionInvalidite?.errors?.required">
                            {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || pensionInvalidite.touched)  && pensionInvalidite.errors?.pattern">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_ENTIER}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesCPAM.pensionInvalidite && (personneDTO.personne.ressourcesFinancieresAvantSimulation.aidesCPAM.pensionInvalidite == 0)">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
                        </span>
                    </div>
                </div>
            </div>
            <div *ngIf="personneDTO.personne.informationsPersonnelles.microEntrepreneur">
                <div class="row pb-3">
                    <label class="label headline-4-typo"
                        [for]="'beneficesMicroEntreprisePersonneACharge'+personneDTO.index + 1">
                        * B√©n√©fices en tant que micro entrepreneur
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <input [name]="'beneficesMicroEntreprisePersonneACharge'+personneDTO.index + 1"
                            [id]="'beneficesMicroEntreprisePersonneACharge'+personneDTO.index + 1"
                            attr.aria-label="Chiffre d'affaires net total 3 derniers mois en tant que micro entrepreneur pour personne {{personneDTO.index + 1}} ({{dateUtileService.getDateStringFormat(personneDTO.personne.informationsPersonnelles.dateNaissance)}})"
                            pattern="{{controleChampFormulaireService.REGEX_NUMERIC}}"
                            (keypress)="controleChampFormulaireService.isKeyAuthorizeForNumberOnly($event)" type="text"
                            maxlength="6" min="0" class="max-with-input-type-montant form-control d-inline"
                            placeholder="Montant"
                            [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.beneficesMicroEntrepriseDernierExercice"
                            [ngClass]="{'ng-invalid': personneDTO.personne.ressourcesFinancieresAvantSimulation.beneficesMicroEntrepriseDernierExercice && (personneDTO.personne.ressourcesFinancieresAvantSimulation.beneficesMicroEntrepriseDernierExercice == 0)}"
                            required inputmode="numeric"
                            #personneAChargeBeneficesMicroEntreprise3DerniersMois="ngModel">
                        <app-text-with-euro-symbol message="sur le dernier exercice clos">
                        </app-text-with-euro-symbol>
                    </div>
                </div>
                <div class="row pb-3">
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || personneAChargeBeneficesMicroEntreprise3DerniersMois?.touched) && personneAChargeBeneficesMicroEntreprise?.errors?.required">
                            {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || personneAChargeBeneficesMicroEntreprise3DerniersMois?.touched) && personneAChargeBeneficesMicroEntreprise?.errors?.pattern">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_ENTIER}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || personneAChargeBeneficesMicroEntreprise3DerniersMois?.touched) && (personneDTO.personne.ressourcesFinancieresAvantSimulation.beneficesMicroEntrepriseDernierExercice == 0)">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
                        </span>
                    </div>
                </div>
            </div>
            <div *ngIf="personneDTO.personne.informationsPersonnelles.travailleurIndependant">
                <div class="row pb-3">
                    <label class="label headline-4-typo"
                        [for]="'chiffreAffairesIndependantPersonneACharge'+personneDTO.index + 1">
                        * Chiffre d'affaires en tant qu'ind√©pendant
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <input [name]="'chiffreAffairesIndependantPersonneACharge'+personneDTO.index + 1"
                            [id]="'chiffreAffairesIndependantPersonneACharge'+personneDTO.index + 1"
                            attr.aria-label="B√©n√©fices de l'ann√©e derni√®re en tant qu'ind√©pendant pour personne {{personneDTO.index + 1}} ({{dateUtileService.getDateStringFormat(personneDTO.personne.informationsPersonnelles.dateNaissance)}})"
                            pattern="{{controleChampFormulaireService.REGEX_NUMERIC}}"
                            (keypress)="controleChampFormulaireService.isKeyAuthorizeForNumberOnly($event)" type="text"
                            maxlength="6" min="0" class="max-with-input-type-montant form-control d-inline"
                            placeholder="Montant"
                            [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.chiffreAffairesIndependantDernierExercice"
                            [ngClass]="{'ng-invalid': personneDTO.personne.ressourcesFinancieresAvantSimulation.chiffreAffairesIndependantDernierExercice && (personneDTO.personne.ressourcesFinancieresAvantSimulation.chiffreAffairesIndependantDernierExercice == 0)}"
                            required inputmode="numeric"
                            #personneAChargeChiffreAffairesIndependantDernierExercice="ngModel">
                        <app-text-with-euro-symbol message="sur le dernier exercice clos">
                        </app-text-with-euro-symbol>
                    </div>
                </div>
                <div class="row pb-3">
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || personneAChargeChiffreAffairesIndependantDernierExercice?.touched) && personneAChargeChiffreAffairesIndependant?.errors?.required">
                            {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || personneAChargeChiffreAffairesIndependantDernierExercice?.touched) && personneAChargeChiffreAffairesIndependant?.errors?.pattern">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_ENTIER}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || personneAChargeChiffreAffairesIndependantDernierExercice?.touched) && (personneDTO.personne.ressourcesFinancieresAvantSimulation.chiffreAffairesIndependantDernierExercice == 0)">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
                        </span>
                    </div>
                </div>
            </div>
            <div *ngIf="personneDTO.personne.informationsPersonnelles.hasPensionRetraite">
                <div class="row pb-3">
                    <label class="label headline-4-typo" for="personneAChargePensionRetraite">
                        * Pension de retraite nette per√ßue
                    </label>
                </div>
                <div class="row">
                    <div class="col">
                        <input id="personneAChargePensionRetraite" name="personneAChargePensionRetraite"
                            pattern="{{controleChampFormulaireService.REGEX_NUMERIC}}"
                            (keypress)="controleChampFormulaireService.isKeyAuthorizeForNumberOnly($event)" type="text"
                            maxlength="6" min="0" class="max-with-input-type-montant form-control d-inline"
                            placeholder="Montant"
                            [(ngModel)]="personneDTO.personne.ressourcesFinancieresAvantSimulation.pensionRetraite"
                            [ngClass]="{'ng-invalid': personneDTO.personne.ressourcesFinancieresAvantSimulation.pensionRetraite && (personneDTO.personne.ressourcesFinancieresAvantSimulation.pensionRetraite == 0)}"
                            required inputmode="numeric" #personneAChargePensionRetraite="ngModel">
                        <app-text-with-euro-symbol message="le mois dernier"></app-text-with-euro-symbol>
                    </div>
                </div>
                <div class="row pb-3">
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || personneAChargePensionRetraite?.touched)  && personneAChargePensionRetraite?.errors?.required">
                            {{controleChampFormulaireService.MESSAGE_CHAMP_OBLIGATOIRE}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="(isRessourcesFinancieresPersonnesChargeFormSubmitted || personneAChargePensionRetraite?.touched)  && personneAChargePensionRetraite?.errors?.pattern">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_ERREUR_ENTIER}}
                        </span>
                    </div>
                    <div class="col-12">
                        <span class="error-input-message"
                            *ngIf="personneDTO.personne.ressourcesFinancieresAvantSimulation.pensionRetraite && (personneDTO.personne.ressourcesFinancieresAvantSimulation.pensionRetraite == 0)">
                            {{controleChampFormulaireService.MESSAGE_MONTANT_0}}
                        </span>
                    </div>
                </div>
            </div>
        </div>
        <div class="row row-button-valider">
            <div class="col">
                <button class="btn-style-perso-3 button-typo"
                    aria-label="Valider ressources finan√ßi√®res de vos personnes √† charge" type="submit"
                    tag-action="clic_bouton_valider_ressources_personnes_a_charge">
                    <div>
                        <span>Valider</span>
                    </div>
                </button>
            </div>
        </div>
    </form>
</div>

<ng-template #modalMontantAAHTemplate>
    <app-tooltip [modalRef]="modalService.modalRef" htmlData="
        <h3 class='headline-3-typo headline-3-typo-color'>
            O√π trouver cette information ?
        </h3>
        <p class='body-2-typo'>
            Sur votre derni√®re attestation de paiement CAF üëá
        </p>
        <div class='row mb-5'>
            <img alt='' src='./assets/images/exemples/attestation-aah.png'>
        </div>">
    </app-tooltip>
</ng-template>

<ng-template #modalPensionInvaliditeTemplate>
    <app-tooltip [modalRef]="modalService.modalRef" htmlData="
        <h3 class='headline-3-typo headline-3-typo-color'>
            O√π trouver cette information ?
        </h3>
        <p class='body-2-typo'>
            Sur votre derni√®re attestation de paiement de pension üëá
        </p>
        <div class='row mb-5'>
            <img alt='' src='./assets/images/exemples/attestation-pi.png'>
        </div>">
    </app-tooltip>
</ng-template>