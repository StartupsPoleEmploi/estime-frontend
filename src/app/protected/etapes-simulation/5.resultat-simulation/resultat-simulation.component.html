<div class="container-fluid form-container-fluid" role="form">
    <div class="row">
        <div class="col">
            <h1 class="h1-style-1 headline-1-typo">
                5. {{pageTitlesEnum.RESULTAT_MA_SIMULATION}}
                <button id="infobulle-resultat-simulation" class="img-interrogation-icon"
                    aria-label="Infobulle évolution de résultat" style="vertical-align: baseline;" placement="right top"
                    tag-action="ouverture-infobulle-resultat-simulation"
                    (click)="modalService.openModal($event, modalResultatSimulationTemplate)"></button>
            </h1>
        </div>
    </div>
    <div class="row">
        <div class="col-diagramme-et-mois col-md-8 col-12">
            <div class="row row-style-2">
                <div id="info-resultat-simulation" class="col-12 col-md-12 mt-auto mb-auto">
                    <div id="label-alerte-montants-resultat-simulation"
                        class="text-start body-1-typo color-blue-3-typo">
                        Montants nets, avant éventuel impôt sur le revenu.<br>
                        Simulation à titre d’information, aucune valeur contractuelle.
                    </div>
                </div>
            </div>
            <div class="row row-style-3">
                <div class="col-12">
                    <app-ressources-financieres-diagramme>
                    </app-ressources-financieres-diagramme>
                </div>
            </div>
            <div>
                <div id="title_avant_simulation">
                    <h3 class="headline-3-typo color-blue-2-typo text-start">Avant reprise d'emploi</h3>
                </div>
                <div id="card_ressources_avant_simulation" class="card row mb-3">
                    <div class="col-12 col-md-12">
                        <h4 id="mois_ressources_avant_simulation" class="headline-4-typo color-blue-2-typo text-start">
                            {{ dateUtileService.getLibelleDateActuelle() }}
                        </h4>
                        <h5 id="montant_ressources_avant_simulation"
                            class="headline-5-typo color-blue-10-typo text-start"
                            data-testid="montant_ressources_actuelles">
                            {{simulation.montantRessourcesFinancieresMoisAvantSimulation}} € net
                        </h5>
                    </div>
                </div>
                <div id="title_apres_simulation">
                    <h3 class="headline-3-typo color-blue-2-typo text-start mb-0">Après reprise d'emploi</h3>
                </div>
                <div class="ressources_avant_simulation">
                    <div class="card_ressources_apres_simulation card row mt-3"
                        [ngClass]="{'card-simulations-mobile': screenService.isExtraSmallScreen(), 'card-simulations-desktop': !screenService.isExtraSmallScreen()}"
                        *ngFor="let simulationMensuelle of simulation.simulationsMensuelles; let index = index;"
                        tabindex="0" (keyup)="handleKeyUpOnSimulationMensuelle($event,simulationMensuelle);">
                        <div class="col-md-12 col-12">
                            <app-mois-apres-simulation [simulationSelected]="simulationSelected"
                                [simulationActuelle]="simulationMensuelle"
                                (simulationSelection)="simulationSelection($event)">
                            </app-mois-apres-simulation>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4 col-12">
            <div class="container-fluid" [class]="screenService.isExtraSmallScreen()?'':'pt-5 sticky-top'">
                <div class="row mb-3">
                    <div class="col-md-12">
                        <h3 class="headline-3-typo color-blue-2-typo text-start mb-0">
                            Pour aller plus loin
                        </h3>
                    </div>
                </div>
                <div *ngIf="!screenService.isExtraSmallScreen()" class="row mb-4">
                    <div class="col-12 col-md-12 my-auto">
                        <button class="btn btn-style-perso-6" data-testid="btn-refaire-simulation" tabindex="0"
                            (click)="onClickButtonRefaireSimulation()" (keyup)="handleKeyUpOnRefaireSimulation($event)"
                            tag-navigation="clic_bouton_retour">
                            <span>Modifier la simulation</span>
                        </button>
                    </div>
                    <div class="col-12 col-md-12 my-auto mt-3">
                        <button class="btn btn-style-perso-7" data-testid="btn-telecharger-simulation" tabindex="0"
                            (click)="onClickButtonImprimerMaSimulation()"
                            (keyup)="handleKeyUpOnTelechargerSimulation($event)"
                            tag-download="clic_bouton_telecharger_ma_simulation">
                            <img alt="" src="./assets/images/download_2.svg">
                            <span>Télécharger</span>
                        </button>
                    </div>
                </div>
                <div id="actions-suite">
                    <app-actions-suite>
                    </app-actions-suite>
                </div>
            </div>
        </div>
    </div>
</div>
<div *ngIf="screenService.isExtraSmallScreen()" class="sticky-boutons-modifier-refaire-simulation ">
    <button class="btn btn-modifier-simulation-sticky" data-testid="btn-refaire-simulation" tabindex="0"
        (click)="onClickButtonRefaireSimulation()" (keyup)="handleKeyUpOnRefaireSimulation($event)"
        tag-navigation="clic_bouton_retour">
        <span>Modifier</span>
    </button>
    <button class="btn btn-telecharger-simulation-sticky" data-testid="btn-telecharger-simulation" tabindex="0"
        (click)="onClickButtonImprimerMaSimulation()" (keyup)="handleKeyUpOnTelechargerSimulation($event)"
        tag-download="clic_bouton_telecharger_ma_simulation">
        <img alt="" src="./assets/images/download_2.svg">
        <span>Télécharger</span>
    </button>
</div>
<ng-template #modalResultatSimulationTemplate>
    <app-tooltip [modalRef]="modalService.modalRef" htmlData="
        <p class='body-2-typo'>
            Pour information, si votre situation change et que vous reprenez un emploi, vos allocations sont
            susceptibles d'évoluer.
        </p>">
    </app-tooltip>
</ng-template>

<ng-template #modalDetailMoisApresSimulation>
    <app-detail-mois-apres-simulation *ngIf="simulationSelected" [simulationActuelle]="simulationSelected"
        (aideSelection)="aideSelection($event)">
    </app-detail-mois-apres-simulation>
</ng-template>

<ng-template #modalDetailAideApresSimulation>
    <app-detail-aide-apres-simulation *ngIf="aideSelected" [aide]="aideSelected">
    </app-detail-aide-apres-simulation>
</ng-template>