window.publicodes=function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=18)}([function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function p(e,t,n){return(p=f()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&l(i,n.prototype),i}).apply(null,arguments)}function h(e){var t="function"==typeof Map?new Map:void 0;return(h=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return p(e,arguments,c(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),l(r,e)})(e)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?d(e):t}function m(e){var t=f();return function(){var n,r=c(e);if(t){var i=c(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return v(this,n)}}function b(e,t,n){return(b="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function g(e,t){return O(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){i=!0,a=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw a}}return n}(e,t)||w(e,t)||x()}function y(e){return O(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||w(e)||x()}function O(e){if(Array.isArray(e))return e}function w(e,t){if(e){if("string"==typeof e)return j(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?j(e,t):void 0}}function j(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function x(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=w(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,a=!0,o=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return a=e.done,e},e:function(e){o=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(o)throw i}}}}n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return R})),n.d(t,"c",(function(){return U})),n.d(t,"d",(function(){return L})),n.d(t,"e",(function(){return P})),n.d(t,"f",(function(){return C})),n.d(t,"g",(function(){return E})),n.d(t,"h",(function(){return r})),n.d(t,"i",(function(){return o})),n.d(t,"j",(function(){return i})),n.d(t,"k",(function(){return k})),n.d(t,"l",(function(){return s})),n.d(t,"m",(function(){return B})),n.d(t,"n",(function(){return _})),n.d(t,"o",(function(){return g})),n.d(t,"p",(function(){return I})),n.d(t,"q",(function(){return u})),n.d(t,"r",(function(){return m})),n.d(t,"s",(function(){return b})),n.d(t,"t",(function(){return c})),n.d(t,"u",(function(){return A})),n.d(t,"v",(function(){return M})),n.d(t,"w",(function(){return d})),n.d(t,"x",(function(){return y})),n.d(t,"y",(function(){return v}));var S={ANCHOR:"&",COMMENT:"#",TAG:"!",DIRECTIVES_END:"-",DOCUMENT_END:"."},P={ALIAS:"ALIAS",BLANK_LINE:"BLANK_LINE",BLOCK_FOLDED:"BLOCK_FOLDED",BLOCK_LITERAL:"BLOCK_LITERAL",COMMENT:"COMMENT",DIRECTIVE:"DIRECTIVE",DOCUMENT:"DOCUMENT",FLOW_MAP:"FLOW_MAP",FLOW_SEQ:"FLOW_SEQ",MAP:"MAP",MAP_KEY:"MAP_KEY",MAP_VALUE:"MAP_VALUE",PLAIN:"PLAIN",QUOTE_DOUBLE:"QUOTE_DOUBLE",QUOTE_SINGLE:"QUOTE_SINGLE",SEQ:"SEQ",SEQ_ITEM:"SEQ_ITEM"},k="tag:yaml.org,2002:",A={MAP:"tag:yaml.org,2002:map",SEQ:"tag:yaml.org,2002:seq",STR:"tag:yaml.org,2002:str"};function N(e){for(var t=[0],n=e.indexOf("\n");-1!==n;)n+=1,t.push(n),n=e.indexOf("\n",n);return t}function V(e){var t,n;return"string"==typeof e?(t=N(e),n=e):(Array.isArray(e)&&(e=e[0]),e&&e.context&&(e.lineStarts||(e.lineStarts=N(e.context.src)),t=e.lineStarts,n=e.context.src)),{lineStarts:t,src:n}}function D(e,t){if("number"!=typeof e||e<0)return null;var n=V(t),r=n.lineStarts,i=n.src;if(!r||!i||e>i.length)return null;for(var a=0;a<r.length;++a){var o=r[a];if(e<o)return{line:a,col:e-r[a-1]+1};if(e===o)return{line:a+1,col:1}}var s=r.length;return{line:s,col:e-r[s-1]+1}}function T(e,t){var n=V(t),r=n.lineStarts,i=n.src;if(!r||!(e>=1)||e>r.length)return null;for(var a=r[e-1],o=r[e];o&&o>a&&"\n"===i[o-1];)--o;return i.slice(a,o)}var L=function(){function e(t,n){i(this,e),this.start=t,this.end=n||t}return o(e,null,[{key:"copy",value:function(t){return new e(t.start,t.end)}}]),o(e,[{key:"isEmpty",value:function(){return"number"!=typeof this.start||!this.end||this.end<=this.start}},{key:"setOrigRange",value:function(e,t){var n=this.start,r=this.end;if(0===e.length||r<=e[0])return this.origStart=n,this.origEnd=r,t;for(var i=t;i<e.length&&!(e[i]>n);)++i;this.origStart=n+i;for(var a=i;i<e.length&&!(e[i]>=r);)++i;return this.origEnd=r+i,a}}]),e}(),R=function(){function e(t,n,r){i(this,e),Object.defineProperty(this,"context",{value:r||null,writable:!0}),this.error=null,this.range=null,this.valueRange=null,this.props=n||[],this.type=t,this.value=null}return o(e,null,[{key:"addStringTerminator",value:function(t,n,r){if("\n"===r[r.length-1])return r;var i=e.endOfWhiteSpace(t,n);return i>=t.length||"\n"===t[i]?r+"\n":r}},{key:"atDocumentBoundary",value:function(e,t,n){var r=e[t];if(!r)return!0;var i=e[t-1];if(i&&"\n"!==i)return!1;if(n){if(r!==n)return!1}else if(r!==S.DIRECTIVES_END&&r!==S.DOCUMENT_END)return!1;var a=e[t+1],o=e[t+2];if(a!==r||o!==r)return!1;var s=e[t+3];return!s||"\n"===s||"\t"===s||" "===s}},{key:"endOfIdentifier",value:function(e,t){for(var n=e[t],r="<"===n,i=r?["\n","\t"," ",">"]:["\n","\t"," ","[","]","{","}",","];n&&-1===i.indexOf(n);)n=e[t+=1];return r&&">"===n&&(t+=1),t}},{key:"endOfIndent",value:function(e,t){for(var n=e[t];" "===n;)n=e[t+=1];return t}},{key:"endOfLine",value:function(e,t){for(var n=e[t];n&&"\n"!==n;)n=e[t+=1];return t}},{key:"endOfWhiteSpace",value:function(e,t){for(var n=e[t];"\t"===n||" "===n;)n=e[t+=1];return t}},{key:"startOfLine",value:function(e,t){var n=e[t-1];if("\n"===n)return t;for(;n&&"\n"!==n;)n=e[t-=1];return t+1}},{key:"endOfBlockIndent",value:function(t,n,r){var i=e.endOfIndent(t,r);if(i>r+n)return i;var a=e.endOfWhiteSpace(t,i),o=t[a];return o&&"\n"!==o?null:a}},{key:"atBlank",value:function(e,t,n){var r=e[t];return"\n"===r||"\t"===r||" "===r||n&&!r}},{key:"nextNodeIsIndented",value:function(e,t,n){return!(!e||t<0)&&(t>0||n&&"-"===e)}},{key:"normalizeOffset",value:function(t,n){var r=t[n];return r?"\n"!==r&&"\n"===t[n-1]?n-1:e.endOfWhiteSpace(t,n):n}},{key:"foldNewline",value:function(t,n,r){for(var i=0,a=!1,o="",s=t[n+1];" "===s||"\t"===s||"\n"===s;){switch(s){case"\n":i=0,n+=1,o+="\n";break;case"\t":i<=r&&(a=!0),n=e.endOfWhiteSpace(t,n+2)-1;break;case" ":i+=1,n+=1}s=t[n+1]}return o||(o=" "),s&&i<=r&&(a=!0),{fold:o,offset:n,error:a}}}]),o(e,[{key:"getPropValue",value:function(e,t,n){if(!this.context)return null;var r=this.context.src,i=this.props[e];return i&&r[i.start]===t?r.slice(i.start+(n?1:0),i.end):null}},{key:"commentHasRequiredWhitespace",value:function(t){var n=this.context.src;if(this.header&&t===this.header.end)return!1;if(!this.valueRange)return!1;var r=this.valueRange.end;return t!==r||e.atBlank(n,r-1)}},{key:"parseComment",value:function(t){var n=this.context.src;if(n[t]===S.COMMENT){var r=e.endOfLine(n,t+1),i=new L(t,r);return this.props.push(i),r}return t}},{key:"setOrigRanges",value:function(e,t){return this.range&&(t=this.range.setOrigRange(e,t)),this.valueRange&&this.valueRange.setOrigRange(e,t),this.props.forEach((function(n){return n.setOrigRange(e,t)})),t}},{key:"toString",value:function(){var t=this.context.src,n=this.range,r=this.value;if(null!=r)return r;var i=t.slice(n.start,n.end);return e.addStringTerminator(t,n.end,i)}},{key:"anchor",get:function(){for(var e=0;e<this.props.length;++e){var t=this.getPropValue(e,S.ANCHOR,!0);if(null!=t)return t}return null}},{key:"comment",get:function(){for(var e=[],t=0;t<this.props.length;++t){var n=this.getPropValue(t,S.COMMENT,!0);null!=n&&e.push(n)}return e.length>0?e.join("\n"):null}},{key:"hasComment",get:function(){if(this.context)for(var e=this.context.src,t=0;t<this.props.length;++t)if(e[this.props[t].start]===S.COMMENT)return!0;return!1}},{key:"hasProps",get:function(){if(this.context)for(var e=this.context.src,t=0;t<this.props.length;++t)if(e[this.props[t].start]!==S.COMMENT)return!0;return!1}},{key:"includesTrailingLines",get:function(){return!1}},{key:"jsonLike",get:function(){return-1!==[P.FLOW_MAP,P.FLOW_SEQ,P.QUOTE_DOUBLE,P.QUOTE_SINGLE].indexOf(this.type)}},{key:"rangeAsLinePos",get:function(){if(this.range&&this.context){var e=D(this.range.start,this.context.root);if(e)return{start:e,end:D(this.range.end,this.context.root)}}}},{key:"rawValue",get:function(){if(!this.valueRange||!this.context)return null;var e=this.valueRange,t=e.start,n=e.end;return this.context.src.slice(t,n)}},{key:"tag",get:function(){for(var e=0;e<this.props.length;++e){var t=this.getPropValue(e,S.TAG,!1);if(null!=t){if("<"===t[1])return{verbatim:t.slice(2,-1)};var n=g(t.match(/^(.*!)([^!]*)$/),3);n[0];return{handle:n[1],suffix:n[2]}}}return null}},{key:"valueRangeContainsNewline",get:function(){if(!this.valueRange||!this.context)return!1;for(var e=this.valueRange,t=e.start,n=e.end,r=this.context.src,i=t;i<n;++i)if("\n"===r[i])return!0;return!1}}]),e}(),I=function(e){u(n,e);var t=m(n);function n(e,r,a){var o;if(i(this,n),!(a&&r instanceof R))throw new Error("Invalid arguments for new ".concat(e));return(o=t.call(this)).name=e,o.message=a,o.source=r,o}return o(n,[{key:"makePretty",value:function(){if(this.source){this.nodeType=this.source.type;var e=this.source.context&&this.source.context.root;if("number"==typeof this.offset){this.range=new L(this.offset,this.offset+1);var t=e&&D(this.offset,e);if(t){var n={line:t.line,col:t.col+1};this.linePos={start:t,end:n}}delete this.offset}else this.range=this.source.range,this.linePos=this.source.rangeAsLinePos;if(this.linePos){var r=this.linePos.start,i=r.line,a=r.col;this.message+=" at line ".concat(i,", column ").concat(a);var o=e&&function(e,t){var n=e.start,r=e.end,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:80,a=T(n.line,t);if(!a)return null;var o=n.col;if(a.length>i)if(o<=i-10)a=a.substr(0,i-1)+"…";else{var s=Math.round(i/2);a.length>o+s&&(a=a.substr(0,o+s-1)+"…"),o-=a.length-i,a="…"+a.substr(1-i)}var u=1,c="";r&&(r.line===n.line&&o+(r.col-n.col)<=i+1?u=r.col-n.col:(u=Math.min(a.length+1,i)-o,c="…"));var l=o>1?" ".repeat(o-1):"",f="^".repeat(u);return"".concat(a,"\n").concat(l).concat(f).concat(c)}(this.linePos,e);o&&(this.message+=":\n\n".concat(o,"\n"))}delete this.source}}}]),n}(h(Error)),M=function(e){u(n,e);var t=m(n);function n(e,r){return i(this,n),t.call(this,"YAMLReferenceError",e,r)}return n}(I),_=function(e){u(n,e);var t=m(n);function n(e,r){return i(this,n),t.call(this,"YAMLSemanticError",e,r)}return n}(I),C=function(e){u(n,e);var t=m(n);function n(e,r){return i(this,n),t.call(this,"YAMLSyntaxError",e,r)}return n}(I),B=function(e){u(n,e);var t=m(n);function n(e,r){return i(this,n),t.call(this,"YAMLWarning",e,r)}return n}(I),U=function(e){u(n,e);var t=m(n);function n(){return i(this,n),t.apply(this,arguments)}return o(n,[{key:"parseBlockValue",value:function(e){for(var t=this.context,r=t.indent,i=t.inFlow,a=t.src,o=e,s=e,u=a[o];"\n"===u&&!R.atDocumentBoundary(a,o+1);u=a[o]){var c=R.endOfBlockIndent(a,r,o+1);if(null===c||"#"===a[c])break;o="\n"===a[c]?c:s=n.endOfLine(a,c,i)}return this.valueRange.isEmpty()&&(this.valueRange.start=e),this.valueRange.end=s,s}},{key:"parse",value:function(e,t){this.context=e;var r=e.inFlow,i=e.src,a=t,o=i[a];return o&&"#"!==o&&"\n"!==o&&(a=n.endOfLine(i,t,r)),this.valueRange=new L(t,a),a=R.endOfWhiteSpace(i,a),a=this.parseComment(a),this.hasComment&&!this.valueRange.isEmpty()||(a=this.parseBlockValue(a)),a}},{key:"strValue",get:function(){if(!this.valueRange||!this.context)return null;for(var e=this.valueRange,t=e.start,n=e.end,r=this.context.src,i=r[n-1];t<n&&("\n"===i||"\t"===i||" "===i);)i=r[--n-1];for(var a="",o=t;o<n;++o){var s=r[o];if("\n"===s){var u=R.foldNewline(r,o,-1);a+=u.fold,o=u.offset}else if(" "===s||"\t"===s){for(var c=o,l=r[o+1];o<n&&(" "===l||"\t"===l);)l=r[(o+=1)+1];"\n"!==l&&(a+=o>c?r.slice(c,o+1):s)}else a+=s}var f=r[t];switch(f){case"\t":return{errors:[new _(this,"Plain value cannot start with a tab character")],str:a};case"@":case"`":var p="Plain value cannot start with reserved character ".concat(f);return{errors:[new _(this,p)],str:a};default:return a}}}],[{key:"endOfLine",value:function(e,t,n){for(var r=e[t],i=t;r&&"\n"!==r&&(!n||"["!==r&&"]"!==r&&"{"!==r&&"}"!==r&&","!==r);){var a=e[i+1];if(":"===r&&(!a||"\n"===a||"\t"===a||" "===a||n&&","===a))break;if((" "===r||"\t"===r)&&"#"===a)break;i+=1,r=a}return i}}]),n}(R)},function(e,t,n){"use strict";n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return h})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return O})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return T})),n.d(t,"k",(function(){return b})),n.d(t,"l",(function(){return c})),n.d(t,"m",(function(){return i})),n.d(t,"n",(function(){return F})),n.d(t,"o",(function(){return W})),n.d(t,"p",(function(){return w})),n.d(t,"q",(function(){return C})),n.d(t,"r",(function(){return L})),n.d(t,"s",(function(){return m})),n.d(t,"t",(function(){return j})),n.d(t,"u",(function(){return K})),n.d(t,"v",(function(){return x})),n.d(t,"w",(function(){return o}));var r=n(0);function i(e,t,n){return n?-1===n.indexOf("\n")?"".concat(e," #").concat(n):"".concat(e,"\n")+n.replace(/^/gm,"".concat(t||"","#")):e}var a=function e(){Object(r.j)(this,e)};function o(e,t,n){if(Array.isArray(e))return e.map((function(e,t){return o(e,String(t),n)}));if(e&&"function"==typeof e.toJSON){var r=n&&n.anchors&&n.anchors.get(e);r&&(n.onCreate=function(e){r.res=e,delete n.onCreate});var i=e.toJSON(t,n);return r&&n.onCreate&&n.onCreate(i),i}return n&&n.keep||"bigint"!=typeof e?e:Number(e)}var s=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(e){var i;return Object(r.j)(this,n),(i=t.call(this)).value=e,i}return Object(r.i)(n,[{key:"toJSON",value:function(e,t){return t&&t.keep?this.value:o(this.value,e,t)}},{key:"toString",value:function(){return String(this.value)}}]),n}(a);function u(e,t,n){for(var r=n,i=t.length-1;i>=0;--i){var a=t[i],o=Number.isInteger(a)&&a>=0?[]:{};o[a]=r,r=o}return e.createNode(r,!1)}var c=function(e){return null==e||"object"===Object(r.h)(e)&&e[Symbol.iterator]().next().done},l=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(e){var i;return Object(r.j)(this,n),i=t.call(this),Object(r.l)(Object(r.w)(i),"items",[]),i.schema=e,i}return Object(r.i)(n,[{key:"addIn",value:function(e,t){if(c(e))this.add(t);else{var i=Object(r.x)(e),a=i[0],o=i.slice(1),s=this.get(a,!0);if(s instanceof n)s.addIn(o,t);else{if(void 0!==s||!this.schema)throw new Error("Expected YAML collection at ".concat(a,". Remaining path: ").concat(o));this.set(a,u(this.schema,o,t))}}}},{key:"deleteIn",value:function(e){var t=Object(r.x)(e),i=t[0],a=t.slice(1);if(0===a.length)return this.delete(i);var o=this.get(i,!0);if(o instanceof n)return o.deleteIn(a);throw new Error("Expected YAML collection at ".concat(i,". Remaining path: ").concat(a))}},{key:"getIn",value:function(e,t){var i=Object(r.x)(e),a=i[0],o=i.slice(1),u=this.get(a,!0);return 0===o.length?!t&&u instanceof s?u.value:u:u instanceof n?u.getIn(o,t):void 0}},{key:"hasAllNullValues",value:function(){return this.items.every((function(e){if(!e||"PAIR"!==e.type)return!1;var t=e.value;return null==t||t instanceof s&&null==t.value&&!t.commentBefore&&!t.comment&&!t.tag}))}},{key:"hasIn",value:function(e){var t=Object(r.x)(e),i=t[0],a=t.slice(1);if(0===a.length)return this.has(i);var o=this.get(i,!0);return o instanceof n&&o.hasIn(a)}},{key:"setIn",value:function(e,t){var i=Object(r.x)(e),a=i[0],o=i.slice(1);if(0===o.length)this.set(a,t);else{var s=this.get(a,!0);if(s instanceof n)s.setIn(o,t);else{if(void 0!==s||!this.schema)throw new Error("Expected YAML collection at ".concat(a,". Remaining path: ").concat(o));this.set(a,u(this.schema,o,t))}}}},{key:"toJSON",value:function(){return null}},{key:"toString",value:function(e,t,a,o){var s=this,u=t.blockItem,c=t.flowChars,l=t.isMap,f=t.itemIndent,p=e,h=p.indent,d=p.indentStep,v=p.stringify,m=this.type===r.e.FLOW_MAP||this.type===r.e.FLOW_SEQ||e.inFlow;m&&(f+=d);var b=l&&this.hasAllNullValues();e=Object.assign({},e,{allNullValues:b,indent:f,inFlow:m,type:null});var g,y=!1,O=!1,w=this.items.reduce((function(t,n,r){var a;n&&(!y&&n.spaceBefore&&t.push({type:"comment",str:""}),n.commentBefore&&n.commentBefore.match(/^.*$/gm).forEach((function(e){t.push({type:"comment",str:"#".concat(e)})})),n.comment&&(a=n.comment),m&&(!y&&n.spaceBefore||n.commentBefore||n.comment||n.key&&(n.key.commentBefore||n.key.comment)||n.value&&(n.value.commentBefore||n.value.comment))&&(O=!0)),y=!1;var o=v(n,e,(function(){return a=null}),(function(){return y=!0}));return m&&!O&&o.includes("\n")&&(O=!0),m&&r<s.items.length-1&&(o+=","),o=i(o,f,a),y&&(a||m)&&(y=!1),t.push({type:"item",str:o}),t}),[]);if(0===w.length)g=c.start+c.end;else if(m){var j=c.start,x=c.end,E=w.map((function(e){return e.str}));if(O||E.reduce((function(e,t){return e+t.length+2}),2)>n.maxFlowStringSingleLineLength){g=j;var S,P=Object(r.g)(E);try{for(P.s();!(S=P.n()).done;){var k=S.value;g+=k?"\n".concat(d).concat(h).concat(k):"\n"}}catch(e){P.e(e)}finally{P.f()}g+="\n".concat(h).concat(x)}else g="".concat(j," ").concat(E.join(" ")," ").concat(x)}else{var A=w.map(u);g=A.shift();var N,V=Object(r.g)(A);try{for(V.s();!(N=V.n()).done;){var D=N.value;g+=D?"\n".concat(h).concat(D):"\n"}}catch(e){V.e(e)}finally{V.f()}}return this.comment?(g+="\n"+this.comment.replace(/^/gm,"".concat(h,"#")),a&&a()):y&&o&&o(),g}}]),n}(a);function f(e){var t=e instanceof s?e.value:e;return t&&"string"==typeof t&&(t=Number(t)),Number.isInteger(t)&&t>=0?t:null}Object(r.l)(l,"maxFlowStringSingleLineLength",60);var p=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(){return Object(r.j)(this,n),t.apply(this,arguments)}return Object(r.i)(n,[{key:"add",value:function(e){this.items.push(e)}},{key:"delete",value:function(e){var t=f(e);return"number"==typeof t&&this.items.splice(t,1).length>0}},{key:"get",value:function(e,t){var n=f(e);if("number"==typeof n){var r=this.items[n];return!t&&r instanceof s?r.value:r}}},{key:"has",value:function(e){var t=f(e);return"number"==typeof t&&t<this.items.length}},{key:"set",value:function(e,t){var n=f(e);if("number"!=typeof n)throw new Error("Expected a valid index, not ".concat(e,"."));this.items[n]=t}},{key:"toJSON",value:function(e,t){var n=[];t&&t.onCreate&&t.onCreate(n);var i,a=0,s=Object(r.g)(this.items);try{for(s.s();!(i=s.n()).done;){var u=i.value;n.push(o(u,String(a++),t))}}catch(e){s.e(e)}finally{s.f()}return n}},{key:"toString",value:function(e,t,i){return e?Object(r.s)(Object(r.t)(n.prototype),"toString",this).call(this,e,{blockItem:function(e){return"comment"===e.type?e.str:"- ".concat(e.str)},flowChars:{start:"[",end:"]"},isMap:!1,itemIndent:(e.indent||"")+"  "},t,i):JSON.stringify(this)}}]),n}(l),h=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(e){var i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(r.j)(this,n),(i=t.call(this)).key=e,i.value=a,i.type=n.Type.PAIR,i}return Object(r.i)(n,[{key:"addToJSMap",value:function(e,t){var n=o(this.key,"",e);if(t instanceof Map){var i=o(this.value,n,e);t.set(n,i)}else if(t instanceof Set)t.add(n);else{var s=function(e,t,n){return null===t?"":"object"!==Object(r.h)(t)?String(t):e instanceof a&&n&&n.doc?e.toString({anchors:{},doc:n.doc,indent:"",indentStep:n.indentStep,inFlow:!0,inStringifyKey:!0,stringify:n.stringify}):JSON.stringify(t)}(this.key,n,e);t[s]=o(this.value,s,e)}return t}},{key:"toJSON",value:function(e,t){var n=t&&t.mapAsMap?new Map:{};return this.addToJSMap(t,n)}},{key:"toString",value:function(e,t,n){if(!e||!e.doc)return JSON.stringify(this);var o=e.doc.options,u=o.indent,c=o.indentSeq,f=o.simpleKeys,h=this.key,d=this.value,v=h instanceof a&&h.comment;if(f){if(v)throw new Error("With simple keys, key nodes cannot have comments");if(h instanceof l){throw new Error("With simple keys, collection cannot be used as a key value")}}var m=!f&&(!h||v||h instanceof l||h.type===r.e.BLOCK_FOLDED||h.type===r.e.BLOCK_LITERAL),b=e,g=b.doc,y=b.indent,O=b.indentStep,w=b.stringify;e=Object.assign({},e,{implicitKey:!m,indent:y+O});var j=!1,x=w(h,e,(function(){return v=null}),(function(){return j=!0}));if(x=i(x,e.indent,v),e.allNullValues&&!f)return this.comment?(x=i(x,e.indent,this.comment),t&&t()):j&&!v&&n&&n(),e.inFlow?x:"? ".concat(x);x=m?"? ".concat(x,"\n").concat(y,":"):"".concat(x,":"),this.comment&&(x=i(x,e.indent,this.comment),t&&t());var E="",S=null;if(d instanceof a){if(d.spaceBefore&&(E="\n"),d.commentBefore){var P=d.commentBefore.replace(/^/gm,"".concat(e.indent,"#"));E+="\n".concat(P)}S=d.comment}else d&&"object"===Object(r.h)(d)&&(d=g.schema.createNode(d,!0));e.implicitKey=!1,!m&&!this.comment&&d instanceof s&&(e.indentAtStart=x.length+1),j=!1,!c&&u>=2&&!e.inFlow&&!m&&d instanceof p&&d.type!==r.e.FLOW_SEQ&&!d.tag&&!g.anchors.getName(d)&&(e.indent=e.indent.substr(2));var k=w(d,e,(function(){return S=null}),(function(){return j=!0})),A=" ";if(E||this.comment)A="".concat(E,"\n").concat(e.indent);else if(!m&&d instanceof l){("["===k[0]||"{"===k[0])&&!k.includes("\n")||(A="\n".concat(e.indent))}return j&&!S&&n&&n(),i(x+A+k,e.indent,S)}},{key:"commentBefore",get:function(){return this.key instanceof a?this.key.commentBefore:void 0},set:function(e){if(null==this.key&&(this.key=new s(null)),!(this.key instanceof a)){throw new Error("Pair.commentBefore is an alias for Pair.key.commentBefore. To set it, the key must be a Node.")}this.key.commentBefore=e}}]),n}(a);Object(r.l)(h,"Type",{PAIR:"PAIR",MERGE_PAIR:"MERGE_PAIR"});var d=function e(t,n){if(t instanceof v){var i=n.get(t.source);return i.count*i.aliasCount}if(t instanceof l){var a,o=0,s=Object(r.g)(t.items);try{for(s.s();!(a=s.n()).done;){var u=e(a.value,n);u>o&&(o=u)}}catch(e){s.e(e)}finally{s.f()}return o}if(t instanceof h){var c=e(t.key,n),f=e(t.value,n);return Math.max(c,f)}return 1},v=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(e){var i;return Object(r.j)(this,n),(i=t.call(this)).source=e,i.type=r.e.ALIAS,i}return Object(r.i)(n,null,[{key:"stringify",value:function(e,t){var n=e.range,r=e.source,i=t.anchors,a=t.doc,o=t.implicitKey,s=t.inStringifyKey,u=Object.keys(i).find((function(e){return i[e]===r}));if(!u&&s&&(u=a.anchors.getName(r)||a.anchors.newName()),u)return"*".concat(u).concat(o?" ":"");var c=a.anchors.getName(r)?"Alias node must be after source node":"Source node not found for alias node";throw new Error("".concat(c," [").concat(n,"]"))}}]),Object(r.i)(n,[{key:"toJSON",value:function(e,t){if(!t)return o(this.source,e,t);var n=t.anchors,i=t.maxAliasCount,a=n.get(this.source);if(!a||void 0===a.res){var s="This should not happen: Alias anchor was not resolved?";throw this.cstNode?new r.v(this.cstNode,s):new ReferenceError(s)}if(i>=0&&(a.count+=1,0===a.aliasCount&&(a.aliasCount=d(this.source,n)),a.count*a.aliasCount>i)){var u="Excessive alias count indicates a resource exhaustion attack";throw this.cstNode?new r.v(this.cstNode,u):new ReferenceError(u)}return a.res}},{key:"toString",value:function(e){return n.stringify(this,e)}},{key:"tag",set:function(e){throw new Error("Alias nodes cannot have tags")}}]),n}(a);function m(e,t){var n,i=t instanceof s?t.value:t,a=Object(r.g)(e);try{for(a.s();!(n=a.n()).done;){var o=n.value;if(o instanceof h){if(o.key===t||o.key===i)return o;if(o.key&&o.key.value===i)return o}}}catch(e){a.e(e)}finally{a.f()}}Object(r.l)(v,"default",!0);var b=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(){return Object(r.j)(this,n),t.apply(this,arguments)}return Object(r.i)(n,[{key:"add",value:function(e,t){e?e instanceof h||(e=new h(e.key||e,e.value)):e=new h(e);var n=m(this.items,e.key),r=this.schema&&this.schema.sortMapEntries;if(n){if(!t)throw new Error("Key ".concat(e.key," already set"));n.value=e.value}else if(r){var i=this.items.findIndex((function(t){return r(e,t)<0}));-1===i?this.items.push(e):this.items.splice(i,0,e)}else this.items.push(e)}},{key:"delete",value:function(e){var t=m(this.items,e);return!!t&&this.items.splice(this.items.indexOf(t),1).length>0}},{key:"get",value:function(e,t){var n=m(this.items,e),r=n&&n.value;return!t&&r instanceof s?r.value:r}},{key:"has",value:function(e){return!!m(this.items,e)}},{key:"set",value:function(e,t){this.add(new h(e,t),!0)}},{key:"toJSON",value:function(e,t,n){var i=n?new n:t&&t.mapAsMap?new Map:{};t&&t.onCreate&&t.onCreate(i);var a,o=Object(r.g)(this.items);try{for(o.s();!(a=o.n()).done;){a.value.addToJSMap(t,i)}}catch(e){o.e(e)}finally{o.f()}return i}},{key:"toString",value:function(e,t,i){if(!e)return JSON.stringify(this);var a,o=Object(r.g)(this.items);try{for(o.s();!(a=o.n()).done;){var s=a.value;if(!(s instanceof h))throw new Error("Map items must all be pairs; found ".concat(JSON.stringify(s)," instead"))}}catch(e){o.e(e)}finally{o.f()}return Object(r.s)(Object(r.t)(n.prototype),"toString",this).call(this,e,{blockItem:function(e){return e.str},flowChars:{start:"{",end:"}"},isMap:!0,itemIndent:e.indent||""},t,i)}}]),n}(l),g=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(e){var i;if(Object(r.j)(this,n),e instanceof h){var a=e.value;a instanceof p||((a=new p).items.push(e.value),a.range=e.value.range),(i=t.call(this,e.key,a)).range=e.range}else i=t.call(this,new s("<<"),new p);return i.type=h.Type.MERGE_PAIR,Object(r.y)(i)}return Object(r.i)(n,[{key:"addToJSMap",value:function(e,t){var n,i=Object(r.g)(this.value.items);try{for(i.s();!(n=i.n()).done;){var a=n.value.source;if(!(a instanceof b))throw new Error("Merge sources must be maps");var o,s=a.toJSON(null,e,Map),u=Object(r.g)(s);try{for(u.s();!(o=u.n()).done;){var c=Object(r.o)(o.value,2),l=c[0],f=c[1];t instanceof Map?t.has(l)||t.set(l,f):t instanceof Set?t.add(l):Object.prototype.hasOwnProperty.call(t,l)||(t[l]=f)}}catch(e){u.e(e)}finally{u.f()}}}catch(e){i.e(e)}finally{i.f()}return t}},{key:"toString",value:function(e,t){var i=this.value;if(i.items.length>1)return Object(r.s)(Object(r.t)(n.prototype),"toString",this).call(this,e,t);this.value=i.items[0];var a=Object(r.s)(Object(r.t)(n.prototype),"toString",this).call(this,e,t);return this.value=i,a}}]),n}(h),y={defaultType:r.e.BLOCK_LITERAL,lineWidth:76},O={trueStr:"true",falseStr:"false"},w={asBigInt:!1},j={nullStr:"null"},x={defaultType:r.e.PLAIN,doubleQuoted:{jsonEncoding:!1,minMultiLineLength:40},fold:{lineWidth:80,minContentWidth:20}};function E(e,t,n){var i,a=Object(r.g)(t);try{for(a.s();!(i=a.n()).done;){var o=i.value,u=o.format,c=o.test,l=o.resolve;if(c){var f=e.match(c);if(f){var p=l.apply(null,f);return p instanceof s||(p=new s(p)),u&&(p.format=u),p}}}}catch(e){a.e(e)}finally{a.f()}return n&&(e=n(e)),new s(e)}var S=function(e,t){for(var n=e[t+1];" "===n||"\t"===n;){do{n=e[t+=1]}while(n&&"\n"!==n);n=e[t+1]}return t};function P(e,t,n,r){var i=r.indentAtStart,a=r.lineWidth,o=void 0===a?80:a,s=r.minContentWidth,u=void 0===s?20:s,c=r.onFold,l=r.onOverflow;if(!o||o<0)return e;var f=Math.max(1+u,1+o-t.length);if(e.length<=f)return e;var p,h=[],d={},v=o-("number"==typeof i?i:t.length),m=void 0,b=void 0,g=!1,y=-1;for("block"===n&&-1!==(y=S(e,y))&&(v=y+f);p=e[y+=1];){if("quoted"===n&&"\\"===p)switch(e[y+1]){case"x":y+=3;break;case"u":y+=5;break;case"U":y+=9;break;default:y+=1}if("\n"===p)"block"===n&&(y=S(e,y)),v=y+f,m=void 0;else{if(" "===p&&b&&" "!==b&&"\n"!==b&&"\t"!==b){var O=e[y+1];O&&" "!==O&&"\n"!==O&&"\t"!==O&&(m=y)}if(y>=v)if(m)h.push(m),v=m+f,m=void 0;else if("quoted"===n){for(;" "===b||"\t"===b;)b=p,p=e[y+=1],g=!0;h.push(y-2),d[y-2]=!0,v=y-2+f,m=void 0}else g=!0}b=p}if(g&&l&&l(),0===h.length)return e;c&&c();for(var w=e.slice(0,h[0]),j=0;j<h.length;++j){var x=h[j],E=h[j+1]||e.length;"quoted"===n&&d[x]&&(w+="".concat(e[x],"\\")),w+="\n".concat(t).concat(e.slice(x+1,E))}return w}var k=function(e){var t=e.indentAtStart;return t?Object.assign({indentAtStart:t},x.fold):x.fold},A=function(e){return/^(%|---|\.\.\.)/m.test(e)};function N(e,t){var n=t.implicitKey,r=x.doubleQuoted,i=r.jsonEncoding,a=r.minMultiLineLength,o=JSON.stringify(e);if(i)return o;for(var s=t.indent||(A(e)?"  ":""),u="",c=0,l=0,f=o[l];f;f=o[++l])if(" "===f&&"\\"===o[l+1]&&"n"===o[l+2]&&(u+=o.slice(c,l)+"\\ ",c=l+=1,f="\\"),"\\"===f)switch(o[l+1]){case"u":u+=o.slice(c,l);var p=o.substr(l+2,4);switch(p){case"0000":u+="\\0";break;case"0007":u+="\\a";break;case"000b":u+="\\v";break;case"001b":u+="\\e";break;case"0085":u+="\\N";break;case"00a0":u+="\\_";break;case"2028":u+="\\L";break;case"2029":u+="\\P";break;default:"00"===p.substr(0,2)?u+="\\x"+p.substr(2):u+=o.substr(l,6)}c=(l+=5)+1;break;case"n":if(n||'"'===o[l+2]||o.length<a)l+=1;else{for(u+=o.slice(c,l)+"\n\n";"\\"===o[l+2]&&"n"===o[l+3]&&'"'!==o[l+4];)u+="\n",l+=2;u+=s," "===o[l+2]&&(u+="\\"),c=(l+=1)+1}break;default:l+=1}return u=c?u+o.slice(c):o,n?u:P(u,s,"quoted",k(t))}function V(e,t){if(t.implicitKey){if(/\n/.test(e))return N(e,t)}else if(/[ \t]\n|\n[ \t]/.test(e))return N(e,t);var n=t.indent||(A(e)?"  ":""),r="'"+e.replace(/'/g,"''").replace(/\n+/g,"$&\n".concat(n))+"'";return t.implicitKey?r:P(r,n,"flow",k(t))}function D(e,t,n,i){var a=e.comment,o=e.type,s=e.value;if(/\n[\t ]+$/.test(s)||/^\s*$/.test(s))return N(s,t);var u=t.indent||(t.forceBlockIndent||A(s)?"  ":""),c=u?"2":"1",l=o!==r.e.BLOCK_FOLDED&&(o===r.e.BLOCK_LITERAL||!function(e,t){var n=e.length;if(n<=t)return!1;for(var r=0,i=0;r<n;++r)if("\n"===e[r]){if(r-i>t)return!0;if(n-(i=r+1)<=t)return!1}return!0}(s,x.fold.lineWidth-u.length)),f=l?"|":">";if(!s)return f+"\n";var p="",h="";if(s=s.replace(/[\n\t ]*$/,(function(e){var t=e.indexOf("\n");return-1===t?f+="-":s!==e&&t===e.length-1||(f+="+",i&&i()),h=e.replace(/\n$/,""),""})).replace(/^[\n ]*/,(function(e){-1!==e.indexOf(" ")&&(f+=c);var t=e.match(/ +$/);return t?(p=e.slice(0,-t[0].length),t[0]):(p=e,"")})),h&&(h=h.replace(/\n+(?!\n|$)/g,"$&".concat(u))),p&&(p=p.replace(/\n+/g,"$&".concat(u))),a&&(f+=" #"+a.replace(/ ?[\r\n]+/g," "),n&&n()),!s)return"".concat(f).concat(c,"\n").concat(u).concat(h);if(l)return s=s.replace(/\n+/g,"$&".concat(u)),"".concat(f,"\n").concat(u).concat(p).concat(s).concat(h);s=s.replace(/\n+/g,"\n$&").replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,"$&".concat(u));var d=P("".concat(p).concat(s).concat(h),u,"block",x.fold);return"".concat(f,"\n").concat(u).concat(d)}function T(e,t,n,i){var a=x.defaultType,o=t.implicitKey,s=t.inFlow,u=e,c=u.type,l=u.value;"string"!=typeof l&&(l=String(l),e=Object.assign({},e,{value:l}));var f=function(a){switch(a){case r.e.BLOCK_FOLDED:case r.e.BLOCK_LITERAL:return D(e,t,n,i);case r.e.QUOTE_DOUBLE:return N(l,t);case r.e.QUOTE_SINGLE:return V(l,t);case r.e.PLAIN:return function(e,t,n,i){var a=e.comment,o=e.type,s=e.value,u=t.actualString,c=t.implicitKey,l=t.indent,f=t.inFlow;if(c&&/[\n[\]{},]/.test(s)||f&&/[[\]{},]/.test(s))return N(s,t);if(!s||/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(s))return c||f||-1===s.indexOf("\n")?-1!==s.indexOf('"')&&-1===s.indexOf("'")?V(s,t):N(s,t):D(e,t,n,i);if(!c&&!f&&o!==r.e.PLAIN&&-1!==s.indexOf("\n"))return D(e,t,n,i);if(""===l&&A(s))return t.forceBlockIndent=!0,D(e,t,n,i);var p=s.replace(/\n+/g,"$&\n".concat(l));if(u){var h=t.doc.schema.tags;if("string"!=typeof E(p,h,h.scalarFallback).value)return N(s,t)}var d=c?p:P(p,l,"flow",k(t));return!a||f||-1===d.indexOf("\n")&&-1===a.indexOf("\n")?d:(n&&n(),function(e,t,n){if(!n)return e;var r=n.replace(/[\s\S]^/gm,"$&".concat(t,"#"));return"#".concat(r,"\n").concat(t).concat(e)}(d,l,a))}(e,t,n,i);default:return null}};c!==r.e.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f]/.test(l)?c=r.e.QUOTE_DOUBLE:!o&&!s||c!==r.e.BLOCK_FOLDED&&c!==r.e.BLOCK_LITERAL||(c=r.e.QUOTE_DOUBLE);var p=f(c);if(null===p&&null===(p=f(a)))throw new Error("Unsupported default string type ".concat(a));return p}function L(e){var t=e.format,n=e.minFractionDigits,r=e.tag,i=e.value;if("bigint"==typeof i)return String(i);if(!isFinite(i))return isNaN(i)?".nan":i<0?"-.inf":".inf";var a=JSON.stringify(i);if(!t&&n&&(!r||"tag:yaml.org,2002:float"===r)&&/^\d/.test(a)){var o=a.indexOf(".");o<0&&(o=a.length,a+=".");for(var s=n-(a.length-o-1);s-- >0;)a+="0"}return a}function R(e,t){var n,i,a;switch(t.type){case r.e.FLOW_MAP:n="}",i="flow map";break;case r.e.FLOW_SEQ:n="]",i="flow sequence";break;default:return void e.push(new r.n(t,"Not a flow collection!?"))}for(var o=t.items.length-1;o>=0;--o){var s=t.items[o];if(!s||s.type!==r.e.COMMENT){a=s;break}}if(a&&a.char!==n){var u,c="Expected ".concat(i," to end with ").concat(n);"number"==typeof a.offset?(u=new r.n(t,c)).offset=a.offset+1:(u=new r.n(a,c),a.range&&a.range.end&&(u.offset=a.range.end-a.range.start)),e.push(u)}}function I(e,t){var n=t.context.src[t.range.start-1];if("\n"!==n&&"\t"!==n&&" "!==n){e.push(new r.n(t,"Comments must be separated from other tokens by white space characters"))}}function M(e,t){var n=String(t),i=n.substr(0,8)+"..."+n.substr(-8);return new r.n(e,'The "'.concat(i,'" key is too long'))}function _(e,t){var n,i=Object(r.g)(t);try{for(i.s();!(n=i.n()).done;){var a=n.value,o=a.afterKey,s=a.before,u=a.comment,c=e.items[s];c?(o&&c.value&&(c=c.value),void 0===u?!o&&c.commentBefore||(c.spaceBefore=!0):c.commentBefore?c.commentBefore+="\n"+u:c.commentBefore=u):void 0!==u&&(e.comment?e.comment+="\n"+u:e.comment=u)}}catch(e){i.e(e)}finally{i.f()}}function C(e,t){var n=t.strValue;return n?"string"==typeof n?n:(n.errors.forEach((function(n){n.source||(n.source=t),e.errors.push(n)})),n.str):""}function B(e,t){var n=t.tag,i=t.type,a=!1;if(n){var o=n.handle,s=n.suffix,u=n.verbatim;if(u){if("!"!==u&&"!!"!==u)return u;var c="Verbatim tags aren't resolved, so ".concat(u," is invalid.");e.errors.push(new r.n(t,c))}else if("!"!==o||s)try{return function(e,t){var n=t.tag,i=n.handle,a=n.suffix,o=e.tagPrefixes.find((function(e){return e.handle===i}));if(!o){var s=e.getDefaults().tagPrefixes;if(s&&(o=s.find((function(e){return e.handle===i}))),!o)throw new r.n(t,"The ".concat(i," tag handle is non-default and was not declared."))}if(!a)throw new r.n(t,"The ".concat(i," tag has no suffix."));if("!"===i&&"1.0"===(e.version||e.options.version)){if("^"===a[0])return e.warnings.push(new r.m(t,"YAML 1.0 ^ tag expansion is not supported")),a;if(/[:/]/.test(a)){var u=a.match(/^([a-z0-9-]+)\/(.*)/i);return u?"tag:".concat(u[1],".yaml.org,2002:").concat(u[2]):"tag:".concat(a)}}return o.prefix+decodeURIComponent(a)}(e,t)}catch(t){e.errors.push(t)}else a=!0}switch(i){case r.e.BLOCK_FOLDED:case r.e.BLOCK_LITERAL:case r.e.QUOTE_DOUBLE:case r.e.QUOTE_SINGLE:return r.u.STR;case r.e.FLOW_MAP:case r.e.MAP:return r.u.MAP;case r.e.FLOW_SEQ:case r.e.SEQ:return r.u.SEQ;case r.e.PLAIN:return a?r.u.STR:null;default:return null}}function U(e,t,n){var i,a=e.schema.tags,o=[],u=Object(r.g)(a);try{for(u.s();!(i=u.n()).done;){var c=i.value;if(c.tag===n){if(!c.test){var f=c.resolve(e,t);return f instanceof l?f:new s(f)}o.push(c)}}}catch(e){u.e(e)}finally{u.f()}var p=C(e,t);return"string"==typeof p&&o.length>0?E(p,o,a.scalarFallback):null}function q(e,t,n){try{var i=U(e,t,n);if(i)return n&&t.tag&&(i.tag=n),i}catch(n){return n.source||(n.source=t),e.errors.push(n),null}try{var a=function(e){switch(e.type){case r.e.FLOW_MAP:case r.e.MAP:return r.u.MAP;case r.e.FLOW_SEQ:case r.e.SEQ:return r.u.SEQ;default:return r.u.STR}}(t);if(!a)throw new Error("The tag ".concat(n," is unavailable"));var o="The tag ".concat(n," is unavailable, falling back to ").concat(a);e.warnings.push(new r.m(t,o));var s=U(e,t,a);return s.tag=n,s}catch(n){var u=new r.v(t,n.message);return u.stack=n.stack,e.errors.push(u),null}}function $(e,t){var n,i={before:[],after:[]},a=!1,o=!1,s=function(e){if(!e)return!1;var t=e.type;return t===r.e.MAP_KEY||t===r.e.MAP_VALUE||t===r.e.SEQ_ITEM}(t.context.parent)?t.context.parent.props.concat(t.props):t.props,u=Object(r.g)(s);try{for(u.s();!(n=u.n()).done;){var c=n.value,l=c.start,f=c.end;switch(t.context.src[l]){case r.a.COMMENT:if(!t.commentHasRequiredWhitespace(l)){e.push(new r.n(t,"Comments must be separated from other tokens by white space characters"))}var p=t.header,h=t.valueRange;(h&&(l>h.start||p&&l>p.start)?i.after:i.before).push(t.context.src.slice(l+1,f));break;case r.a.ANCHOR:if(a){e.push(new r.n(t,"A node can have at most one anchor"))}a=!0;break;case r.a.TAG:if(o){e.push(new r.n(t,"A node can have at most one tag"))}o=!0}}}catch(e){u.e(e)}finally{u.f()}return{comments:i,hasAnchor:a,hasTag:o}}function K(e,t){if(!t)return null;t.error&&e.errors.push(t.error);var n=$(e.errors,t),i=n.comments,a=n.hasAnchor,o=n.hasTag;if(a){var s=e.anchors,u=t.anchor,c=s.getNode(u);c&&(s.map[s.newName(u)]=c),s.map[u]=t}if(t.type===r.e.ALIAS&&(a||o)){e.errors.push(new r.n(t,"An alias node must not specify any properties"))}var l=function(e,t){var n=e.anchors,i=e.errors,a=e.schema;if(t.type===r.e.ALIAS){var o=t.rawValue,s=n.getNode(o);if(!s){var u="Aliased anchor not found: ".concat(o);return i.push(new r.v(t,u)),null}var c=new v(s);return n._cstAliases.push(c),c}var l=B(e,t);if(l)return q(e,t,l);if(t.type!==r.e.PLAIN){var f="Failed to resolve ".concat(t.type," node here");return i.push(new r.f(t,f)),null}try{return E(C(e,t),a.tags,a.tags.scalarFallback)}catch(e){return e.source||(e.source=t),i.push(e),null}}(e,t);if(l){l.range=[t.range.start,t.range.end],e.options.keepCstNodes&&(l.cstNode=t),e.options.keepNodeTypes&&(l.type=t.type);var f=i.before.join("\n");f&&(l.commentBefore=l.commentBefore?"".concat(l.commentBefore,"\n").concat(f):f);var p=i.after.join("\n");p&&(l.comment=l.comment?"".concat(l.comment,"\n").concat(p):p)}return t.resolved=l}function F(e,t){if(t.type!==r.e.MAP&&t.type!==r.e.FLOW_MAP){var n="A ".concat(t.type," node cannot be resolved as a mapping");return e.errors.push(new r.f(t,n)),null}var i=t.type===r.e.FLOW_MAP?function(e,t){for(var n=[],i=[],a=void 0,o=!1,s="{",u=0;u<t.items.length;++u){var c=t.items[u];if("string"==typeof c.char){var l=c.char,f=c.offset;if("?"===l&&void 0===a&&!o){o=!0,s=":";continue}if(":"===l){if(void 0===a&&(a=null),":"===s){s=",";continue}}else if(o&&(void 0===a&&","!==l&&(a=null),o=!1),void 0!==a&&(i.push(new h(a)),a=void 0,","===l)){s=":";continue}if("}"===l){if(u===t.items.length-1)continue}else if(l===s){s=":";continue}var p="Flow map contains an unexpected ".concat(l),d=new r.f(t,p);d.offset=f,e.errors.push(d)}else c.type===r.e.BLANK_LINE?n.push({afterKey:!!a,before:i.length}):c.type===r.e.COMMENT?(I(e.errors,c),n.push({afterKey:!!a,before:i.length,comment:c.comment})):void 0===a?(","===s&&e.errors.push(new r.n(c,"Separator , missing in flow map")),a=K(e,c)):(","!==s&&e.errors.push(new r.n(c,"Indicator : missing in flow map entry")),i.push(new h(a,K(e,c))),a=void 0,o=!1)}R(e.errors,t),void 0!==a&&i.push(new h(a));return{comments:n,items:i}}(e,t):function(e,t){for(var n=[],i=[],a=void 0,o=null,s=0;s<t.items.length;++s){var u=t.items[s];switch(u.type){case r.e.BLANK_LINE:n.push({afterKey:!!a,before:i.length});break;case r.e.COMMENT:n.push({afterKey:!!a,before:i.length,comment:u.comment});break;case r.e.MAP_KEY:void 0!==a&&i.push(new h(a)),u.error&&e.errors.push(u.error),a=K(e,u.node),o=null;break;case r.e.MAP_VALUE:if(void 0===a&&(a=null),u.error&&e.errors.push(u.error),!u.context.atLineStart&&u.node&&u.node.type===r.e.MAP&&!u.node.context.atLineStart){e.errors.push(new r.n(u.node,"Nested mappings are not allowed in compact mappings"))}var c=u.node;if(!c&&u.props.length>0){(c=new r.c(r.e.PLAIN,[])).context={parent:u,src:u.context.src};var l=u.range.start+1;if(c.range={start:l,end:l},c.valueRange={start:l,end:l},"number"==typeof u.range.origStart){var f=u.range.origStart+1;c.range.origStart=c.range.origEnd=f,c.valueRange.origStart=c.valueRange.origEnd=f}}var p=new h(a,K(e,c));Y(u,p),i.push(p),a&&"number"==typeof o&&u.range.start>o+1024&&e.errors.push(M(t,a)),a=void 0,o=null;break;default:void 0!==a&&i.push(new h(a)),a=K(e,u),o=u.range.start,u.error&&e.errors.push(u.error);e:for(var d=s+1;;++d){var v=t.items[d];switch(v&&v.type){case r.e.BLANK_LINE:case r.e.COMMENT:continue e;case r.e.MAP_VALUE:break e;default:e.errors.push(new r.n(u,"Implicit map keys need to be followed by map values"));break e}}if(u.valueRangeContainsNewline){e.errors.push(new r.n(u,"Implicit map keys need to be on a single line"))}}}void 0!==a&&i.push(new h(a));return{comments:n,items:i}}(e,t),a=i.comments,o=i.items,s=new b;s.items=o,_(s,a);for(var u=!1,c=0;c<o.length;++c){var f=o[c].key;if(f instanceof l&&(u=!0),e.schema.merge&&f&&"<<"===f.value){o[c]=new g(o[c]);var p=o[c].value.items,d=null;p.some((function(e){if(e instanceof v){var t=e.source.type;return t!==r.e.MAP&&t!==r.e.FLOW_MAP&&(d="Merge nodes aliases can only point to maps")}return d="Merge nodes can only have Alias nodes as values"})),d&&e.errors.push(new r.n(t,d))}else for(var m=c+1;m<o.length;++m){var y=o[m].key;if(f===y||f&&y&&Object.prototype.hasOwnProperty.call(f,"value")&&f.value===y.value){var O='Map keys must be unique; "'.concat(f,'" is repeated');e.errors.push(new r.n(t,O));break}}}if(u&&!e.options.mapAsMap){e.warnings.push(new r.m(t,"Keys with collection values will be stringified as YAML due to JS Object restrictions. Use mapAsMap: true to avoid this."))}return t.resolved=s,s}function Y(e,t){if(function(e){var t=e.context,n=t.lineStart,i=t.node,a=t.src,o=e.props;if(0===o.length)return!1;var s=o[0].start;if(i&&s>i.valueRange.start)return!1;if(a[s]!==r.a.COMMENT)return!1;for(var u=n;u<s;++u)if("\n"===a[u])return!1;return!0}(e)){var n=e.getPropValue(0,r.a.COMMENT,!0),i=!1,a=t.value.commentBefore;if(a&&a.startsWith(n))t.value.commentBefore=a.substr(n.length+1),i=!0;else{var o=t.value.comment;!e.node&&o&&o.startsWith(n)&&(t.value.comment=o.substr(n.length+1),i=!0)}i&&(t.comment=n)}}function W(e,t){if(t.type!==r.e.SEQ&&t.type!==r.e.FLOW_SEQ){var n="A ".concat(t.type," node cannot be resolved as a sequence");return e.errors.push(new r.f(t,n)),null}var i=t.type===r.e.FLOW_SEQ?function(e,t){for(var n=[],i=[],a=!1,o=void 0,s=null,u="[",c=null,l=0;l<t.items.length;++l){var f=t.items[l];if("string"==typeof f.char){var p=f.char,d=f.offset;if(":"===p||!a&&void 0===o||(a&&void 0===o&&(o=u?i.pop():null),i.push(new h(o)),a=!1,o=void 0,s=null),p===u)u=null;else if(u||"?"!==p){if("["!==u&&":"===p&&void 0===o){if(","===u){if((o=i.pop())instanceof h){var v=new r.n(t,"Chaining flow sequence pairs is invalid");v.offset=d,e.errors.push(v)}if(!a&&"number"==typeof s){var m=f.range?f.range.start:f.offset;m>s+1024&&e.errors.push(M(t,o));for(var b=c.context.src,g=s;g<m;++g)if("\n"===b[g]){e.errors.push(new r.n(c,"Implicit keys of flow sequence pairs need to be on a single line"));break}}}else o=null;s=null,a=!1,u=null}else if("["===u||"]"!==p||l<t.items.length-1){var y="Flow sequence contains an unexpected ".concat(p),O=new r.f(t,y);O.offset=d,e.errors.push(O)}}else a=!0}else if(f.type===r.e.BLANK_LINE)n.push({before:i.length});else if(f.type===r.e.COMMENT)I(e.errors,f),n.push({comment:f.comment,before:i.length});else{if(u){var w="Expected a ".concat(u," in flow sequence");e.errors.push(new r.n(f,w))}var j=K(e,f);void 0===o?(i.push(j),c=f):(i.push(new h(o,j)),o=void 0),s=f.range.start,u=","}}R(e.errors,t),void 0!==o&&i.push(new h(o));return{comments:n,items:i}}(e,t):function(e,t){for(var n=[],i=[],a=0;a<t.items.length;++a){var o=t.items[a];switch(o.type){case r.e.BLANK_LINE:n.push({before:i.length});break;case r.e.COMMENT:n.push({comment:o.comment,before:i.length});break;case r.e.SEQ_ITEM:if(o.error&&e.errors.push(o.error),i.push(K(e,o.node)),o.hasProps){e.errors.push(new r.n(o,"Sequence items cannot have tags or anchors before the - indicator"))}break;default:o.error&&e.errors.push(o.error),e.errors.push(new r.f(o,"Unexpected ".concat(o.type," node in sequence")))}}return{comments:n,items:i}}(e,t),a=i.comments,o=i.items,s=new p;if(s.items=o,_(s,a),!e.options.mapAsMap&&o.some((function(e){return e instanceof h&&e.key instanceof l}))){e.warnings.push(new r.m(t,"Keys with collection values will be stringified as YAML due to JS Object restrictions. Use mapAsMap: true to avoid this."))}return t.resolved=s,s}},function(e,t,n){"use strict";n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return c})),n.d(t,"b",(function(){return l})),n.d(t,"h",(function(){return f})),n.d(t,"e",(function(){return p})),n.d(t,"i",(function(){return h})),n.d(t,"c",(function(){return d})),n.d(t,"a",(function(){return v})),n.d(t,"d",(function(){return m})),n.d(t,"k",(function(){return b})),n.d(t,"j",(function(){return y}));var r=n(3);function i(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e,t){var n=["depuis","depuis le","depuis la","à partir de","à partir du","du"],r=["jusqu'à","jusqu'au","jusqu'à la","avant","avant le","avant la","au"];if(!n.concat(r,["le","en"]).includes(e))throw new SyntaxError("Le mot clé '".concat(e,"' n'est pas valide. Les mots clés possible sont les suivants :\n\t ").concat(n.join(", ")));if("le"===e)return{start:t,end:t};if("en"===e)return{start:null,end:null};if(n.includes(e))return{start:t,end:null};if(r.includes(e))return{start:null,end:t};throw new Error("Non implémenté")}function c(e,t){return d((e,t)=>t&&e,t,l(!0,e))}function l(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{start:null,end:null},n=[o(o({},t),{},{value:e})];return null!=t.start&&n.unshift({start:null,end:Object(r.f)(t.start,-1),value:!1}),null!=t.end&&n.push({start:Object(r.f)(t.end,1),end:null,value:!1}),n}function f(e){return[{start:null,end:null,value:e}]}function p(e,t){return t.map(t=>{var{start:n,end:r,value:i}=t;return{start:n,end:r,value:e(i)}})}function h(e,t){return t.some(t=>{var{start:n,end:r,value:i}=t;return e(i)})}function d(e,t,n){return p(t=>{var[n,r]=t;return e(n,r)},b(t,n))}function v(e){return e.reduce((e,t)=>d((e,t)=>[...e,t],e,t),f([]))}function m(e){if(!("temporalValue"in e))return f(e);var t=e,{temporalValue:n}=t,r=i(t,["temporalValue"]);return p(e=>o(o({},r),{},{nodeValue:e}),n)}function b(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(!e.length&&!t.length)return n;var[i,...a]=e,[s,...u]=t;console.assert(i.start===s.start);var c=g(i.end,s.end);if(0===c)return b(a,u,[...n,o(o({},i),{},{value:[i.value,s.value]})]);if(c>0)return console.assert(null!==s.end),b([o(o({},i),{},{start:Object(r.f)(s.end,1)}),...a],u,[...n,o(o({},s),{},{value:[i.value,s.value]})]);if(c<0)return console.assert(null!==i.end),b(a,[o(o({},s),{},{start:Object(r.f)(i.end,1)}),...u],[...n,o(o({},i),{},{value:[i.value,s.value]})]);throw new EvalError("All case should have been covered")}function g(e,t){return e==t?0:null==e?1:null==t||Object(r.a)(e)<Object(r.a)(t)?-1:1}function y(e,t){if(!(e=e.filter(e=>{var{value:t}=e;return!1!==t})).length)return!1;if(1===e.length)return e[0].value;if(e.some(e=>{var{value:t}=e;return null==t}))return null;var n=e,i=n[0],a=n[n.length-1];if(null==i.start||null==a.end)return null!=i.start?a.value:null!=a.end?i.value:(i.value+a.value)/2;var o=0;return n.map(e=>{var{start:n,end:i,value:a}=e;[n,i]=[n,i];var s=0;return s=(null==t?void 0:t.denominators.includes("mois"))?Object(r.d)(n,i):(null==t?void 0:t.denominators.includes("année"))?Object(r.e)(n,i):Object(r.c)(n,i),o+=s,a*s}).reduce((e,t)=>e+t/o,0)}},function(e,t,n){"use strict";function r(e){var[t,n,r]=e.split("/");return r||([t,n,r]=["01",t,n]),a(+r,+n,+t)}n.d(t,"h",(function(){return r})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return c})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"e",(function(){return p}));var i=e=>+e<10?"0".concat(e):""+e;function a(e,t,n){var r=new Date(+e,+t-1,+n);if(!+r||r.getDate()!==+n)throw new SyntaxError("La date ".concat(n,"/").concat(t,"/").concat(e," n'est pas valide"));return"".concat(i(n),"/").concat(i(t),"/").concat(i(e))}function o(e){var[t,n,i]=r(e).split("/"),a=new Date(+i,+n-1,+t);return a.setMinutes(a.getMinutes()-a.getTimezoneOffset()),a}function s(e){return a(e.getFullYear(),e.getMonth()+1,e.getDate())}function u(e,t){var n=new Date(o(e));return n.setDate(n.getDate()+t),s(n)}function c(e){return+e.slice(-4)}function l(e,t){return 1+(o(e).getTime()-o(t).getTime())/864e5}function f(e,t){var[n,r,i]=e.split("/").map(e=>+e),[a,o,s]=t.split("/").map(e=>+e);return o-r+12*(s-i)-(n-1)/new Date(i,r,0).getDate()+a/new Date(s,o,0).getDate()}function p(e,t){return l(e,t)/365.25}},function(e,t,n){"use strict";(function(e,r){n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return m})),n.d(t,"e",(function(){return f})),n.d(t,"f",(function(){return c})),n.d(t,"g",(function(){return h})),n.d(t,"h",(function(){return g})),n.d(t,"i",(function(){return O}));var i=n(0),a=n(1),o={identify:function(e){return e instanceof Uint8Array},default:!1,tag:"tag:yaml.org,2002:binary",resolve:function(t,n){var r=Object(a.q)(t,n);if("function"==typeof e)return e.from(r,"base64");if("function"==typeof atob){for(var o=atob(r.replace(/[\n\r]/g,"")),s=new Uint8Array(o.length),u=0;u<o.length;++u)s[u]=o.charCodeAt(u);return s}return t.errors.push(new i.v(n,"This environment does not support reading binary tags; either Buffer or atob is required")),null},options:a.i,stringify:function(t,n,r,o){var s,u=t.comment,c=t.type,l=t.value;if("function"==typeof e)s=l instanceof e?l.toString("base64"):e.from(l.buffer).toString("base64");else{if("function"!=typeof btoa)throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");for(var f="",p=0;p<l.length;++p)f+=String.fromCharCode(l[p]);s=btoa(f)}if(c||(c=a.i.defaultType),c===i.e.QUOTE_DOUBLE)l=s;else{for(var h=a.i.lineWidth,d=Math.ceil(s.length/h),v=new Array(d),m=0,b=0;m<d;++m,b+=h)v[m]=s.substr(b,h);l=v.join(c===i.e.BLOCK_LITERAL?"\n":" ")}return Object(a.j)({comment:u,type:c,value:l},n,r,o)}};function s(e,t){for(var n=Object(a.o)(e,t),r=0;r<n.items.length;++r){var o=n.items[r];if(!(o instanceof a.e)){if(o instanceof a.k){if(o.items.length>1){throw new i.n(t,"Each pair must have its own sequence indicator")}var s=o.items[0]||new a.e;o.commentBefore&&(s.commentBefore=s.commentBefore?"".concat(o.commentBefore,"\n").concat(s.commentBefore):o.commentBefore),o.comment&&(s.comment=s.comment?"".concat(o.comment,"\n").concat(s.comment):o.comment),o=s}n.items[r]=o instanceof a.e?o:new a.e(o)}}return n}function u(e,t,n){var r=new a.g(e);r.tag="tag:yaml.org,2002:pairs";var o,s=Object(i.g)(t);try{for(s.s();!(o=s.n()).done;){var u=o.value,c=void 0,l=void 0;if(Array.isArray(u)){if(2!==u.length)throw new TypeError("Expected [key, value] tuple: ".concat(u));c=u[0],l=u[1]}else if(u&&u instanceof Object){var f=Object.keys(u);if(1!==f.length)throw new TypeError("Expected { key: value } tuple: ".concat(u));l=u[c=f[0]]}else c=u;var p=e.createPair(c,l,n);r.items.push(p)}}catch(e){s.e(e)}finally{s.f()}return r}var c={default:!1,tag:"tag:yaml.org,2002:pairs",resolve:s,createNode:u},l=function(e){Object(i.q)(n,e);var t=Object(i.r)(n);function n(){var e;return Object(i.j)(this,n),e=t.call(this),Object(i.l)(Object(i.w)(e),"add",a.k.prototype.add.bind(Object(i.w)(e))),Object(i.l)(Object(i.w)(e),"delete",a.k.prototype.delete.bind(Object(i.w)(e))),Object(i.l)(Object(i.w)(e),"get",a.k.prototype.get.bind(Object(i.w)(e))),Object(i.l)(Object(i.w)(e),"has",a.k.prototype.has.bind(Object(i.w)(e))),Object(i.l)(Object(i.w)(e),"set",a.k.prototype.set.bind(Object(i.w)(e))),e.tag=n.tag,e}return Object(i.i)(n,[{key:"toJSON",value:function(e,t){var n=new Map;t&&t.onCreate&&t.onCreate(n);var r,o=Object(i.g)(this.items);try{for(o.s();!(r=o.n()).done;){var s=r.value,u=void 0,c=void 0;if(s instanceof a.e?(u=Object(a.w)(s.key,"",t),c=Object(a.w)(s.value,u,t)):u=Object(a.w)(s,"",t),n.has(u))throw new Error("Ordered maps must not include duplicate keys");n.set(u,c)}}catch(e){o.e(e)}finally{o.f()}return n}}]),n}(a.g);Object(i.l)(l,"tag","tag:yaml.org,2002:omap");var f={identify:function(e){return e instanceof Map},nodeClass:l,default:!1,tag:"tag:yaml.org,2002:omap",resolve:function(e,t){var n,r=s(e,t),o=[],u=Object(i.g)(r.items);try{for(u.s();!(n=u.n()).done;){var c=n.value.key;if(c instanceof a.f){if(o.includes(c.value)){throw new i.n(t,"Ordered maps must not include duplicate keys")}o.push(c.value)}}}catch(e){u.e(e)}finally{u.f()}return Object.assign(new l,r)},createNode:function(e,t,n){var r=u(e,t,n),i=new l;return i.items=r.items,i}},p=function(e){Object(i.q)(n,e);var t=Object(i.r)(n);function n(){var e;return Object(i.j)(this,n),(e=t.call(this)).tag=n.tag,e}return Object(i.i)(n,[{key:"add",value:function(e){var t=e instanceof a.e?e:new a.e(e);Object(a.s)(this.items,t.key)||this.items.push(t)}},{key:"get",value:function(e,t){var n=Object(a.s)(this.items,e);return!t&&n instanceof a.e?n.key instanceof a.f?n.key.value:n.key:n}},{key:"set",value:function(e,t){if("boolean"!=typeof t)throw new Error("Expected boolean value for set(key, value) in a YAML set, not ".concat(Object(i.h)(t)));var n=Object(a.s)(this.items,e);n&&!t?this.items.splice(this.items.indexOf(n),1):!n&&t&&this.items.push(new a.e(e))}},{key:"toJSON",value:function(e,t){return Object(i.s)(Object(i.t)(n.prototype),"toJSON",this).call(this,e,t,Set)}},{key:"toString",value:function(e,t,r){if(!e)return JSON.stringify(this);if(this.hasAllNullValues())return Object(i.s)(Object(i.t)(n.prototype),"toString",this).call(this,e,t,r);throw new Error("Set items must all have null values")}}]),n}(a.k);Object(i.l)(p,"tag","tag:yaml.org,2002:set");var h={identify:function(e){return e instanceof Set},nodeClass:p,default:!1,tag:"tag:yaml.org,2002:set",resolve:function(e,t){var n=Object(a.n)(e,t);if(!n.hasAllNullValues())throw new i.n(t,"Set items must all have null values");return Object.assign(new p,n)},createNode:function(e,t,n){var r,a=new p,o=Object(i.g)(t);try{for(o.s();!(r=o.n()).done;){var s=r.value;a.items.push(e.createPair(s,null,n))}}catch(e){o.e(e)}finally{o.f()}return a}},d=function(e,t){var n=t.split(":").reduce((function(e,t){return 60*e+Number(t)}),0);return"-"===e?-n:n},v=function(e){var t=e.value;if(isNaN(t)||!isFinite(t))return Object(a.r)(t);var n="";t<0&&(n="-",t=Math.abs(t));var r=[t%60];return t<60?r.unshift(0):(t=Math.round((t-r[0])/60),r.unshift(t%60),t>=60&&(t=Math.round((t-r[0])/60),r.unshift(t))),n+r.map((function(e){return e<10?"0"+String(e):String(e)})).join(":").replace(/000000\d*$/,"")},m={identify:function(e){return"number"==typeof e},default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^([-+]?)([0-9][0-9_]*(?::[0-5]?[0-9])+)$/,resolve:function(e,t,n){return d(t,n.replace(/_/g,""))},stringify:v},b={identify:function(e){return"number"==typeof e},default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^([-+]?)([0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*)$/,resolve:function(e,t,n){return d(t,n.replace(/_/g,""))},stringify:v},g={identify:function(e){return e instanceof Date},default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^(?:([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?)$"),resolve:function(e,t,n,r,i,a,o,s,u){s&&(s=(s+"00").substr(1,3));var c=Date.UTC(t,n-1,r,i||0,a||0,o||0,s||0);if(u&&"Z"!==u){var l=d(u[0],u.slice(1));Math.abs(l)<30&&(l*=60),c-=6e4*l}return new Date(c)},stringify:function(e){return e.value.toISOString().replace(/((T00:00)?:00)?\.000Z$/,"")}};function y(e){var t=void 0!==r&&r.env||{};return e?"undefined"!=typeof YAML_SILENCE_DEPRECATION_WARNINGS?!YAML_SILENCE_DEPRECATION_WARNINGS:!t.YAML_SILENCE_DEPRECATION_WARNINGS:"undefined"!=typeof YAML_SILENCE_WARNINGS?!YAML_SILENCE_WARNINGS:!t.YAML_SILENCE_WARNINGS}function O(e,t){if(y(!1)){var n=void 0!==r&&r.emitWarning;n?n(e,t):console.warn(t?"".concat(t,": ").concat(e):e)}}var w={};function j(e,t){if(!w[e]&&y(!0)){w[e]=!0;var n="The option '".concat(e,"' will be removed in a future release");O(n+=t?", use '".concat(t,"' instead."):".","DeprecationWarning")}}}).call(this,n(12).Buffer,n(17))},function(e,t){},function(e,t,n){var r,i;r=this,i=function(){function e(t,n,r){return this.id=++e.highestId,this.name=t,this.symbols=n,this.postprocess=r,this}function t(e,t,n,r){this.rule=e,this.dot=t,this.reference=n,this.data=[],this.wantedBy=r,this.isComplete=this.dot===e.symbols.length}function n(e,t){this.grammar=e,this.index=t,this.states=[],this.wants={},this.scannable=[],this.completed={}}function r(e,t){this.rules=e,this.start=t||this.rules[0].name;var n=this.byName={};this.rules.forEach((function(e){n.hasOwnProperty(e.name)||(n[e.name]=[]),n[e.name].push(e)}))}function i(){this.reset("")}function a(e,t,a){if(e instanceof r){var o=e;a=t}else o=r.fromCompiled(e,t);for(var s in this.grammar=o,this.options={keepHistory:!1,lexer:o.lexer||new i},a||{})this.options[s]=a[s];this.lexer=this.options.lexer,this.lexerState=void 0;var u=new n(o,0);this.table=[u],u.wants[o.start]=[],u.predict(o.start),u.process(),this.current=0}function o(e){var t=typeof e;if("string"===t)return e;if("object"===t){if(e.literal)return JSON.stringify(e.literal);if(e instanceof RegExp)return e.toString();if(e.type)return"%"+e.type;if(e.test)return"<"+String(e.test)+">";throw new Error("Unknown symbol type: "+e)}}return e.highestId=0,e.prototype.toString=function(e){var t=void 0===e?this.symbols.map(o).join(" "):this.symbols.slice(0,e).map(o).join(" ")+" ● "+this.symbols.slice(e).map(o).join(" ");return this.name+" → "+t},t.prototype.toString=function(){return"{"+this.rule.toString(this.dot)+"}, from: "+(this.reference||0)},t.prototype.nextState=function(e){var n=new t(this.rule,this.dot+1,this.reference,this.wantedBy);return n.left=this,n.right=e,n.isComplete&&(n.data=n.build(),n.right=void 0),n},t.prototype.build=function(){var e=[],t=this;do{e.push(t.right.data),t=t.left}while(t.left);return e.reverse(),e},t.prototype.finish=function(){this.rule.postprocess&&(this.data=this.rule.postprocess(this.data,this.reference,a.fail))},n.prototype.process=function(e){for(var t=this.states,n=this.wants,r=this.completed,i=0;i<t.length;i++){var o=t[i];if(o.isComplete){if(o.finish(),o.data!==a.fail){for(var s=o.wantedBy,u=s.length;u--;){var c=s[u];this.complete(c,o)}if(o.reference===this.index){var l=o.rule.name;(this.completed[l]=this.completed[l]||[]).push(o)}}}else{if("string"!=typeof(l=o.rule.symbols[o.dot])){this.scannable.push(o);continue}if(n[l]){if(n[l].push(o),r.hasOwnProperty(l)){var f=r[l];for(u=0;u<f.length;u++){var p=f[u];this.complete(o,p)}}}else n[l]=[o],this.predict(l)}}},n.prototype.predict=function(e){for(var n=this.grammar.byName[e]||[],r=0;r<n.length;r++){var i=n[r],a=this.wants[e],o=new t(i,0,this.index,a);this.states.push(o)}},n.prototype.complete=function(e,t){var n=e.nextState(t);this.states.push(n)},r.fromCompiled=function(t,n){var i=t.Lexer;t.ParserStart&&(n=t.ParserStart,t=t.ParserRules);var a=new r(t=t.map((function(t){return new e(t.name,t.symbols,t.postprocess)})),n);return a.lexer=i,a},i.prototype.reset=function(e,t){this.buffer=e,this.index=0,this.line=t?t.line:1,this.lastLineBreak=t?-t.col:0},i.prototype.next=function(){if(this.index<this.buffer.length){var e=this.buffer[this.index++];return"\n"===e&&(this.line+=1,this.lastLineBreak=this.index),{value:e}}},i.prototype.save=function(){return{line:this.line,col:this.index-this.lastLineBreak}},i.prototype.formatError=function(e,t){var n=this.buffer;if("string"==typeof n){var r=n.split("\n").slice(Math.max(0,this.line-5),this.line),i=n.indexOf("\n",this.index);-1===i&&(i=n.length);var a=this.index-this.lastLineBreak,o=String(this.line).length;return t+=" at line "+this.line+" col "+a+":\n\n",t+=r.map((function(e,t){return s(this.line-r.length+t+1,o)+" "+e}),this).join("\n"),t+="\n"+s("",o+a)+"^\n"}return t+" at index "+(this.index-1);function s(e,t){var n=String(e);return Array(t-n.length+1).join(" ")+n}},a.fail={},a.prototype.feed=function(e){var t,r=this.lexer;for(r.reset(e,this.lexerState);;){try{if(!(t=r.next()))break}catch(e){var a=new n(this.grammar,this.current+1);throw this.table.push(a),(u=new Error(this.reportLexerError(e))).offset=this.current,u.token=e.token,u}var o=this.table[this.current];this.options.keepHistory||delete this.table[this.current-1];var s=this.current+1;a=new n(this.grammar,s),this.table.push(a);for(var u,c=void 0!==t.text?t.text:t.value,l=r.constructor===i?t.value:t,f=o.scannable,p=f.length;p--;){var h=f[p],d=h.rule.symbols[h.dot];if(d.test?d.test(l):d.type?d.type===t.type:d.literal===c){var v=h.nextState({data:l,token:t,isToken:!0,reference:s-1});a.states.push(v)}}if(a.process(),0===a.states.length)throw(u=new Error(this.reportError(t))).offset=this.current,u.token=t,u;this.options.keepHistory&&(o.lexerState=r.save()),this.current++}return o&&(this.lexerState=r.save()),this.results=this.finish(),this},a.prototype.reportLexerError=function(e){var t,n,r=e.token;return r?(t="input "+JSON.stringify(r.text[0])+" (lexer error)",n=this.lexer.formatError(r,"Syntax error")):(t="input (lexer error)",n=e.message),this.reportErrorCommon(n,t)},a.prototype.reportError=function(e){var t=(e.type?e.type+" token: ":"")+JSON.stringify(void 0!==e.value?e.value:e),n=this.lexer.formatError(e,"Syntax error");return this.reportErrorCommon(n,t)},a.prototype.reportErrorCommon=function(e,t){var n=[];n.push(e);var r=this.table.length-2,i=this.table[r],a=i.states.filter((function(e){var t=e.rule.symbols[e.dot];return t&&"string"!=typeof t}));return 0===a.length?(n.push("Unexpected "+t+". I did not expect any more input. Here is the state of my parse table:\n"),this.displayStateStack(i.states,n)):(n.push("Unexpected "+t+". Instead, I was expecting to see one of the following:\n"),a.map((function(e){return this.buildFirstStateStack(e,[])||[e]}),this).forEach((function(e){var t=e[0],r=t.rule.symbols[t.dot],i=this.getSymbolDisplay(r);n.push("A "+i+" based on:"),this.displayStateStack(e,n)}),this)),n.push(""),n.join("\n")},a.prototype.displayStateStack=function(e,t){for(var n,r=0,i=0;i<e.length;i++){var a=e[i],o=a.rule.toString(a.dot);o===n?r++:(r>0&&t.push("    ^ "+r+" more lines identical to this"),r=0,t.push("    "+o)),n=o}},a.prototype.getSymbolDisplay=function(e){return function(e){var t=typeof e;if("string"===t)return e;if("object"===t){if(e.literal)return JSON.stringify(e.literal);if(e instanceof RegExp)return"character matching "+e;if(e.type)return e.type+" token";if(e.test)return"token matching "+String(e.test);throw new Error("Unknown symbol type: "+e)}}(e)},a.prototype.buildFirstStateStack=function(e,t){if(-1!==t.indexOf(e))return null;if(0===e.wantedBy.length)return[e];var n=e.wantedBy[0],r=[e].concat(t),i=this.buildFirstStateStack(n,r);return null===i?null:[e].concat(i)},a.prototype.save=function(){var e=this.table[this.current];return e.lexerState=this.lexerState,e},a.prototype.restore=function(e){var t=e.index;this.current=t,this.table[t]=e,this.table.splice(t+1),this.lexerState=e.lexerState,this.results=this.finish()},a.prototype.rewind=function(e){if(!this.options.keepHistory)throw new Error("set option `keepHistory` to enable rewinding");this.restore(this.table[e])},a.prototype.finish=function(){var e=[],t=this.grammar.start;return this.table[this.table.length-1].states.forEach((function(n){n.rule.name===t&&n.dot===n.rule.symbols.length&&0===n.reference&&n.data!==a.fail&&e.push(n)})),e.map((function(e){return e.data}))},{Parser:a,Grammar:r,Rule:e}},e.exports?e.exports=i():r.nearley=i()},function(e,t){e.exports={"applicable si":{chainable:"oui",description:"Renvoie `non` si la condition est égale à `non`. Renvoie la valeur sinon.\nPermet de désactiver une règle ou une valeur. ",retourne:"Valeur | non",exemples:{base:"ancienneté: 4 mois prime de vacances:\n  applicable si: ancienneté >= 1 an\n  valeur: 200€"}},"non applicable si":{chainable:"oui",description:"Renvoit `non` si la condition n'est pas égale à `non`\nPermet de désactiver une règle ou une valeur. ",retourne:"Valeur | non",exemples:{base:"ancienneté: 4 mois prime de vacances:\n  non applicable si: ancienneté < 1 an\n  valeur: 200€"}},"une de ces conditions":{description:"Renvoie `oui` si l'une des règles listées est _applicable_.\n\nEquivaut à un `ou` logique.",retourne:"Booléen",exemples:{base:"âge: 17 ans mineur émancipé: oui peut voter:\n  une de ces conditions:\n    - âge >= 18 ans\n    - mineur émancipé"}},"toutes ces conditions":{description:"Renvoie `oui` si toutes toutes les règles listées sont _applicables_.\n\nEquivaut à un `et` logique.",argument:["*","..."],exemples:{base:"âge: 17 ans citoyenneté française: oui peut voter:\n  toutes ces conditions:\n    - citoyenneté française\n    - âge >= 18 ans"}},produit:{description:"C'est une multiplication adaptée pour exprimer au mieux les cotisations.\n\nSa propriété `assiette` est multipliée par un pourcentage `taux`, ou par un `facteur` quand ce nom est plus approprié.\n\nLa multiplication peut être plafonnée : ce plafond sépare l'assiette en deux, et la partie au-dessus du plafond est tout simplement ignorée. Dans ce cas, elle se comporte comme une barème en taux marginaux à deux tranches, la deuxième au taux nul et allant de `plafond` à l'infini.",argument:{assiette:"Valeur à multiplier",taux:"Taux à appliquer",facteur:"Facteur multiplicatif",plafond:"Plafond au dessus duquel le taux appliqué est nul"},exemples:{base:"cotisation:\n  produit:\n    assiette: 2000 €/mois\n    taux: 5%","assiette plafonnée":"plafond sécurité sociale: 3000 €/mois assiette cotisation: 15000 €/mois chômage:\n  produit:\n    assiette: assiette cotisation\n    plafond: 400% * plafond sécurité sociale\n    taux: 4%"}},variations:{description:"Contient une liste de conditions (`si`) et leurs conséquences associées (`alors`), ainsi qu'un cas par défaut (`sinon`).\n\nPour la première condition vraie dans la liste, on retient la valeur qui lui est associée.\n\nSi aucune condition n'est vraie, alors ce mécanisme renvoie implicitement `non`.\n\nCe mécanisme peut aussi être utilisé au sein d'un autre mécanisme avec des attributs,  tel que `produit` ou `barème`.",arguments:[{si:"condition à vérifier",alors:"consequence évaluée si la condition est vrai"},"...",{sinon:"consequence évaluée si aucune des conditions précédente n'était applicable"}],exemples:{base:"taux réduit: oui\ntaux allocation familiales:\n  variations:\n    - si: taux réduit\n      alors: 3.45%\n    - sinon: 5.25%","dans un produit":"assiette cotisation: 2300 €/mois\ntaux réduit: oui\nallocation familiales:\n  produit:\n    assiette: assiette cotisation\n    variations:\n      - si: taux réduit\n        alors:\n          taux: 3.45%\n      - sinon:\n          taux: 5.25%"}},somme:{description:"Somme de chaque terme de la liste.\n\nSi un des terme n'est pas applicable, il vaut zéro.\n\nOn peut retrancher des valeurs grâce à l'opérateur unaire `-`",arguments:["*","..."],exemples:{base:"exemple:\n  somme:\n    - 15.89 €\n    - 12% * 14 €\n    - (-20 €)","terme non applicable":"a: 50 € b:\n  applicable si: non\n  valeur: 20 €\n\nsomme:\n  somme:\n    - a\n    - b\n    - 40 €"}},"le maximum de":{description:"Renvoie la valeur numérique de la liste de propositions fournie qui est la plus grande.\n\nPour ajouter un plancher à une valeur, préférer l'utilisation du mécanisme `encadrement`.",exemples:{base:"max: \n  le maximum de:\n    - 50\n    - 100"}},"le minimum de":{description:"Renvoie la valeur numérique de la liste de propositions fournie qui est la plus petite.\n\nPour plafonner une valeur, préférer l'utilisation du mécanisme `encadrement`.",exemples:{base:"min: \n  le minimum de:\n    - 50\n    - 100"}},arrondi:{chainable:"oui",description:"Arrondi à l'entier le plus proche, ou à une précision donnée.",exemples:{base:"arrondi:\n  arrondi: oui\n  valeur: 12.45","nombre de décimales":"arrondi:\n  arrondi: 2 décimales\n  valeur: 2/3"}},recalcul:{description:"Relance le calcul d'une règle dans une situation différente de la situation courante. Permet par exemple de calculer le montant des cotisations au niveau du SMIC, même si le salaire est plus élevé dans la situation actuelle.",exemples:{base:"brut: 2000€\ncotisations:\n  produit:\n    assiette: brut\n    taux: 20%\n\ncotisations pour un SMIC:\n  recalcul:\n    règle: cotisations\n    avec:\n      brut: 1500 €"}},"barème":{description:"C'est un barème en taux marginaux, mécanisme de calcul connu de par son utilisation dans le calcul de l'impôt sur le revenu.\nL'assiette est décomposée en plusieurs tranches, qui sont multipliées par un taux spécifique et enfin additionnées pour donner le résultat.\nLes tranches sont souvent exprimées sous forme de facteurs d'une variable que l'on appelle `multiplicateur`, par exemple une fois le plafond de la sécurité sociale.",exemples:{"sans multiplicateur":"revenu imposable: 54126 € impôt sur le revenu:\n  barème:\n    assiette: revenu imposable\n    tranches:\n      - taux: 0%\n        plafond: 9807 €\n      - taux: 14%\n        plafond: 27086 €\n      - taux: 30%\n        plafond: 72617 €\n      - taux: 41%\n        plafond: 153783 €\n      - taux: 45%","avec multiplicateur":"retraite de base:\n  barème:\n    assiette: assiette retraite\n    multiplicateur: plafond sécurité sociale temps plein\n    tranches:\n      - taux: 17.75%\n        plafond: 1\n      - taux: 0.6%\n  arrondi: oui"}},grille:{description:"C'est un barème sous la forme d'une grille de correspondance simple. C'est le mécanisme de calcul de l'impôt neutre, aussi appelé impôt non personnalisé.\nIl est composé de tranches qui se suivent. Il suffit de trouver l'assiette qui correspond à la tranche, et de selectionner le montant associé à l'assiette.",exemples:{"grille avec multiplicateur et unité":"SMIC horaire: 10 €/heure revenu moyen: 1200€/an trimestres validés:\n  grille:\n    unité: trimestres validés/an\n    assiette: revenu moyen\n    multiplicateur: SMIC horaire\n    tranches:\n      - montant: 0\n        plafond: 150 heures/an\n      - montant: 1\n        plafond: 300 heures/an\n      - montant: 2\n        plafond: 450 heures/an\n      - montant: 3\n        plafond: 600 heures/an\n      - montant: 4"}},"taux progressif":{description:"Ce mécanisme permet de calculer un taux progressif. On spécifie pour chaque tranche le plafond et le taux associé. Le taux effectif renvoyé est calculé en lissant la différence de taux entre la borne inférieure et supérieure de l'assiette.\n\nPar exemple, si nous nous avons les tranches suivantes :\n\n- taux: 50% / plafond: 0\n- taux: 100% / plafond: 1000\n\nPour une assiette de 500, le taux retourné sera 75%, car il correspond au taux situé à la moitié de la tranche correspondante.",exemples:{base:"chiffre d'affaires: 30000 €/an plafond: 3000 €/mois taux réduction de cotisation:\n  taux progressif:\n    assiette: chiffre d'affaires\n    multiplicateur: plafond\n    tranches:\n      - taux: 100%\n        plafond: 75%\n      - taux: 0%\n        plafond: 100%"}},composantes:{description:"Beaucoup de cotisations sont composées de deux parties qui partagent la méthode de calcul mais diffèrent selons certains paramètres. Pour ne pas définir deux variables quasi-redondantes, on utilise ce mécanisme.\nCela permet d'avoir une écriture factorisée, plus facile à lire. \nDans les calculs, `composantes` se comporte **exactement comme une somme**. La documentation, elle, sera adaptée pour montrer chaque composantes.\nIl est possible par exemple pour le mécanisme `produit` de garder en commun l'assiette, et de déclarer des composantes pour le taux.\nChaque composante peut également contenir un champs `attributs` de type objet contenant les mécanismes chainés à appliquer à la composante en question\nLorsque l'on utilise l'attribut `nom`, cela abouti à la définition de règles  imbriquées pour chacun des terme de la somme.\n ",exemples:{base:"composante:\n  produit:\n    assiette: assiette de base\n    composantes:\n      - taux: 2%\n      - taux: 4%\n        plafond: plafond sécurité sociale",Cotisations:"cotisation 1:\n  produit:\n    assiette: assiette de base\n    composantes:\n      - attributs:\n          nom: employeur\n        taux: 5%\n      - attributs:\n          nom: salarié\n        taux: 1%\n\ncotisations salariales :\n  somme: \n    - cotisation 1 . salarié\n    # ...",TVA:"prix:\n  produit:\n    assiette: 50€\n    composantes:\n      - attributs:\n          nom: HT\n      - attributs:\n          nom: TVA\n        taux: 20%\n\nvérification:\n  prix = prix . HT + prix . TVA "}},abattement:{chainable:"oui",description:"Permet de réduire le montant d'une valeur.\nLe résultat vaudra toujours au moins zéro, y compris quand le montant de l'abattement est plus grand que le montant abattu.\nIl est possible d'utiliser le mécanisme `abattement` de deux manières :\n  - soit en indiquant un montant de la même unité que la valeur, qui lui sera alors soustrait\n  - soit en indiquant un pourcentage qui sera utilisé pour calculer l'abattement de manière relative",exemples:{"abattement simple":"revenu imposable:\n  valeur: 10000€\n  abattement: 2000€","abattement supérieur à la valeur":"revenu imposable:\n  valeur: 1000€\n  abattement: 2000€","abattement relatif":"revenu imposable:\n  valeur: 2000€\n  abattement: 10%"}},plancher:{chainable:"oui",description:"Permet d'ajouter un plancher à une valeur.",exemples:{base:"revenus: -500€ assiette des cotisations:\n  valeur: revenus\n  plancher: 0 €"}},plafond:{chainable:"oui",description:"Permet de plafonner une valeur.",exemples:{base:"salaire: 1300€/mois déduction fiscale:\n  valeur: salaire * 10%\n  plafond: 5000 €/an"}},"durée":{description:"Permet d'obtenir le nombre de jours entre deux dates",exemples:{base:"date d'embauche: 14/04/2008 ancienneté en fin d'année:\n  unité: an\n  durée:\n    depuis: date d'embauche\n    jusqu'à: 31/12/2020"}},"unité":{chainable:"oui",description:"Permet de convertir explicitement une unité.\n\nAffiche un avertissement si la conversion n'est pas possible à cause d'unités incompatibles.\n",exemples:{base:"salaire: \n  valeur: 35 k€/an\n  unité: €/mois"}},"par défaut":{chainable:"oui",description:"Permet de donner une valeur par défaut pour le calcul, sans influer sur les variables manquantes retournés.\n\nUtile dans le cas d'une situation incomplète où l'on veut quand même retourner une première estimation.\n",exemples:{base:"prix TTC: \n  assiette: prix HT * (100% + TVA)\nTVA: \n  par défaut: 20%"}},synchronisation:{description:"Permet de récupérer certaines informations, tels que les les codes postaux des villes, à partir d'APIs externes, telles que l'[API commune](https://geo.api.gouv.fr/decoupage-administratif/communes).\n\nAttention, ce mécanisme est encore en cours de développement, et sa syntaxe n'est pas stable. Se référer aux exemples existants."},"inversion numérique":{description:"Il est souhaitable de rédiger les règles de calcul en publicodes de la même façon qu'elles sont décrites dans la loi ou les interprétations administratives ou juridiques existantes. En conséquence, certaines variables n'auront donc pas de méthode de calcul clairement explicitée, il s'agira donc de la déduire des autres valeurs renseignées.\n\nDe façon simplifiée, il s'agira donc, à partir d'une règle existante explicitant `y = ƒ(x)` de calculer `x` à partir de `y`.\n\nL'inversion numérique permet d'estimer la valeur de la variable en question au plus près à partir d'un des _objectifs_, listés dans la propriété `avec`. Il faut alors renseigner une valeur cible pour ces objectifs.\n\nL'algorithme utilisé est la [méthode de Brent](https://fr.wikipedia.org/wiki/M%C3%A9thode_de_Brent). L'idée générale est de prendre une valeur au hasard pour la variable en question, et d'améliorer mathématiquement le choix jusqu'à ce que les valeurs cibles soient toutes suffisamment proches des objectifs\n\nSi on demande au moteur la valeur d'une variable qui a pour formule une inversion, il va vérifier qu'une des variables `avec` a bien une valeur (calculée ou saisie), et procéder à l'inversion décrite plus haut à partir de celle-ci. Sinon, ces possibilités d'inversions seront listées comme manquantes."}}},function(e,t,n){!function(){function t(e){return e[0]}var{string:r,date:i,variable:a,temporalNumericValue:o,binaryOperation:s,unaryOperation:u,boolean:c,number:l,numberWithUnit:f,JSONObject:p}=n(10),h=n(11),d="".concat("[a-zA-ZÀ-ſ€$%]","(?:[-']?").concat("[a-zA-ZÀ-ſ0-9'°]","+)*"),v="(?:".concat(d,"|").concat("[a-zA-ZÀ-ſ0-9'°]","+)"),m="".concat(d,"(?:[,\\s]?").concat(v,"+)*"),b="\\| ".concat(d,"(?:[\\s]").concat(d,")*"),g=h.compile({"(":"(",")":")","[":"[","]":"]",comparison:[">","<",">=","<=","=","!="],infinity:"Infinity",colon:" : ",date:new RegExp("(?:(?:0?[1-9]|[12][0-9]|3[01])\\/)?(?:0?[1-9]|1[012])\\/\\d{4}"),periodWord:new RegExp(b),words:new RegExp(m),number:new RegExp("-?(?:[1-9][0-9]+|[0-9])(?:\\.[0-9]+)?"),string:/'.*'/,JSONObject:/{.*}/,additionSubstraction:/[\+-]/,multiplicationDivision:["*","/"],dot:" . ",".":".",letterOrNumber:new RegExp("[a-zA-ZÀ-ſ0-9'°]"),space:{match:/[\s]+/,lineBreaks:!0}}),y=e=>({value:e.map(e=>e&&e.value).join("")}),O=e=>{var[t,n]=e;return Array.isArray(n)?y([t,...n]):t},w={Lexer:g,ParserRules:[{name:"main",symbols:["Comparison"],postprocess:t},{name:"main",symbols:["NumericValue"],postprocess:t},{name:"main",symbols:["Date"],postprocess:t},{name:"main",symbols:["NonNumericTerminal"],postprocess:t},{name:"main",symbols:["JSONObject"],postprocess:t},{name:"NumericValue",symbols:["AdditionSubstraction"],postprocess:t},{name:"NumericValue",symbols:["Negation"],postprocess:t},{name:"NumericValue",symbols:["TemporalNumericValue"],postprocess:t},{name:"TemporalNumericValue",symbols:["NumericValue",g.has("space")?{type:"space"}:space,g.has("periodWord")?{type:"periodWord"}:b,g.has("space")?{type:"space"}:space,g.has("date")?{type:"date"}:i],postprocess:e=>{var[t,,n,,r]=e;return o(t,n,i([r]))}},{name:"TemporalNumericValue",symbols:["NumericValue",g.has("space")?{type:"space"}:space,g.has("periodWord")?{type:"periodWord"}:b,g.has("colon")?{type:"colon"}:colon,"Date"],postprocess:e=>{var[t,,n,,r]=e;return o(t,n,r)}},{name:"NumericTerminal",symbols:["Variable"],postprocess:t},{name:"NumericTerminal",symbols:["number"],postprocess:t},{name:"Negation",symbols:[{literal:"-"},g.has("space")?{type:"space"}:space,"Parentheses"],postprocess:u("calculation")},{name:"Parentheses",symbols:[{literal:"("},"NumericValue",{literal:")"}],postprocess:e=>{var[,t]=e;return t}},{name:"Parentheses",symbols:["NumericTerminal"],postprocess:t},{name:"Date",symbols:["Variable"],postprocess:t},{name:"Date",symbols:[g.has("date")?{type:"date"}:i],postprocess:i},{name:"Comparison",symbols:["Comparable",g.has("space")?{type:"space"}:space,g.has("comparison")?{type:"comparison"}:comparison,g.has("space")?{type:"space"}:space,"Comparable"],postprocess:s("comparison")},{name:"Comparison",symbols:["Date",g.has("space")?{type:"space"}:space,g.has("comparison")?{type:"comparison"}:comparison,g.has("space")?{type:"space"}:space,"Date"],postprocess:s("comparison")},{name:"Comparable$subexpression$1",symbols:["AdditionSubstraction"]},{name:"Comparable$subexpression$1",symbols:["NonNumericTerminal"]},{name:"Comparable",symbols:["Comparable$subexpression$1"],postprocess:e=>{var[[t]]=e;return t}},{name:"NonNumericTerminal",symbols:["boolean"],postprocess:t},{name:"NonNumericTerminal",symbols:["string"],postprocess:t},{name:"Variable$ebnf$1",symbols:[]},{name:"Variable$ebnf$1$subexpression$1",symbols:[g.has("dot")?{type:"dot"}:dot,g.has("words")?{type:"words"}:m],postprocess:e=>{var[,t]=e;return t}},{name:"Variable$ebnf$1",symbols:["Variable$ebnf$1","Variable$ebnf$1$subexpression$1"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"Variable",symbols:[g.has("words")?{type:"words"}:m,"Variable$ebnf$1"],postprocess:a},{name:"UnitDenominator$ebnf$1$subexpression$1",symbols:[g.has("space")?{type:"space"}:space]},{name:"UnitDenominator$ebnf$1",symbols:["UnitDenominator$ebnf$1$subexpression$1"],postprocess:t},{name:"UnitDenominator$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"UnitDenominator",symbols:["UnitDenominator$ebnf$1",{literal:"/"},g.has("words")?{type:"words"}:m],postprocess:y},{name:"UnitNumerator$ebnf$1$subexpression$1",symbols:[{literal:"."},g.has("words")?{type:"words"}:m]},{name:"UnitNumerator$ebnf$1",symbols:["UnitNumerator$ebnf$1$subexpression$1"],postprocess:t},{name:"UnitNumerator$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"UnitNumerator",symbols:[g.has("words")?{type:"words"}:m,"UnitNumerator$ebnf$1"],postprocess:O},{name:"Unit$ebnf$1",symbols:["UnitNumerator"],postprocess:t},{name:"Unit$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"Unit$ebnf$2",symbols:[]},{name:"Unit$ebnf$2",symbols:["Unit$ebnf$2","UnitDenominator"],postprocess:function(e){return e[0].concat([e[1]])}},{name:"Unit",symbols:["Unit$ebnf$1","Unit$ebnf$2"],postprocess:O},{name:"AdditionSubstraction",symbols:["AdditionSubstraction",g.has("space")?{type:"space"}:space,g.has("additionSubstraction")?{type:"additionSubstraction"}:additionSubstraction,g.has("space")?{type:"space"}:space,"MultiplicationDivision"],postprocess:s("calculation")},{name:"AdditionSubstraction",symbols:["MultiplicationDivision"],postprocess:t},{name:"MultiplicationDivision",symbols:["MultiplicationDivision",g.has("space")?{type:"space"}:space,g.has("multiplicationDivision")?{type:"multiplicationDivision"}:multiplicationDivision,g.has("space")?{type:"space"}:space,"Parentheses"],postprocess:s("calculation")},{name:"MultiplicationDivision",symbols:["Parentheses"],postprocess:t},{name:"boolean",symbols:[{literal:"oui"}],postprocess:c(!0)},{name:"boolean",symbols:[{literal:"non"}],postprocess:c(!1)},{name:"number",symbols:[g.has("number")?{type:"number"}:l],postprocess:l},{name:"number",symbols:[g.has("infinity")?{type:"infinity"}:infinity],postprocess:l},{name:"number$ebnf$1$subexpression$1",symbols:[g.has("space")?{type:"space"}:space]},{name:"number$ebnf$1",symbols:["number$ebnf$1$subexpression$1"],postprocess:t},{name:"number$ebnf$1",symbols:[],postprocess:function(e){return null}},{name:"number",symbols:[g.has("number")?{type:"number"}:l,"number$ebnf$1","Unit"],postprocess:f},{name:"string",symbols:[g.has("string")?{type:"string"}:r],postprocess:r},{name:"JSONObject",symbols:[g.has("JSONObject")?{type:"JSONObject"}:p],postprocess:p}],ParserStart:"main"};void 0!==e.exports?e.exports=w:window.grammar=w}()},function(e,t,n){e.exports=n(19).YAML},function(e,t,n){"use strict";n.r(t),n.d(t,"binaryOperation",(function(){return u})),n.d(t,"unaryOperation",(function(){return c})),n.d(t,"temporalNumericValue",(function(){return l})),n.d(t,"variable",(function(){return f})),n.d(t,"JSONObject",(function(){return p})),n.d(t,"number",(function(){return h})),n.d(t,"numberWithUnit",(function(){return d})),n.d(t,"date",(function(){return v})),n.d(t,"boolean",(function(){return m})),n.d(t,"string",(function(){return b}));var r=n(3),i=n(2);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=e=>t=>{var[n,,r,,i]=t;return{[r]:{operationType:e,explanation:[n,i]}}},c=e=>t=>{var[n,,r]=t;return{[n]:{operationType:e,explanation:[h([{value:"0"}]),r]}}},l=(e,t,n)=>({temporalValue:{explanation:e,period:Object(i.g)(t.value.slice(2),n)}}),f=(e,t,n)=>{var[r,i]=e,a=[r,...i].map(e=>{var{value:t}=e;return t});return!i.length&&["oui","non"].includes(r)?n:{variable:a.join(" . ")}},p=e=>{var[{value:t}]=e;console.log(t)},h=e=>{var[{value:t}]=e;return{constant:{type:"number",nodeValue:parseFloat(t)}}},d=e=>o(o({},h(e)),{},{"unité":e[2].value}),v=e=>{var[{value:t}]=e;return{constant:{type:"date",nodeValue:Object(r.h)(t)}}},m=e=>()=>({constant:{type:"boolean",nodeValue:e}}),b=e=>{var[{value:t}]=e;return{constant:{type:"string",nodeValue:t.slice(1,-1)}}}},function(e,t,n){var r,i,a;i=[],void 0===(a="function"==typeof(r=function(){"use strict";var e=Object.prototype.hasOwnProperty,t=Object.prototype.toString,n="boolean"==typeof(new RegExp).sticky;function r(e){return e&&"[object RegExp]"===t.call(e)}function i(e){return e&&"object"==typeof e&&!r(e)&&!Array.isArray(e)}function a(e){return"("+e+")"}function o(e){return e.length?"(?:"+e.map((function(e){return"(?:"+e+")"})).join("|")+")":"(?!)"}function s(e){if("string"==typeof e)return"(?:"+e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")+")";if(r(e)){if(e.ignoreCase)throw new Error("RegExp /i flag not allowed");if(e.global)throw new Error("RegExp /g flag is implied");if(e.sticky)throw new Error("RegExp /y flag is implied");if(e.multiline)throw new Error("RegExp /m flag is implied");return e.source}throw new Error("Not a pattern: "+e)}function u(t,n){if(i(n)||(n={match:n}),n.include)throw new Error("Matching rules cannot also include states");var a={defaultType:t,lineBreaks:!!n.error||!!n.fallback,pop:!1,next:null,push:null,error:!1,fallback:!1,value:null,type:null,shouldThrow:!1};for(var o in n)e.call(n,o)&&(a[o]=n[o]);if("string"==typeof a.type&&t!==a.type)throw new Error("Type transform cannot be a string (type '"+a.type+"' for token '"+t+"')");var s=a.match;return a.match=Array.isArray(s)?s:s?[s]:[],a.match.sort((function(e,t){return r(e)&&r(t)?0:r(t)?-1:r(e)?1:t.length-e.length})),a}function c(e){return Array.isArray(e)?function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n];if(r.include)for(var i=[].concat(r.include),a=0;a<i.length;a++)t.push({include:i[a]});else{if(!r.type)throw new Error("Rule has no type: "+JSON.stringify(r));t.push(u(r.type,r))}}return t}(e):function(e){for(var t=Object.getOwnPropertyNames(e),n=[],r=0;r<t.length;r++){var a=t[r],o=e[a],s=[].concat(o);if("include"!==a){var c=[];s.forEach((function(e){i(e)?(c.length&&n.push(u(a,c)),n.push(u(a,e)),c=[]):c.push(e)})),c.length&&n.push(u(a,c))}else for(var l=0;l<s.length;l++)n.push({include:s[l]})}return n}(e)}var l=u("error",{lineBreaks:!0,shouldThrow:!0});function f(e,t){for(var i=null,u=Object.create(null),c=!0,f=null,p=[],h=[],d=0;d<e.length;d++)e[d].fallback&&(c=!1);for(d=0;d<e.length;d++){var v=e[d];if(v.include)throw new Error("Inheritance is not allowed in stateless lexers");if(v.error||v.fallback){if(i)throw!v.fallback==!i.fallback?new Error("Multiple "+(v.fallback?"fallback":"error")+" rules not allowed (for token '"+v.defaultType+"')"):new Error("fallback and error are mutually exclusive (for token '"+v.defaultType+"')");i=v}var m=v.match.slice();if(c)for(;m.length&&"string"==typeof m[0]&&1===m[0].length;)u[m.shift().charCodeAt(0)]=v;if(v.pop||v.push||v.next){if(!t)throw new Error("State-switching options are not allowed in stateless lexers (for token '"+v.defaultType+"')");if(v.fallback)throw new Error("State-switching options are not allowed on fallback tokens (for token '"+v.defaultType+"')")}if(0!==m.length){c=!1,p.push(v);for(var b=0;b<m.length;b++){var g=m[b];if(r(g))if(null===f)f=g.unicode;else if(f!==g.unicode&&!1===v.fallback)throw new Error("If one rule is /u then all must be")}var y=o(m.map(s)),O=new RegExp(y);if(O.test(""))throw new Error("RegExp matches empty string: "+O);if(new RegExp("|"+y).exec("").length-1>0)throw new Error("RegExp has capture groups: "+O+"\nUse (?: … ) instead");if(!v.lineBreaks&&O.test("\n"))throw new Error("Rule should declare lineBreaks: "+O);h.push(a(y))}}var w=i&&i.fallback,j=n&&!w?"ym":"gm",x=n||w?"":"|";return!0===f&&(j+="u"),{regexp:new RegExp(o(h)+x,j),groups:p,fast:u,error:i||l}}function p(e,t,n){var r=e&&(e.push||e.next);if(r&&!n[r])throw new Error("Missing state '"+r+"' (in token '"+e.defaultType+"' of state '"+t+"')");if(e&&e.pop&&1!=+e.pop)throw new Error("pop must be 1 (in token '"+e.defaultType+"' of state '"+t+"')")}var h=function(e,t){this.startState=t,this.states=e,this.buffer="",this.stack=[],this.reset()};h.prototype.reset=function(e,t){return this.buffer=e||"",this.index=0,this.line=t?t.line:1,this.col=t?t.col:1,this.queuedToken=t?t.queuedToken:null,this.queuedThrow=t?t.queuedThrow:null,this.setState(t?t.state:this.startState),this.stack=t&&t.stack?t.stack.slice():[],this},h.prototype.save=function(){return{line:this.line,col:this.col,state:this.state,stack:this.stack.slice(),queuedToken:this.queuedToken,queuedThrow:this.queuedThrow}},h.prototype.setState=function(e){if(e&&this.state!==e){this.state=e;var t=this.states[e];this.groups=t.groups,this.error=t.error,this.re=t.regexp,this.fast=t.fast}},h.prototype.popState=function(){this.setState(this.stack.pop())},h.prototype.pushState=function(e){this.stack.push(this.state),this.setState(e)};var d=n?function(e,t){return e.exec(t)}:function(e,t){var n=e.exec(t);return 0===n[0].length?null:n};function v(){return this.value}if(h.prototype._getGroup=function(e){for(var t=this.groups.length,n=0;n<t;n++)if(void 0!==e[n+1])return this.groups[n];throw new Error("Cannot find token type for matched text")},h.prototype.next=function(){var e=this.index;if(this.queuedGroup){var t=this._token(this.queuedGroup,this.queuedText,e);return this.queuedGroup=null,this.queuedText="",t}var n=this.buffer;if(e!==n.length){if(o=this.fast[n.charCodeAt(e)])return this._token(o,n.charAt(e),e);var r=this.re;r.lastIndex=e;var i=d(r,n),a=this.error;if(null==i)return this._token(a,n.slice(e,n.length),e);var o=this._getGroup(i),s=i[0];return a.fallback&&i.index!==e?(this.queuedGroup=o,this.queuedText=s,this._token(a,n.slice(e,i.index),e)):this._token(o,s,e)}},h.prototype._token=function(e,t,n){var r=0;if(e.lineBreaks){var i=/\n/g,a=1;if("\n"===t)r=1;else for(;i.exec(t);)r++,a=i.lastIndex}var o={type:"function"==typeof e.type&&e.type(t)||e.defaultType,value:"function"==typeof e.value?e.value(t):t,text:t,toString:v,offset:n,lineBreaks:r,line:this.line,col:this.col},s=t.length;if(this.index+=s,this.line+=r,0!==r?this.col=s-a+1:this.col+=s,e.shouldThrow)throw new Error(this.formatError(o,"invalid syntax"));return e.pop?this.popState():e.push?this.pushState(e.push):e.next&&this.setState(e.next),o},"undefined"!=typeof Symbol&&Symbol.iterator){var m=function(e){this.lexer=e};m.prototype.next=function(){var e=this.lexer.next();return{value:e,done:!e}},m.prototype[Symbol.iterator]=function(){return this},h.prototype[Symbol.iterator]=function(){return new m(this)}}return h.prototype.formatError=function(e,t){if(null==e){var n=this.buffer.slice(this.index);e={text:n,offset:this.index,lineBreaks:-1===n.indexOf("\n")?0:1,line:this.line,col:this.col}}var r=Math.max(0,e.offset-e.col+1),i=e.lineBreaks?e.text.indexOf("\n"):e.text.length,a=this.buffer.substring(r,e.offset+i);return t+=" at line "+e.line+" col "+e.col+":\n\n",t+="  "+a+"\n",t+="  "+Array(e.col).join(" ")+"^"},h.prototype.clone=function(){return new h(this.states,this.state)},h.prototype.has=function(e){return!0},{compile:function(e){var t=f(c(e));return new h({start:t},"start")},states:function(e,t){var n=e.$all?c(e.$all):[];delete e.$all;var r=Object.getOwnPropertyNames(e);t||(t=r[0]);for(var i=Object.create(null),a=0;a<r.length;a++){var o=r[a];i[o]=c(e[o]).concat(n)}for(a=0;a<r.length;a++){o=r[a];for(var s=i[o],u=Object.create(null),l=0;l<s.length;l++){var d=s[l];if(d.include){var v=[l,1];if(d.include!==o&&!u[d.include]){u[d.include]=!0;var m=i[d.include];if(!m)throw new Error("Cannot include nonexistent state '"+d.include+"' (in state '"+o+"')");for(var b=0;b<m.length;b++){var g=m[b];-1===s.indexOf(g)&&v.push(g)}}s.splice.apply(s,v),l--}}}var y=Object.create(null);for(a=0;a<r.length;a++)o=r[a],y[o]=f(i[o],!0);for(a=0;a<r.length;a++){var O=r[a],w=y[O],j=w.groups;for(l=0;l<j.length;l++)p(j[l],O,y);var x=Object.getOwnPropertyNames(w.fast);for(l=0;l<x.length;l++)p(w.fast[x[l]],O,y)}return new h(y,t)},error:Object.freeze({error:!0}),fallback:Object.freeze({fallback:!0}),keywords:function(e){for(var t=Object.create(null),n=Object.create(null),r=Object.getOwnPropertyNames(e),i=0;i<r.length;i++){var a=r[i],o=e[a];(Array.isArray(o)?o:[o]).forEach((function(e){if((n[e.length]=n[e.length]||[]).push(e),"string"!=typeof e)throw new Error("keyword must be string (in keyword '"+a+"')");t[e]=a}))}function s(e){return JSON.stringify(e)}var u="";for(var c in u+="switch (value.length) {\n",n){var l=n[c];u+="case "+c+":\n",u+="switch (value) {\n",l.forEach((function(e){var n=t[e];u+="case "+s(e)+": return "+s(n)+"\n"})),u+="}\n"}return u+="}\n",Function("value",u)}}})?r.apply(t,i):r)||(e.exports=a)},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var r=n(14),i=n(15),a=n(16);function o(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!(u.TYPED_ARRAY_SUPPORT||this instanceof u))return new u(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return f(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=p(e,t);return e}(e,t,n,r):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(t,n),i=(e=s(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|h(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(r=t.length)!=r?s(e,0):p(e,t);if("Buffer"===t.type&&a(t.data))return p(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function f(e,t){if(l(t),e=s(e,t<0?0:0|h(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function p(e,t){var n=t.length<0?0:0|h(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function h(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function d(e,t){if(u.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return q(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function v(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return P(this,t,n);case"ascii":return k(this,t,n);case"latin1":case"binary":return A(this,t,n);case"base64":return S(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return V(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function m(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:g(e,t,n,r,i);if("number"==typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):g(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function g(e,t,n,r,i){var a,o=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,s/=2,u/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){var l=-1;for(a=n;a<s;a++)if(c(e,a)===c(t,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===u)return l*o}else-1!==l&&(a-=a-l),l=-1}else for(n+u>s&&(n=s-u),a=n;a>=0;a--){for(var f=!0,p=0;p<u;p++)if(c(e,a+p)!==c(t,p)){f=!1;break}if(f)return a}return-1}function y(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var a=t.length;if(a%2!=0)throw new TypeError("Invalid hex string");r>a/2&&(r=a/2);for(var o=0;o<r;++o){var s=parseInt(t.substr(2*o,2),16);if(isNaN(s))return o;e[n+o]=s}return o}function O(e,t,n,r){return $(U(t,e.length-n),e,n,r)}function w(e,t,n,r){return $(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function j(e,t,n,r){return w(e,t,n,r)}function x(e,t,n,r){return $(q(t),e,n,r)}function E(e,t,n,r){return $(function(e,t){for(var n,r,i,a=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,a.push(i),a.push(r);return a}(t,e.length-n),e,n,r)}function S(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function P(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var a,o,s,u,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=n)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(a=e[i+1]))&&(u=(31&c)<<6|63&a)>127&&(l=u);break;case 3:a=e[i+1],o=e[i+2],128==(192&a)&&128==(192&o)&&(u=(15&c)<<12|(63&a)<<6|63&o)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:a=e[i+1],o=e[i+2],s=e[i+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(u=(15&c)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"==typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return f(null,e)},u.allocUnsafeSlow=function(e){return f(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,a=Math.min(n,r);i<a;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(!u.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i),i+=o.length}return r},u.byteLength=d,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?P(this,0,e):v.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var a=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0),s=Math.min(a,o),c=this.slice(r,i),l=e.slice(t,n),f=0;f<s;++f)if(c[f]!==l[f]){a=c[f],o=l[f];break}return a<o?-1:o<a?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var a=!1;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return O(this,e,t,n);case"ascii":return w(this,e,t,n);case"latin1":case"binary":return j(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,e,t,n);default:if(a)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),a=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function k(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function A(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function N(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",a=t;a<n;++a)i+=B(e[a]);return i}function V(e,t,n){for(var r=e.slice(t,n),i="",a=0;a<r.length;a+=2)i+=String.fromCharCode(r[a]+256*r[a+1]);return i}function D(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function T(e,t,n,r,i,a){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<a)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function L(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,a=Math.min(e.length-n,2);i<a;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function R(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,a=Math.min(e.length-n,4);i<a;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function I(e,t,n,r,i,a){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function M(e,t,n,r,a){return a||I(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function _(e,t,n,r,a){return a||I(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var a=0;a<i;++a)n[a]=this[a+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||D(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||D(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||D(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=this[e],i=1,a=0;++a<t&&(i*=256);)r+=this[e+a]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||D(e,t,this.length);for(var r=t,i=1,a=this[e+--r];r>0&&(i*=256);)a+=this[e+--r]*i;return a>=(i*=128)&&(a-=Math.pow(2,8*t)),a},u.prototype.readInt8=function(e,t){return t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||D(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||D(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||D(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||D(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||D(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||D(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||T(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,a=0;for(this[t]=255&e;++a<n&&(i*=256);)this[t+a]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||T(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,a=1;for(this[t+i]=255&e;--i>=0&&(a*=256);)this[t+i]=e/a&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):R(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);T(this,e,t,n,i-1,-i)}var a=0,o=1,s=0;for(this[t]=255&e;++a<n&&(o*=256);)e<0&&0===s&&0!==this[t+a-1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);T(this,e,t,n,i-1,-i)}var a=n-1,o=1,s=0;for(this[t+a]=255&e;--a>=0&&(o*=256);)e<0&&0===s&&0!==this[t+a+1]&&(s=1),this[t+a]=(e/o>>0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):L(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):L(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):R(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||T(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return M(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return M(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return _(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return _(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,a=r-n;if(this===e&&n<t&&t<r)for(i=a-1;i>=0;--i)e[i+t]=this[i+n];else if(a<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<a;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+a),t);return a},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var a;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(a=t;a<n;++a)this[a]=e;else{var o=u.isBuffer(e)?e:U(new u(e,r).toString()),s=o.length;for(a=0;a<n-t;++a)this[a+t]=o[a%s]}return this};var C=/[^+\/0-9A-Za-z-_]/g;function B(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,a=[],o=0;o<r;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&a.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&a.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&a.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&a.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;a.push(n)}else if(n<2048){if((t-=2)<0)break;a.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;a.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;a.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return a}function q(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(C,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function $(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(13))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),o=r[0],s=r[1],u=new a(function(e,t,n){return 3*(t+n)/4-n}(0,o,s)),l=0,f=s>0?o-4:o;for(n=0;n<f;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,a=[],o=0,s=n-i;o<s;o+=16383)a.push(l(e,o,o+16383>s?s:o+16383));1===i?(t=e[n-1],a.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],a.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return a.join("")};for(var r=[],i=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=o.length;s<u;++s)r[s]=o[s],i[o.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,a,o=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),o.push(r[(a=i)>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return o.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var a,o,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,p=n?-1:1,h=e[t+f];for(f+=p,a=h&(1<<-l)-1,h>>=-l,l+=s;l>0;a=256*a+e[t+f],f+=p,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=r;l>0;o=256*o+e[t+f],f+=p,l-=8);if(0===a)a=1-c;else{if(a===u)return o?NaN:1/0*(h?-1:1);o+=Math.pow(2,r),a-=c}return(h?-1:1)*o*Math.pow(2,a-r)},t.write=function(e,t,n,r,i,a){var o,s,u,c=8*a-i-1,l=(1<<c)-1,f=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:a-1,d=r?1:-1,v=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-o))<1&&(o--,u*=2),(t+=o+f>=1?p/u:p*Math.pow(2,1-f))*u>=2&&(o++,u/=2),o+f>=l?(s=0,o=l):o+f>=1?(s=(t*u-1)*Math.pow(2,i),o+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),o=0));i>=8;e[n+h]=255&s,h+=d,s/=256,i-=8);for(o=o<<i|s,c+=i;c>0;e[n+h]=255&o,h+=d,o/=256,c-=8);e[n+h-d]|=128*v}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){var n,r,i=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var u,c=[],l=!1,f=-1;function p(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&h())}function h(){if(!l){var e=s(p);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new d(e,t)),1!==c.length||l||s(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";n.r(t),n.d(t,"mecanismsDoc",(function(){return cr.a})),n.d(t,"reduceAST",(function(){return p})),n.d(t,"transformAST",(function(){return f})),n.d(t,"Evaluation",(function(){return _.Evaluation})),n.d(t,"Unit",(function(){return _.Unit})),n.d(t,"capitalise0",(function(){return _n})),n.d(t,"formatValue",(function(){return Bn})),n.d(t,"simplifyNodeUnit",(function(){return de})),n.d(t,"serializeEvaluation",(function(){return lr})),n.d(t,"parseUnit",(function(){return J})),n.d(t,"serializeUnit",(function(){return G})),n.d(t,"parsePublicodes",(function(){return ar})),n.d(t,"utils",(function(){return r})),n.d(t,"Rule",(function(){})),n.d(t,"RuleNode",(function(){})),n.d(t,"ASTNode",(function(){return _.ASTNode})),n.d(t,"EvaluatedNode",(function(){return _.EvaluatedNode})),n.d(t,"default",(function(){return vr})),n.d(t,"UNSAFE_isNotApplicable",(function(){return mr}));var r={};n.r(r),n.d(r,"nameLeaf",(function(){return Wt})),n.d(r,"encodeRuleName",(function(){return Jt})),n.d(r,"decodeRuleName",(function(){return Qt})),n.d(r,"ruleParents",(function(){return Gt})),n.d(r,"disambiguateRuleReference",(function(){return zt})),n.d(r,"ruleWithDedicatedDocumentationPage",(function(){return Ht}));class i extends Error{}function a(e,t,n){throw new i('\n[ Erreur syntaxique ]\n➡️  Dans la règle "'.concat(e,'"\n✖️  ').concat(t,"\n    ").concat(n?n.message:"","\n"))}function o(e,t,n,r){e.warn('\n[ Avertissement ]\n➡️  Dans la règle "'.concat(t,'"\n⚠️  ').concat(n,"\n").concat(r?"ℹ️  ".concat(r.message):"","\n"))}class s extends i{constructor(e){super("\nErreur interne du moteur.\n\nCette erreur est le signe d'un bug dans publicodes. Pour nous aider à le résoudre, vous pouvez copier ce texte dans un nouveau ticket : https://github.com/betagouv/mon-entreprise/issues/new.\n\npayload:\n\t".concat(JSON.stringify(e,null,2),"\n"))}}function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){return function t(n){var r=e(n,t);return!1===r?n:void 0===r?d(t,n):r}}function p(e,t,n){return function n(r,i){var a=e(r,i,n.bind(null,t));return void 0===a?function(e){var t=[];return d(e=>(t.push(e),e),e),t}(i).reduce(n,r):a}(t,n)}function h(e,t){return Object.fromEntries(Object.entries(t).map(t=>{var[n,r]=t;return[n,e(r)]}))}var d=(e,t)=>{switch(t.nodeKind){case"rule":return v(e,t);case"reference":case"constant":return b(e,t);case"applicable si":case"non applicable si":return g(e,t);case"arrondi":return P(e,t);case"barème":case"taux progressif":case"grille":return O(e,t);case"somme":case"une de ces conditions":case"une possibilité":case"toutes ces conditions":case"minimum":case"maximum":return w(e,t);case"durée":return x(e,t);case"inversion":return E(e,t);case"operation":return j(e,t);case"par défaut":return S(e,t);case"plancher":return k(e,t);case"plafond":return A(e,t);case"produit":return N(e,t);case"recalcul":return V(e,t);case"abattement":return D(e,t);case"nom dans la situation":return T(e,t);case"synchronisation":return L(e,t);case"unité":return R(e,t);case"variations":return I(e,t);case"variable temporelle":return M(e,t);case"replacementRule":return m(e,t);default:throw new s(t)}},v=(e,t)=>c(c({},t),{},{replacements:t.replacements.map(e),suggestions:Object.fromEntries(Object.entries(t.suggestions).map(t=>{var[n,r]=t;return[n,e(r)]})),explanation:{parent:t.explanation.parent&&e(t.explanation.parent),valeur:e(t.explanation.valeur)}}),m=(e,t)=>c(c({},t),{},{definitionRule:e(t.definitionRule),replacedReference:e(t.replacedReference),replacementNode:e(t.replacementNode),whiteListedNames:t.whiteListedNames.map(e),blackListedNames:t.blackListedNames.map(e)}),b=(e,t)=>t,g=(e,t)=>c(c({},t),{},{explanation:{condition:e(t.explanation.condition),valeur:e(t.explanation.valeur)}});function y(e,t){return t.map(t=>c(c(c(c({},t),t.plafond&&{plafond:e(t.plafond)}),"montant"in t&&{montant:e(t.montant)}),"taux"in t&&{taux:e(t.taux)}))}var O=(e,t)=>c(c({},t),{},{explanation:{assiette:e(t.explanation.assiette),multiplicateur:e(t.explanation.multiplicateur),tranches:y(e,t.explanation.tranches)}}),w=(e,t)=>c(c({},t),{},{explanation:t.explanation.map(e)}),j=(e,t)=>c(c({},t),{},{explanation:[e(t.explanation[0]),e(t.explanation[1])]}),x=(e,t)=>c(c({},t),{},{explanation:{depuis:e(t.explanation.depuis),"jusqu'à":e(t.explanation["jusqu'à"])}}),E=(e,t)=>c(c({},t),{},{explanation:c(c({},t.explanation),{},{inversionCandidates:t.explanation.inversionCandidates.map(e)})}),S=(e,t)=>c(c({},t),{},{explanation:{valeur:e(t.explanation.valeur),"parDéfaut":e(t.explanation.parDéfaut)}}),P=(e,t)=>c(c({},t),{},{explanation:{valeur:e(t.explanation.valeur),arrondi:e(t.explanation.arrondi)}}),k=(e,t)=>c(c({},t),{},{explanation:{valeur:e(t.explanation.valeur),plancher:e(t.explanation.plancher)}}),A=(e,t)=>c(c({},t),{},{explanation:{valeur:e(t.explanation.valeur),plafond:e(t.explanation.plafond)}}),N=(e,t)=>c(c({},t),{},{explanation:{assiette:e(t.explanation.assiette),taux:e(t.explanation.taux),facteur:e(t.explanation.facteur),plafond:e(t.explanation.plafond)}}),V=(e,t)=>c(c({},t),{},{explanation:{amendedSituation:t.explanation.amendedSituation.map(t=>{var[n,r]=t;return[e(n),e(r)]}),recalcul:e(t.explanation.recalcul)}}),D=(e,t)=>c(c({},t),{},{explanation:{assiette:e(t.explanation.assiette),abattement:e(t.explanation.abattement)}}),T=(e,t)=>c(c({},t),{},{explanation:c(c(c({},t.explanation),t.explanation.situationValeur&&{situationValeur:e(t.explanation.situationValeur)}),{},{valeur:e(t.explanation.valeur)})}),L=(e,t)=>c(c({},t),{},{explanation:c(c({},t.explanation),{},{data:e(t.explanation.data)})}),R=(e,t)=>c(c({},t),{},{explanation:e(t.explanation)}),I=(e,t)=>c(c({},t),{},{explanation:t.explanation.map(t=>{var{condition:n,consequence:r}=t;return{condition:e(n),consequence:e(r)}})}),M=(e,t)=>c(c({},t),{},{explanation:{period:{end:t.explanation.period.end&&e(t.explanation.period.end),start:t.explanation.period.start&&e(t.explanation.period.start)},value:e(t.explanation.value)}}),_=n(5),C={constant:e=>e};function B(e,t){var n;if(null!==(n=C)&&void 0!==n||(C={}),C[e])throw Error("Multiple evaluation functions registered for the nodeKind [4m".concat(e));C[e]=t}var U=n(6),q=n(8),$=n.n(q),K=n(2);function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){W(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function W(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e=>e,[n,...r]=e.split("/").map(e=>e.trim()),i={numerators:n.split(".").filter(Boolean).map(e=>t(e)),denominators:r.map(e=>t(e))};return i},Q=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>e;return e.sort().map(e=>n(e,t)).join(".")},G=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e=>e;if(null===e||"object"!=typeof e)return"string"==typeof e?n(e,t):e;var r=ee(e),{numerators:i=[],denominators:a=[]}=r,o=i.length>0,s=a.length>0,u=o||s?o&&!s?Q(i,t,n):!o&&s?"/".concat(Q(a,1,n)):"".concat(Q(i,2,n)," / ").concat(Q(a,1,n)):"";return u},z={numerators:[],denominators:[]},H=(e,t)=>{if("/"===e){if(2!==t.length)throw new Error("Infer units of a division with units.length !== 2)");return H("*",[t[0]||z,{numerators:(t[1]||z).denominators,denominators:(t[1]||z).numerators}])}var n=t.filter(Boolean);return n.length<=1?n[0]:"*"===e?ee({numerators:n.flatMap(e=>{var t;return null!==(t=null==e?void 0:e.numerators)&&void 0!==t?t:[]}),denominators:n.flatMap(e=>{var t;return null!==(t=null==e?void 0:e.denominators)&&void 0!==t?t:[]})}):"-"===e||"+"===e?t.find(e=>e):void 0},Z=(e,t)=>Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every((n,r)=>e[r]===t[r]):e===t,X=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z;return n=>{var r=n.findIndex(n=>t(n,e));return n.filter((e,t)=>t!==r)}},ee=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z;return[...e.numerators,...e.denominators].reduce((e,n)=>{var{numerators:r,denominators:i}=e;return r.find(e=>t(n,e))&&i.find(e=>t(n,e))?{numerators:X(n,t)(r),denominators:X(n,t)(i)}:{numerators:r,denominators:i}},e)},te={"mois/an":12,"jour/an":365,"jour/mois":365/12,"trimestre/an":4,"mois/trimestre":3,"jour/trimestre":91.25,"€/k€":1e3,"g/kg":1e3,"mg/g":1e3,"mg/kg":10**6};function ne(e,t){return te["".concat(t,"/").concat(e)]||te["".concat(e,"/").concat(t)]&&1/te["".concat(e,"/").concat(t)]}function re(e,t){var n=100**(t.filter(e=>"%"===e).length-e.filter(e=>"%"===e).length);return[n]=e.reduce((e,t)=>{var[n,r]=e,i=r.findIndex(e=>!!ne(t,e));return[n*(ne(t,r[i])||1),[...r.slice(0,i+1),...r.slice(i+1)]]},[n,t]),n}function ie(e,t,n){if(!le(e,t))throw new Error("Impossible de convertir l'unité '".concat(G(e),"' en '").concat(G(t),"'"));if(!n)return n;if(void 0===e)return n;var[r,i]=ue(e||z),[a,o]=ue(t||z);return se(n*i/o*re(r.numerators,a.numerators)*re(a.denominators,r.denominators))}var ae=function(e){return Object.keys(e).reduce((e,t)=>{var[n,r]=t.split("/"),i=e.findIndex(e=>e.has(n)),a=e.findIndex(e=>e.has(r));if(i>-1&&a>-1&&i!==a)throw Error("Invalid ratio ".concat(t));return-1===i&&-1===a?e.push(new Set([n,r])):i>-1?e[i].add(r):a>-1&&e[a].add(n),e},[])}(te);function oe(e,t){return e===t||ae.some(n=>n.has(e)&&n.has(t))}function se(e){return+e.toFixed(16)}function ue(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=re(e.numerators,e.denominators);return[ee(ce(e),oe),t?se(t*n):t]}var ce=e=>({numerators:e.numerators.filter(e=>"%"!==e),denominators:e.denominators.filter(e=>"%"!==e)});function le(e,t){if(null==e||null==t)return!0;var n,[r,i,a,o]=[e.numerators,e.denominators,t.numerators,t.denominators].map(e=>e.reduce((e,t)=>{var n,r=ae.findIndex(e=>e.has(t)),i=-1===r?t:""+r;return Y(Y({},e),{},{[i]:1+(null!==(n=e[i])&&void 0!==n?n:0)})},{})),s=[r,i,a,o].map(Object.keys).flat();return(n=s,[...new Set(n)]).every(e=>(r[e]||0)-(i[e]||0)==(a[e]||0)-(o[e]||0)||"%"===e)}function fe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fe(Object(n),!0).forEach((function(t){he(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function he(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function de(e){return e.unit?ve(function(e){var{numerators:t,denominators:n}=ee(e,oe);return t.length&&t.every(e=>"%"===e)?{numerators:["%"],denominators:n}:ce({numerators:t,denominators:n})}(e.unit),e):e}function ve(e,t){var n=t.temporalValue&&t.unit?Object(K.e)(n=>ie(t.unit,e,n),t.temporalValue):t.temporalValue;return pe(pe(pe({},t),{},{nodeValue:t.unit&&"number"==typeof t.nodeValue?ie(t.unit,e,t.nodeValue):t.nodeValue},n&&{temporalValue:n}),{},{unit:e})}function me(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?me(Object(n),!0).forEach((function(t){ge(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):me(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ge(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ye=e=>"missingVariables"in e?e.missingVariables:{},Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.fromEntries(Object.entries(e).map(e=>{var[t,n]=e;return[t,n+1e-4]}))},we=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.fromEntries([...Object.keys(e),...Object.keys(t)].map(n=>{var r,i;return[n,(null!==(r=e[n])&&void 0!==r?r:0)+(null!==(i=t[n])&&void 0!==i?i:0)]}))},je=e=>e.map(ye).reduce(we,{});function xe(e,t){var n=e.find(e=>!!e.unit);return n?e.map(e=>{try{return ve(n.unit,e)}catch(t){return o(this.options.logger,this.cache._meta.ruleStack[0],"Les unités des éléments suivants sont incompatibles entre elles : \n\t\t".concat((null==e?void 0:e.name)||(null==e?void 0:e.rawNode),"\n\t\t").concat((null==n?void 0:n.name)||(null==n?void 0:n.rawNode),"'"),t),e}}):e}var Ee=(e,t)=>function(n){var r=this.evaluate.bind(this),i=xe.call(this,n.explanation.map(r),n.name),a=Object(K.a)(i.map(e=>{var{temporalValue:t,nodeValue:n}=e;return null!=t?t:Object(K.h)(n)})),o=Object(K.e)(n=>n.some(e=>null===e)?null:n.reduce(e,t),a),s=be(be({},n),{},{missingVariables:je(i),explanation:i},i[0]&&{unit:i[0].unit});return 1===o.length?be(be({},s),{},{nodeValue:o[0].value}):be(be({},s),{},{temporalValue:o,nodeValue:Object(K.j)(o)})},Se=e=>({nodeValue:e,type:typeof e,isDefault:!0,nodeKind:"constant"}),Pe=(e,t,n)=>Object.fromEntries(Object.entries(e).map(e=>{var[r,i]=e;if(null==t[r]&&!i)throw new Error("Il manque une clé '".concat(r,"' dans ").concat(JSON.stringify(t)," "));return[r,null!=t[r]?Qn(t[r],n):i]}));function ke(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ke(Object(n),!0).forEach((function(t){Ne(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ke(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ve(e,t){return{explanation:{assiette:Qn(e.valeur,t),abattement:Qn(e.abattement,t)},nodeKind:Ve.nom}}function De(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Te(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?De(Object(n),!0).forEach((function(t){Le(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):De(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Le(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Ve.nom="abattement",B(Ve.nom,(function(e){var t=this.evaluate(e.explanation.assiette),n=this.evaluate(e.explanation.abattement),r="%"===G(n.unit);if(t.unit&&!r)try{n=ve(t.unit,n)}catch(e){o(this.options.logger,this.cache._meta.ruleStack[0],"Impossible de convertir les unités de l'allègement entre elles",e)}var i=t.nodeValue,a=n.nodeValue,s=n?null==i?null:null==a?0==i?0:null:"%"===G(n.unit)?Math.max(0,i-a/100*i):Math.max(0,i-a):i;return Ae(Ae({},e),{},{nodeValue:s,unit:t.unit,missingVariables:je([t,n]),explanation:{assiette:t,abattement:n}})}));function Re(e,t){return{explanation:{valeur:Qn(e.valeur,t),condition:Qn(e[Re.nom],t)},nodeKind:Re.nom}}function Ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Me(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ie(Object(n),!0).forEach((function(t){_e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ce(e,t){return+e.toFixed(t)}Re.nom="applicable si",B(Re.nom,(function(e){var t=Te({},e.explanation),n=this.evaluate(t.condition),r=t.valeur;return!1!==n.nodeValue&&(r=this.evaluate(r)),Te(Te({},e),{},{nodeValue:null==n.nodeValue||!1===n.nodeValue?n.nodeValue:"nodeValue"in r?r.nodeValue:null,explanation:{valeur:r,condition:n},missingVariables:we("missingVariables"in r?r.missingVariables:{},Oe(n.missingVariables))},"unit"in r&&{unit:r.unit})}));function Be(e,t){return{explanation:{valeur:Qn(e.valeur,t),arrondi:Qn(e.arrondi,t)},nodeKind:Be.nom}}function Ue(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ue(Object(n),!0).forEach((function(t){$e(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $e(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Be.nom="arrondi",B(Be.nom,(function(e){var t=de(this.evaluate(e.explanation.valeur)),n=t.nodeValue,r=e.explanation.arrondi;return!1!==n&&(r=this.evaluate(r)),Me(Me({},e),{},{nodeValue:"number"==typeof t.nodeValue&&"nodeValue"in r?"number"==typeof r.nodeValue?Ce(t.nodeValue,r.nodeValue):!0===r.nodeValue?Ce(t.nodeValue,0):null===r.nodeValue?null:t.nodeValue:t.nodeValue,explanation:{valeur:t,arrondi:r},missingVariables:je([t,r]),unit:t.unit})}));var Ke=(e,t)=>e.map((t,n)=>{var r;if(!t.plafond&&n>e.length)throw new SyntaxError("La tranche n°".concat(n," du barème n'a pas de plafond précisé. Seule la dernière tranche peut ne pas être plafonnée"));return qe(qe({},t),{},{plafond:null!==(r=t.plafond)&&void 0!==r?r:1/0})}).map(e=>qe(qe(qe(qe({},e),void 0!==e.taux?{taux:Qn(e.taux,t)}:{}),void 0!==e.montant?{montant:Qn(e.montant,t)}:{}),{},{plafond:Qn(e.plafond,t)}));function Fe(e){var{multiplicateur:t,assiette:n,parsedTranches:r}=e;return r.reduce((e,r,i)=>{var[a,s]=e;if(s)return[[...a,qe(qe({},r),{},{isAfterActive:!0})],s];var u=this.evaluate(r.plafond),c=a[i-1]?a[i-1].plafond:{nodeValue:0},l=null===u.nodeValue||null===t.nodeValue?null:u.nodeValue*t.nodeValue;try{l=l===1/0||0===l?l:ie(H("*",[u.unit,t.unit]),n.unit,l)}catch(e){o(this.options.logger,this.cache._meta.ruleStack[0],"L'unité du plafond de la tranche n°".concat(i+1,"  n'est pas compatible avec celle l'assiette"),e)}var f,p,h,d,v=a[i-1]?a[i-1].plafondValue:0,m=null===v||null===n.nodeValue?null:v>n.nodeValue,b=[u,n,t,c];if(b.some(e=>null===e.nodeValue))return[[...a,qe(qe({},r),{},{plafond:u,plafondValue:l,plancherValue:v,nodeValue:null,isActive:null,isAfterActive:m,missingVariables:je(b)})],!1];a[i-1]&&v&&l<=v&&(f=this.options.logger,p=this.cache._meta.ruleStack[0],h="Le plafond de la tranche n°".concat(i+1," a une valeur inférieure à celui de la tranche précédente"),f.error("\n[ Erreur d'évaluation ]\n➡️  Dans la règle \"".concat(p,'"\n✖️  ').concat(h,"\n    ").concat(d?d.message:"","\n")));var g=qe(qe({},r),{},{plafond:u,plancherValue:v,plafondValue:l,isAfterActive:m,isActive:n.nodeValue>=v&&n.nodeValue<l});return[[...a,g],g.isActive]},[[],!1])[0]}function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function We(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){Je(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Je(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ge(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){ze(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ze(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function He(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}B("barème",(function(e){var t=this.evaluate.bind(this),n=this.evaluate(e.explanation.assiette),r=this.evaluate(e.explanation.multiplicateur),i=Object(K.c)((t,n)=>Fe.call(this,{parsedTranches:e.explanation.tranches,assiette:t,multiplicateur:n}),Object(K.d)(n),Object(K.d)(r)),a=Object(K.c)((e,n)=>function(e,t,n,r){return e.map(e=>{if(e.isAfterActive)return We(We({},e),{},{nodeValue:0});var r=n(e.taux);return[t.nodeValue,r.nodeValue,e.plafondValue,e.plancherValue].some(e=>null===e)?We(We({},e),{},{taux:r,nodeValue:null,missingVariables:je([r,e])}):We(We(We({},e),{},{taux:r},"unit"in t&&{unit:t.unit}),{},{nodeValue:(Math.min(t.nodeValue,e.plafondValue)-e.plancherValue)*ie(r.unit,J(""),r.nodeValue),missingVariables:je([r,e])})})}(e,n,t,this.cache),i,Object(K.d)(n)),o=Object(K.e)(e=>e.reduce((e,t)=>{var{nodeValue:n}=t;return null==n?null:e+n},0),a);return We(We(We({},e),{},{nodeValue:Object(K.j)(o)},o.length>1?{temporalValue:o}:{missingVariables:je(a[0].value)}),{},{explanation:We({assiette:n,multiplicateur:r},a.length>1?{temporalTranches:a}:{tranches:a[0].value}),unit:n.unit})}));function Ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ze(Object(n),!0).forEach((function(t){et(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function et(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){rt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B("toutes ces conditions",(function(e){var[t,n]=e.explanation.reduce((e,t)=>{var[n,r]=e;if(!1===n)return[n,[...r,t]];var i=this.evaluate(t);return[null===n||null===i.nodeValue?null:!!i.nodeValue,[...r,i]]},[!0,[]]);return Xe(Xe({},e),{},{nodeValue:t,explanation:n,missingVariables:je(n)})}));B("une de ces conditions",(function(e){var t=e.explanation.reduce((e,t)=>{if(!0===e.nodeValue)return nt(nt({},e),{},{explanation:[...e.explanation,t]});if(null===e.nodeValue||!1===e.nodeValue){var n=this.evaluate(t);return{nodeValue:!!n.nodeValue||(null===n.nodeValue?null:e.nodeValue),missingVariables:n.nodeValue?{}:we(e.missingVariables,n.missingVariables),explanation:[...e.explanation,n]}}throw new s([t,e])},{nodeValue:!1,missingVariables:{},explanation:[]});return nt(nt({},e),t)}));var it=n(3);function at(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ot(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?at(Object(n),!0).forEach((function(t){st(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):at(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function st(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ut=Object(it.b)(new Date),ct={depuis:Se(ut),"jusqu'à":Se(ut)};function lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?lt(Object(n),!0).forEach((function(t){pt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function pt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B("durée",(function(e){var t,n=this.evaluate(e.explanation.depuis),r=this.evaluate(e.explanation["jusqu'à"]);if([n,r].some(e=>{var{nodeValue:t}=e;return null===t}))t=null;else{var[i,a]=[n.nodeValue,r.nodeValue].map(it.a);t=Math.max(0,Math.round((a.getTime()-i.getTime())/864e5))}var o=je([n,r]);return ot(ot({},e),{},{missingVariables:o,nodeValue:t,explanation:{depuis:n,"jusqu'à":r}})}));function ht(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ht(Object(n),!0).forEach((function(t){vt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B("grille",(function(e){var t,n,r=this.evaluate.bind(this),i=this.evaluate(e.explanation.assiette),a=this.evaluate(e.explanation.multiplicateur),o=Object(K.c)((t,n)=>Fe.call(this,{parsedTranches:e.explanation.tranches,assiette:t,multiplicateur:n}),Object(K.d)(i),Object(K.d)(a)),s=Object(K.e)(e=>((e,t)=>e.map(e=>{if(!1===e.isActive)return e;var n=t(e.montant);return ft(ft({},e),{},{montant:n,nodeValue:n.nodeValue,unit:n.unit,missingVariables:je([n,e])})}))(e,r),o),u=Object(K.e)(e=>{var t=e.find(e=>e.isActive);return t?[t]:!1===e[e.length-1].isAfterActive?[{nodeValue:!1}]:e.filter(e=>null===e.isActive)},s),c=Object(K.e)(e=>null===e[0].isActive?null:e[0].nodeValue,u);return ft(ft(ft({},e),{},{nodeValue:Object(K.j)(c)},c.length>1?{temporalValue:c}:{missingVariables:je(u[0].value)}),{},{explanation:ft(ft({},e.explanation),{},{assiette:i,multiplicateur:a},s.length>1?{temporalTranches:s}:{tranches:s[0].value}),unit:null!==(t=null===(n=u[0].value[0])||void 0===n?void 0:n.unit)&&void 0!==t?t:void 0})}));B("inversion",(function(e){var t=e.explanation.inversionCandidates.find(e=>null!=this.parsedSituation[e.dottedName]);if(void 0===t){var n=dt(dt({},Object.fromEntries(e.explanation.inversionCandidates.map(e=>[e.dottedName,1]))),{},{[e.explanation.ruleToInverse]:1});return dt(dt({},e),{},{missingVariables:n,nodeValue:null})}var r=this.evaluate(t),i="unit"in e?e.unit:r.unit,a=this.cache,o=dt({},this.parsedSituation),s=0;delete this.parsedSituation[t.dottedName];var u=n=>(s++,this.resetCache(),this.cache._meta=dt({},a._meta),this.parsedSituation[e.explanation.ruleToInverse]={unit:i,nodeKind:"unité",explanation:{nodeKind:"constant",nodeValue:n,type:"number"}},ve(i,this.evaluate(t))),c=ve(i,r).nodeValue,l=null,f=c,p=u(f),h=p.nodeValue,d=null!==h?f*c*(h>c?.9:1.2)/h:2e3,v=u(d),m=v.nodeValue,b=we(p.missingVariables,v.missingVariables);if(null!==h||null!==m){l=function(e,t,n){for(var r,i,a,o,s,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,f=t,p=n,h=f,d=e(f),v=e(p),m=d,b=void 0;c-- >0;){if(a=p-f,Math.abs(m)<Math.abs(v)&&(f=p,p=h,h=f,d=v,v=m,m=d),r=1e-15*Math.abs(p)+u/2,i=(h-p)/2,Math.abs(i)<=r||0===v)return p;if(Math.abs(a)>=r&&Math.abs(d)>Math.abs(v)){var g=void 0,y=void 0,O=h-p;f===h?(o=O*(g=v/d),s=1-g):(o=(y=v/d)*(O*(s=d/m)*(s-(g=v/m))-(p-f)*(g-1)),s=(s-1)*(g-1)*(y-1)),o>0?s=-s:o=-o,o<.75*O*s-Math.abs(r*s)/2&&o<Math.abs(a*s/2)&&(i=o/s)}Math.abs(i)<r&&(i=i>0?r:-r),f=p,d=v,((v=e(p+=i))>0&&m>0||v<0&&m<0)&&(h=f,m=d),Math.abs(v)<l&&(b=p)}return b}(e=>(e===f?h:e===d?m:u(e).nodeValue)-c,null!==m&&m<c&&(m>h||h>c)?d:null!==h&&h<c&&(h>m||m>c)?f:-1e6,null!==m&&m>c&&(m<h||h<c)?d:null!==h&&h>c&&(h<m||m<c)?f:1e8,.1,10,1)}return void 0===l&&(l=null,a._meta.inversionFail=!0),this.cache=a,this.parsedSituation=o,dt(dt({},e),{},{unit:i,nodeValue:l,explanation:dt(dt({},e.explanation),{},{inversionGoal:t,inversionNumberOfIterations:s}),missingVariables:b})}));B("maximum",Ee((e,t)=>!1===e?t:!1===t?e:null===e||null===t?null:Math.max(e,t),!1));function mt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){gt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B("minimum",Ee((e,t)=>Math.min(e,t),1/0));function yt(e,t){return{explanation:{valeur:Qn(e.valeur,t),condition:Qn(e[yt.nom],t)},nodeKind:yt.nom}}function Ot(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ot(Object(n),!0).forEach((function(t){jt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ot(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function jt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}yt.nom="non applicable si",B(yt.nom,(function(e){var t=this.evaluate(e.explanation.condition),n=e.explanation.valeur;return!1!==t.nodeValue&&null!==t.nodeValue||(n=this.evaluate(n)),bt(bt({},e),{},{nodeValue:null===t.nodeValue?null:!1===t.nodeValue&&("nodeValue"in n?n.nodeValue:null),explanation:{valeur:n,condition:t},missingVariables:we("missingVariables"in n?n.missingVariables:{},Oe(t.missingVariables))},"unit"in n&&{unit:n.unit})}));function xt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xt(Object(n),!0).forEach((function(t){St(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function St(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B("une possibilité",e=>wt(wt({},e),{},{nodeValue:null,missingVariables:{[e.context]:1}}));var Pt={"*":[(e,t)=>e*t,"×"],"/":[(e,t)=>e/t,"∕"],"+":[(e,t)=>e+t],"-":[(e,t)=>e-t,"−"],"<":[(e,t)=>e<t],"<=":[(e,t)=>e<=t,"≤"],">":[(e,t)=>e>t],">=":[(e,t)=>e>=t,"≥"],"=":[(e,t)=>e===t],"!=":[(e,t)=>e!==t,"≠"]},kt=(e,t)=>(n,r)=>{var i=n.explanation.map(e=>Qn(e,r));return Et(Et({},n),{},{nodeKind:"operation",operationKind:e,operator:t||e,explanation:i})};B("operation",(function(e){var t,n,r=e.explanation.map(e=>this.evaluate(e)),[i,a]=r,s=je([i,a]);if(null==i.nodeValue||null==a.nodeValue)return Et(Et({},e),{},{nodeValue:null,explanation:r,missingVariables:s});if(!["∕","×"].includes(e.operator))try{i.unit&&"unit"in a?a=ve(i.unit,a):a.unit&&(i=ve(a.unit,i))}catch(t){o(this.options.logger,"Dans l'expression '".concat(e.operator,"', la partie gauche (unité: ").concat(G(i.unit),") n'est pas compatible avec la partie droite (unité: ").concat(G(a.unit),")"),t)}var u=Et(Et(Et({},e),{},{explanation:r},("*"===e.operationKind||"/"===e.operationKind||"-"===e.operationKind||"+"===e.operationKind)&&{unit:H(e.operationKind,[i.unit,a.unit])}),{},{missingVariables:s}),c=Pt[e.operationKind][0],l=Object(K.c)((t,n)=>!(!["≠","="].includes(e.operator)&&!1===t&&!1===n)&&((!["<",">","≤","≥","∕","×"].includes(e.operator)||!1!==t&&!1!==n)&&(!1!==t&&!1!==n&&["≠","=","<",">","≤","≥"].includes(e.operator)&&[t,n].every(e=>{var t;return null===(t=e.match)||void 0===t?void 0:t.call(e,/[\d]{2}\/[\d]{2}\/[\d]{4}/)})?c(Object(it.a)(t),Object(it.a)(n)):c(t,n))),null!==(t=i.temporalValue)&&void 0!==t?t:Object(K.h)(i.nodeValue),null!==(n=a.temporalValue)&&void 0!==n?n:Object(K.h)(a.nodeValue)),f=Object(K.j)(l,u.unit);return Et(Et({},u),{},{nodeValue:f},l.length>1&&{temporalValue:l})}));var At=Object.fromEntries(Object.entries(Pt).map(e=>{var[t,[n,r]]=e;return[t,kt(t,r)]}));function Nt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Vt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Nt(Object(n),!0).forEach((function(t){Dt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Nt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Dt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Tt(e,t){return{explanation:{valeur:Qn(e.valeur,t),"parDéfaut":Qn(e["par défaut"],t)},nodeKind:Tt.nom}}function Lt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Lt(Object(n),!0).forEach((function(t){It(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Lt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function It(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Tt.nom="par défaut",B(Tt.nom,(function(e){var t=Vt({},e.explanation),n=this.evaluate(t.valeur);return t.valeur=n,null===n.nodeValue&&(n=this.evaluate(t.parDéfaut),t.parDéfaut=n),Vt(Vt({},e),{},{nodeValue:n.nodeValue,explanation:t,missingVariables:we(Oe(t.valeur.missingVariables),"missingVariables"in t.parDéfaut?t.parDéfaut.missingVariables:{})},"unit"in n&&{unit:n.unit})}));function Mt(e,t){return{explanation:{valeur:Qn(e.valeur,t),plafond:Qn(e.plafond,t)},nodeKind:"plafond"}}function _t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ct(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_t(Object(n),!0).forEach((function(t){Bt(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_t(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Bt(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Mt.nom="plafond",B("plafond",(function(e){var t=this.evaluate(e.explanation.valeur),n=t.nodeValue,r=e.explanation.plafond;if(!1!==n){var i=this.evaluate(r);if(t.unit)try{r=ve(t.unit,i)}catch(e){o(this.options.logger,this.cache._meta.ruleStack[0],"L'unité du plafond n'est pas compatible avec celle de la valeur à encadrer",e)}}return"number"==typeof n&&"nodeValue"in r&&"number"==typeof r.nodeValue&&n>r.nodeValue&&(n=r.nodeValue,r.isActive=!0),Rt(Rt(Rt({},e),{},{nodeValue:n},"unit"in t&&{unit:t.unit}),{},{explanation:{valeur:t,plafond:r},missingVariables:je([t,r])})}));function Ut(e,t){return{explanation:{valeur:Qn(e.valeur,t),plancher:Qn(e.plancher,t)},nodeKind:"plancher"}}Ut.nom="plancher",B("plancher",(function(e){var t=this.evaluate(e.explanation.valeur),n=t.nodeValue,r=e.explanation.plancher;if(!1!==n){var i=this.evaluate(r);if(t.unit)try{r=ve(t.unit,i)}catch(e){o(this.options.logger,this.cache._meta.ruleStack[0],"L'unité du plancher n'est pas compatible avec celle de la valeur à encadrer",e)}}return"number"==typeof n&&"nodeValue"in r&&"number"==typeof r.nodeValue&&n<r.nodeValue&&(n=r.nodeValue,r.isActive=!0),Ct(Ct(Ct({},e),{},{nodeValue:n},"unit"in t&&{unit:t.unit}),{},{explanation:{valeur:t,plancher:r},missingVariables:je([t,r])})}));var qt,$t={assiette:!1,taux:Se(1),facteur:Se(1),plafond:Se(1/0)},Kt=(e,t)=>({explanation:Pe($t,e,t),nodeKind:"produit"});B("produit",(qt=function(e){var{assiette:t,taux:n,facteur:r,plafond:i}=e;if(t.unit)try{i=ve(t.unit,i)}catch(e){o(this.options.logger,this.cache._meta.ruleStack[0],"Impossible de convertir l'unité du plafond du produit dans celle de l'assiette",e)}var a=![n,t,r].some(e=>!1===e.nodeValue)&&([n,t,r].some(e=>0===e.nodeValue)?0:[n,t,r].some(e=>null===e.nodeValue)?null:((e,t,n,r)=>Math.min(e,!1===r?1/0:r)*t*n)(t.nodeValue,n.nodeValue,r.nodeValue,i.nodeValue)),s=H("*",[t,n,r].map(e=>e.unit));return le(s,t.unit)&&(a=ie(s,t.unit,a),s=t.unit),de({nodeValue:a,unit:s,explanation:{plafondActif:t.nodeValue>i.nodeValue}})},function(e){var t=Object.fromEntries(Object.entries(e.explanation).map(e=>{var[t,n]=e;return[t,this.evaluate(n)]})),n=Object(K.e)(Object.fromEntries,Object(K.a)(Object.entries(t).map(e=>{var[t,n]=e;return Object(K.k)(Object(K.h)(t),Object(K.d)(n))}))),r=Object(K.e)(e=>{var t=qt.call(this,e);return be(be({},t),{},{explanation:be(be({},e),t.explanation)})},n),i=xe.call(this,r.map(e=>e.value),e.nodeKind).map((e,t)=>be(be({},r[t]),{},{value:de(e)})),a=Object(K.e)(e=>{var{nodeValue:t}=e;return t},i),o=Object(K.j)(a),s=be(be({},e),{},{nodeValue:o,unit:i[0].value.unit,explanation:t,missingVariables:je(Object.values(t))});return 1===i.length?be(be({},s),{},{explanation:i[0].value.explanation}):be(be({},s),{},{temporalValue:a,temporalExplanation:r})}));var Ft=e=>e.split(" . "),Yt=e=>e.join(" . "),Wt=e=>{var t;return null===(t=Ft(e).slice(-1))||void 0===t?void 0:t[0]},Jt=e=>null==e?void 0:e.replace(/\s\.\s/g,"/").replace(/-/g,"‑").replace(/\s/g,"-"),Qt=e=>e.replace(/\//g," . ").replace(/-/g," ").replace(/\u2011/g,"-");function Gt(e){var t=Ft(e);return Array(t.length-1).fill(0).map((e,n)=>t.slice(0,n+1)).map(Yt).reverse()}function zt(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,r=[t,...Gt(t),""].map(e=>e?e+" . "+n:n).sort((e,n)=>e===t?1:n===t?-1:0),i=r.find(t=>t in e);if(!i)throw a(t,"La référence '".concat(n,"' est introuvable.\n\tVérifiez que l'orthographe et l'espace de nom sont corrects")),new Error;return i}function Ht(e){return!0!==e.virtualRule&&"groupe"!==e.type&&"texte"!==e.type&&"paragraphe"!==e.type&&"notification"!==e.type}function Zt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Xt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Zt(Object(n),!0).forEach((function(t){en(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Zt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function en(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tn(Object(n),!0).forEach((function(t){rn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function rn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function an(e,t){var n={situationKey:e[an.nom],valeur:Qn(e.valeur,t)};return{nodeKind:an.nom,explanation:n}}B("recalcul",(function(e){if(this.cache._meta.inRecalcul)return Se(!1);var t=e.explanation.amendedSituation.map(e=>{var[t,n]=e;return[this.evaluate(t),this.evaluate(n)]}).filter(e=>{var[t,n]=e;return t.nodeValue!==n.nodeValue||G(t.unit)!==G(n.unit)}),n=this.cache,r=Xt({},this.parsedSituation),i=Object.keys(t).length>0;i&&(this.resetCache(),this.cache._meta=Xt(Xt({},this.cache._meta),{},{inRecalcul:!0})),this.parsedSituation=Xt(Xt({},this.parsedSituation),Object.fromEntries(t.map(e=>{var[t,n]=e;return[zt(this.parsedRules,t.contextDottedName,t.name),n]})));var a=this.evaluate(e.explanation.recalcul);return this.parsedSituation=r,i&&(this.cache=n),Xt(Xt(Xt({},e),{},{nodeValue:a.nodeValue,explanation:{recalcul:a,amendedSituation:t},missingVariables:a.missingVariables},"unit"in a&&{unit:a.unit}),a.temporalValue&&{temporalValue:a.temporalValue})})),an.nom="nom dans la situation",B(an.nom,(function(e){var t,n,r=nn({},e.explanation),i=r.situationKey;i in this.parsedSituation?(n=this.evaluate(this.parsedSituation[i]),r.situationValeur=n):(n=this.evaluate(r.valeur),r.valeur=n,delete r.situationValeur);var a=null!==(t=n.unit)&&void 0!==t?t:"unit"in r.valeur?r.valeur.unit:void 0,o=je([r.situationValeur,r.valeur].filter(Boolean));return nn(nn(nn({},e),{},{nodeValue:n.nodeValue,missingVariables:0===Object.keys(o).length&&null===n.nodeValue?{[i]:1}:o},void 0!==a&&{unit:a}),{},{explanation:r})}));function on(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function sn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?on(Object(n),!0).forEach((function(t){un(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):on(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function un(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B("somme",Ee((e,t)=>e+t,0));function cn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ln(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cn(Object(n),!0).forEach((function(t){fn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B("synchronisation",(function(e){var t=this.evaluate(e.explanation.data),n=e.explanation.chemin.split(" . "),r=e=>n.reduce((e,t)=>e[t],e),i=null==t.nodeValue?null:r(t.nodeValue),a=null==i&&null!=t.nodeValue?r(t.explanation.defaultValue):i,o=sn(sn({},t.missingVariables),null===t.nodeValue?{[t.dottedName]:1}:{}),s=sn(sn({},e.explanation),{},{data:t});return sn(sn({},e),{},{nodeValue:a,explanation:s,missingVariables:o})}));function pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function hn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?pn(Object(n),!0).forEach((function(t){dn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function vn(e,t){return{explanation:Qn(e.valeur,t),unit:J(e.unité,t.getUnitKey),nodeKind:vn.nom}}function mn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function bn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mn(Object(n),!0).forEach((function(t){gn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function gn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B("taux progressif",(function(e){var t=this.evaluate.bind(this),n=this.evaluate(e.explanation.assiette),r=this.evaluate(e.explanation.multiplicateur),i=Fe.call(this,{parsedTranches:e.explanation.tranches,assiette:n,multiplicateur:r}),a=ln(ln({},e),{},{explanation:{tranches:i,assiette:n,multiplicateur:r},unit:J("%")}),o=i[i.length-1];if(i.every(e=>{var{isActive:t}=e;return!1===t})||o.isActive&&o.plafond.nodeValue===1/0){var s=ve(J("%"),t(o.taux)),{nodeValue:u,missingVariables:c}=s;return o.taux=s,o.nodeValue=u,o.missingVariables=c,ln(ln({},a),{},{nodeValue:u,missingVariables:c})}if(i.every(e=>{var{isActive:t}=e;return!0!==t})||"number"!=typeof n.nodeValue)return ln(ln({},a),{},{nodeValue:null,missingVariables:je(i)});var l=i.findIndex(e=>{var{isActive:t}=e;return!0===t}),f=i[l];f.taux=ve(J("%"),t(f.taux));var p=i[l-1];p&&(p.taux=ve(J("%"),t(p.taux)),p.isActive=!0);var h=p?p.taux:f.taux,d=[h,f.taux,f];if(d.some(e=>null===e.nodeValue))return f.nodeValue=null,f.missingVariables=je(d),ln(ln({},a),{},{nodeValue:null,missingVariables:f.missingVariables});var v=h.nodeValue,m=f.taux.nodeValue,b=f.plancherValue,g=(m-v)/(f.plafondValue-b),y=v+(n.nodeValue-b)*g;return f.nodeValue=y,ln(ln({},a),{},{nodeValue:y,missingVariables:{}})})),vn.nom="unité",B(vn.nom,(function(e){var t=this.evaluate(e.explanation),n=t.nodeValue;if(!1!==n&&"unit"in e)try{n=ie(t.unit,e.unit,t.nodeValue)}catch(e){o(this.options.logger,this.cache._meta.ruleStack[0],"Erreur lors de la conversion d'unité explicite",e)}return hn(hn({},e),{},{nodeValue:n,explanation:t,missingVariables:t.missingVariables})}));function yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function On(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yn(Object(n),!0).forEach((function(t){wn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function jn(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}B("variable temporelle",(function(e){var t=e.explanation.period.start&&this.evaluate(e.explanation.period.start),n=e.explanation.period.end&&this.evaluate(e.explanation.period.end),r=this.evaluate(e.explanation.value),i={start:(null==t?void 0:t.nodeValue)||null,end:(null==n?void 0:n.nodeValue)||null},a=r.temporalValue?Object(K.f)(i,r.temporalValue):Object(K.b)(r.nodeValue,i);return bn(bn({},e),{},{nodeValue:Object(K.j)(a,r.unit),temporalValue:a,explanation:{period:{start:t,end:n},value:r}},"unit"in r&&{unit:r.unit})}));function xn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function En(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(n),!0).forEach((function(t){Sn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Sn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function kn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pn(Object(n),!0).forEach((function(t){An(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function An(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}B("variations",(function(e){var[t,n,r]=e.explanation.reduce((e,t,n)=>{var r,i,[a,s,u,c]=e,{condition:l,consequence:f}=t;if(!Object(K.i)(e=>!0!==e,c))return[a,[...s,{condition:l,consequence:f}],u,c];var p=this.evaluate(l),h=Object(K.c)((e,t)=>null===e?e:!e&&(null===t?null:!1!==t),c,null!==(r=p.temporalValue)&&void 0!==r?r:Object(K.h)(p.nodeValue));if(p.missingVariables=Oe(p.missingVariables),!Object(K.i)(e=>!1!==e,h))return[a,[...s,{condition:p,consequence:f}],u,c];var d=this.evaluate(f);if(u)try{d=ve(u,d)}catch(e){o(this.options.logger,this.cache._meta.ruleStack[0],"L'unité de la branche n° ".concat(n+1," du mécanisme 'variations' n'est pas compatible avec celle d'une branche précédente"),e)}var v=Object(K.c)((e,t)=>e&&t,h,null!==(i=d.temporalValue)&&void 0!==i?i:Object(K.h)(d.nodeValue)),m=(e,t)=>e||t;return[Object(K.c)(m,a,v),[...s,{condition:p,satisfied:!!p.nodeValue,consequence:d}],u||d.unit,Object(K.c)(m,c,h)]},[Object(K.h)(!1),[],void 0,Object(K.h)(!1)]),i=Object(K.j)(t,r),a=je(n.reduce((e,t)=>{var{condition:n,consequence:r}=t;return[...e,n,r]},[]));return On(On(On({},e),{},{nodeValue:i},void 0!==r&&{unit:r}),{},{explanation:n,missingVariables:a},t.length>1&&{temporalValue:t})})),B("reference",(function(e){if(!e.dottedName)throw new s(e);var t=this.evaluate(this.parsedRules[e.dottedName]);return En(En({},e),{},{missingVariables:t.missingVariables,nodeValue:t.nodeValue},"unit"in t&&{unit:t.unit})}));var Nn=0,Vn={};function Dn(e,t){return e?(Array.isArray(e)?e:[e]).map(e=>{var n,r,i;"string"==typeof e&&(e={"règle":e});var a=Qn(e.règle,t),o=Qn(null!==(n=e.par)&&void 0!==n?n:t.dottedName,t),[s,u]=[null!==(r=e.dans)&&void 0!==r?r:[],null!==(i=e["sauf dans"])&&void 0!==i?i:[]].map(e=>Array.isArray(e)?e:[e]).map(e=>e.map(e=>Qn(e,t)));return{nodeKind:"replacementRule",rawNode:e,definitionRule:Qn(t.dottedName,t),replacedReference:a,replacementNode:o,whiteListedNames:s,blackListedNames:u,remplacementRuleId:Nn++}}):[]}function Tn(e,t){return Dn(e,t).map(e=>kn(kn({},e),{},{replacementNode:Se(!1)}))}function Ln(e){return Object.values(e).flatMap(e=>e.replacements).reduce((e,t)=>{var n;if(!t.replacedReference.dottedName)throw new s(t);var r=t.replacedReference.dottedName;return kn(kn({},e),{},{[r]:[...null!==(n=e[r])&&void 0!==n?n:[],t]})},{})}function Rn(e,t){return f((t,n)=>{if("replacementRule"===t.nodeKind||"inversion"===t.nodeKind||"une possibilité"===t.nodeKind)return!1;if("recalcul"===t.nodeKind)return kn(kn({},t),{},{explanation:{recalcul:n(t.explanation.recalcul),amendedSituation:t.explanation.amendedSituation.map(e=>{var[t,r]=e;return[t,n(r)]})}});if("reference"===t.nodeKind){var r;if(!t.dottedName)throw new s(t);return function(e,t,n){var r,i=t.filter(t=>{var{definitionRule:n}=t;return n.dottedName!==e.contextDottedName}).filter(t=>{var{whiteListedNames:n}=t;return!n.length||n.some(t=>e.contextDottedName.startsWith(t.dottedName))}).filter(t=>{var{blackListedNames:n}=t;return!n.length||n.every(t=>!e.contextDottedName.startsWith(t.dottedName))}).sort((e,t)=>{var n=+!!t.whiteListedNames.length-+!!e.whiteListedNames.length,r=+!!t.blackListedNames.length-+!!e.blackListedNames.length;return n||r});if(!i.length)return e;if(i.length>1){!1}var a=i.map(e=>e.remplacementRuleId).join("-");return null!==(r=Vn[a])&&void 0!==r||(Vn[a]={nodeKind:"variations",visualisationKind:"replacement",rawNode:e.rawNode,explanation:[...i.map(e=>({condition:e.definitionRule,consequence:e.replacementNode})),{condition:Se(!0),consequence:e}]}),Vn[a]}(t,null!==(r=e[t.dottedName])&&void 0!==r?r:[])}})}var In=e=>{var{style:t,maximumFractionDigits:n=2,minimumFractionDigits:r=0,language:i}=e;return e=>{var a="currency"===t&&n>=2&&0===r&&!Number.isInteger(e)?2:r;return Intl.NumberFormat(i,{style:t,currency:"EUR",maximumFractionDigits:n,minimumFractionDigits:a}).format(e)}};function Mn(e){var{maximumFractionDigits:t,minimumFractionDigits:n,language:r,formatUnit:i,unit:a,value:o}=e;if("number"!=typeof o)return o;var s=a?G(a,o,i):void 0;switch(s){case"€":return In({style:"currency",maximumFractionDigits:t,minimumFractionDigits:n,language:r})(o);case"%":return In({style:"percent",maximumFractionDigits:t,language:r})(o/100);default:return In({style:"decimal",minimumFractionDigits:n,maximumFractionDigits:t,language:r})(o)+("string"==typeof s?" ".concat(s):"")}}function _n(e){return e&&e[0].toUpperCase()+e.slice(1)}var Cn={fr:{true:"Oui",false:"Non"},en:{true:"Yes",false:"No"}};function Bn(e){var{language:t="fr",displayedUnit:n,formatUnit:r,precision:i=2}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a="number"==typeof e||void 0===e?e:e.nodeValue,o=null!=n?n:"number"!=typeof e&&void 0!==e&&"unit"in e?e.unit:void 0;return"number"==typeof a&&Number.isNaN(a)||null==a?"-":"string"==typeof a?_n(a.replace("\\n","\n")):"object"==typeof a?a.nom:"boolean"==typeof a?Cn[t][a]:"number"==typeof a?Mn({minimumFractionDigits:0,maximumFractionDigits:i,language:t,formatUnit:r,unit:o,value:a}):null}function Un(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Un(Object(n),!0).forEach((function(t){$n(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Un(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Kn(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Fn(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}function Yn(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Yn(Object(n),!0).forEach((function(t){Jn(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Yn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jn(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Qn(e,t){null==e&&a(t.dottedName,"\nUne des valeurs de la formule est vide.\nVérifiez que tous les champs à droite des deux points sont remplis"),"boolean"==typeof e&&a(t.dottedName,"\nLes valeurs booléennes true / false ne sont acceptées.\nUtilisez leur contrepartie française : 'oui' / 'non'");var n="object"==typeof e?e:function(e,t){try{var[n]=new U.Parser(Gn).feed(e+"").results;return n}catch(n){a(t.dottedName,"`".concat(e,"` n'est pas une expression valide"),n)}}(e,t);return"nom"in n?function(e,t){var n,r,i=[t.dottedName,e.nom].filter(Boolean).join(" . "),a=Wt(i),o=_n(null!==(n=e.titre)&&void 0!==n?n:t.ruleTitle?"".concat(t.ruleTitle," (").concat(a,")"):a);if(t.parsedRules[i])throw new Error("La référence '".concat(i,"' a déjà été définie"));var s=qn(qn(qn({},Object.fromEntries(Object.entries(e).filter(e=>{var[t]=e;return Xn.includes(t)}))),"formule"in e&&{valeur:e.formule}),{},{"nom dans la situation":i}),u=qn(qn({},t),{},{dottedName:i,ruleTitle:o}),[c]=Gt(i),l={valeur:Qn(s,u),parent:!!c&&Qn(c,t)};return t.parsedRules[i]={dottedName:i,replacements:[...Tn(e["rend non applicable"],u),...Dn(e.remplace,u)],title:o,suggestions:Object.fromEntries(Object.entries(null!==(r=e.suggestions)&&void 0!==r?r:{}).map(e=>{var[t,n]=e;return[t,Qn(n,u)]})),nodeKind:"rule",explanation:l,rawNode:e,virtualRule:!!t.dottedName},Qn(e.nom,t)}(n,t):Wn(Wn({},function(e,t){var n=Hn.find(t=>t.nom in e);if(!n)return zn(e,t);var r=n.nom,{[r]:i}=e,a=Kn(e,[r].map(Fn));return zn({[n.nom]:{valeur:a,[n.nom]:i}},t)}(n,t)),{},{rawNode:e})}B("rule",(function(e){var t,n;if(this.cache[e.dottedName])return this.cache[e.dottedName];var r=qn({},e.explanation),i=!this.cache._meta.ruleStack.includes(e.dottedName);this.cache._meta.ruleStack.unshift(e.dottedName);var a=null;r.parent&&i&&(a=this.evaluate(r.parent),r.parent=a);var o=null;a&&!1===a.nodeValue||(o=this.evaluate(r.valeur),r.valeur=o);var s=qn(qn({},e),{},{explanation:r,nodeValue:!(!o||!("nodeValue"in o))&&o.nodeValue,missingVariables:we(null===(t=o)||void 0===t?void 0:t.missingVariables,Oe(null===(n=a)||void 0===n?void 0:n.missingVariables))},o&&"unit"in o&&{unit:o.unit});return this.cache._meta.ruleStack.shift(),this.cache[e.dottedName]=s,s}));var Gn=U.Grammar.fromCompiled($.a);function zn(e,t){Array.isArray(e)&&a(t.dottedName,"\nIl manque le nom du mécanisme pour le tableau : [".concat(e.map(e=>"'".concat(e,"'")).join(", "),"]\nLes mécanisme possibles sont : 'somme', 'le maximum de', 'le minimum de', 'toutes ces conditions', 'une de ces conditions'.\n\t\t"));var n=Object.keys(e);if(n.length>1&&a(t.dottedName,"\nLes mécanismes suivants se situent au même niveau : ".concat(n.map(e=>"'".concat(e,"'")).join(", "),"\nCela vient probablement d'une erreur dans l'indentation\n\t")),0===n.length)return{nodeKind:"constant",nodeValue:null};var r=Object.keys(e)[0],o=e[r],s=Zn[r];s||a(t.dottedName,"\nLe mécanisme ".concat(r," est inconnu.\nVérifiez qu'il n'y ait pas d'erreur dans l'orthographe du nom."));try{return(null==o?void 0:o.composantes)?((e,t,n)=>{var{composantes:r}=t,i=He(t,["composantes"]),a=Qn({somme:r.map(t=>{var{attributs:n}=t,r=He(t,["attributs"]);return Ge(Ge({},n),{},{[e]:Ge(Ge({},i),r)})})},n);return Ge(Ge({},a),{},{visualisationKind:"composantes"})})(r,o,t):(null==o?void 0:o.variations)&&Object.values(o).length>1?((e,t,n)=>{if("valeur"===e)return Qn(t,n);var{variations:r}=t,i=jn(t,["variations"]);return Qn({variations:r.map(t=>{var{alors:n,sinon:r,si:a}=t,o=null!=n?n:r,{attributs:s}=o,u=jn(o,["attributs"]);return On({[void 0!==n?"alors":"sinon"]:On(On({},s),{},{[e]:On(On({},i),u)})},void 0!==a&&{si:a})})},n)})(r,o,t):s(o,t)}catch(e){if(e instanceof i)throw e;a(t.dottedName,r?"➡️ Dans le mécanisme ".concat(r,"\n").concat(e.message):e.message)}}var Hn=[Re,yt,Tt,Be,vn,Ut,Mt,Ve,an];var Zn=Wn(Wn(Wn({},At),Hn.reduce((e,t)=>Wn({[t.nom]:t},e),{})),{},{"une possibilité":(e,t)=>(Array.isArray(e)&&(e={"possibilités":e}),wt(wt({},e),{},{explanation:e.possibilités.map(e=>Qn(e,t)),nodeKind:"une possibilité",context:t.dottedName})),"inversion numérique":(e,t)=>{if(!e.avec)throw new Error("Une formule d'inversion doit préciser _avec_ quoi on peut inverser la variable");return dt(dt({explanation:{ruleToInverse:t.dottedName,inversionCandidates:e.avec.map(e=>Qn(e,t))}},"unité"in e&&{unit:J(e.unité,t.getUnitKey)}),{},{nodeKind:"inversion"})},recalcul:(e,t)=>{var n,r=Object.keys(e.avec).map(n=>[Qn(n,t),Qn(e.avec[n],t)]),i=t.dottedName;return{explanation:{recalcul:Qn(null!==(n=e.règle)&&void 0!==n?n:i,t),amendedSituation:r},nodeKind:"recalcul"}},variable:function(e,t){return{nodeKind:"reference",name:e,contextDottedName:t.dottedName}},"une de ces conditions":(e,t)=>{if(!Array.isArray(e))throw new Error("should be array");return{explanation:e.map(e=>Qn(e,t)),nodeKind:"une de ces conditions"}},"toutes ces conditions":(e,t)=>{if(!Array.isArray(e))throw new Error("should be array");return{explanation:e.map(e=>Qn(e,t)),nodeKind:"toutes ces conditions"}},somme:(e,t)=>({explanation:e.map(e=>Qn(e,t)),nodeKind:"somme"}),multiplication:Kt,produit:Kt,temporalValue:function(e,t){var n=Qn(e.explanation,t);return{nodeKind:"variable temporelle",explanation:{period:{start:e.period.start&&Qn(e.period.start,t),end:e.period.end&&Qn(e.period.end,t)},value:n}}},"barème":function(e,t){return{explanation:{assiette:Qn(e.assiette,t),multiplicateur:e.multiplicateur?Qn(e.multiplicateur,t):Se(1),tranches:Ke(e.tranches,t)},nodeKind:"barème"}},grille:function(e,t){return{explanation:{assiette:Qn(e.assiette,t),multiplicateur:e.multiplicateur?Qn(e.multiplicateur,t):Se(1),tranches:Ke(e.tranches,t)},nodeKind:"grille"}},"taux progressif":function(e,t){return{explanation:{assiette:Qn(e.assiette,t),multiplicateur:e.multiplicateur?Qn(e.multiplicateur,t):Se(1),tranches:Ke(e.tranches,t)},nodeKind:"taux progressif"}},"durée":(e,t)=>({explanation:Pe(ct,e,t),unit:J("jour"),nodeKind:"durée"}),"le maximum de":(e,t)=>({explanation:e.map(e=>Qn(e,t)),nodeKind:"maximum"}),"le minimum de":(e,t)=>({explanation:e.map(e=>Qn(e,t)),nodeKind:"minimum"}),variations:function(e,t){return{explanation:e.map(e=>{var{si:n,alors:r,sinon:i}=e;return void 0!==i?{consequence:Qn(i,t),condition:Se(!0)}:{consequence:Qn(r,t),condition:Qn(n,t)}}),nodeKind:"variations"}},synchronisation:(e,t)=>({explanation:sn(sn({},e),{},{data:Qn(e.data,t)}),nodeKind:"synchronisation"}),valeur:Qn,objet:e=>({type:"objet",nodeValue:e,nodeKind:"constant"}),constant:e=>({type:e.type,fullPrecision:!0,nodeValue:e.nodeValue,nodeKind:"constant"})}),Xn=Object.keys(Zn),er=n(9),tr=n.n(er);function nr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?nr(Object(n),!0).forEach((function(t){ir(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ir(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ar(e){var t,n,r,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o="string"==typeof e?tr.a.parse((""+e).replace(/\t/g,"  ")):rr({},e);o=or(o);var s={dottedName:null!==(t=a.dottedName)&&void 0!==t?t:"",parsedRules:null!==(n=a.parsedRules)&&void 0!==n?n:{},logger:null!==(r=a.logger)&&void 0!==r?r:console,getUnitKey:null!==(i=a.getUnitKey)&&void 0!==i?i:e=>e};Object.entries(o).forEach(e=>{var[t,n]=e;null==n&&(n={}),"object"!=typeof n&&(n={formule:""+n}),Qn(rr({nom:t},n),s)});var u=s.parsedRules,c=Ln(u=h(sr(u),u));return u=h(Rn(c,s.logger),u)}function or(e){return Array.isArray(e)?e.map(or):e&&"object"==typeof e?Object.entries(e).reduce((e,t)=>{var n,[r,i]=t,a=/\[ref( (.+))?\]$/.exec(r);if(!a)return rr(rr({},e),{},{[r]:or(i)});var o=r.replace(a[0],"").trim(),s=(null===(n=a[2])||void 0===n?void 0:n.trim())||o;return rr(rr({},e),{},{[o]:{nom:s,valeur:or(i)}})},{}):e}var sr=e=>f(t=>{if("reference"===t.nodeKind){var n=zt(e,t.contextDottedName,t.name);return rr(rr({},t),{},{dottedName:n,title:e[n].title,acronym:e[n].rawNode.acronyme})}}),ur=n(7),cr=n.n(ur);function lr(e){if("number"==typeof e.nodeValue){var t=G(e.unit);return""+e.nodeValue+(t?t.replace(/\s/g,""):"")}return"boolean"==typeof e.nodeValue?e.nodeValue?"oui":"non":"string"==typeof e.nodeValue?"'".concat(e.nodeValue,"'"):void 0}function fr(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function pr(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fr(Object(n),!0).forEach((function(t){hr(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fr(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hr(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var dr=()=>({_meta:{ruleStack:[]},nodes:new Map});class vr{constructor(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};hr(this,"parsedRules",void 0),hr(this,"parsedSituation",{}),hr(this,"replacements",{}),hr(this,"cache",dr()),hr(this,"options",void 0),this.options=pr(pr({},n),{},{logger:null!==(e=n.logger)&&void 0!==e?e:console}),"string"==typeof t&&(t=ar(t,this.options));var r=Object.values(t)[0];"object"==typeof r&&null!=r&&"nodeKind"in r||(t=ar(t,this.options)),this.parsedRules=t,this.replacements=Ln(this.parsedRules)}setOptions(e){this.options=pr(pr({},this.options),e)}resetCache(){this.cache=dr()}setSituation(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.resetCache(),this.parsedSituation=Object.fromEntries(Object.entries(e).map(e=>{var[t,n]=e;return n&&"object"==typeof n&&"nodeKind"in n?[t,n]:[t,n&&"object"==typeof n&&"nodeKind"in n?n:this.parse(n,pr({dottedName:"situation [".concat(t,"]"),parsedRules:{}},this.options))]})),this}parse(){return Rn(this.replacements,this.options.logger)(sr(this.parsedRules)(Qn(...arguments)))}inversionFail(){return!!this.cache._meta.inversionFail}getRule(e){if(!(e in this.parsedRules))throw new Error("La règle '".concat(e,"' n'existe pas"));return this.parsedRules[e]}getParsedRules(){return this.parsedRules}evaluate(e){var t,n=this.cache.nodes.get(e);if(void 0!==n)return n;if(t=e&&"object"==typeof e&&"nodeKind"in e?e:this.parse(e,pr({dottedName:"evaluation",parsedRules:{}},this.options)),!C[t.nodeKind])throw Error('Unknown "nodeKind": '.concat(t.nodeKind));var r=C[t.nodeKind].call(this,t);return this.cache.nodes.set(e,r),r}}function mr(e,t){var n=e.getRule(t);return p((function(r,i,a){return r||("nodeValue"in i?"variations"===i.nodeKind?i.explanation.some(e=>{var{consequence:n}=e;return a(n)||!1===n.nodeValue&&n.dottedName!==t}):"reference"===i.nodeKind&&i.dottedName===t?a(e.evaluate(n)):"applicable si"===i.nodeKind?!1===i.explanation.condition.nodeValue||a(i.explanation.valeur):"non applicable si"===i.nodeKind?!1!==i.explanation.condition.nodeValue&&null!==i.explanation.condition.nodeValue:"rule"===i.nodeKind?!1===i.explanation.parent.nodeValue||a(i.explanation.valeur):void 0:r)}),!1,e.evaluate(t))}},function(e,t,n){"use strict";n.r(t),n.d(t,"YAML",(function(){return pe}));var r=n(0),i=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(){return Object(r.j)(this,n),t.call(this,r.e.BLANK_LINE)}return Object(r.i)(n,[{key:"parse",value:function(e,t){return this.context=e,this.range=new r.d(t,t+1),t+1}},{key:"includesTrailingLines",get:function(){return!0}}]),n}(r.b),a=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(e,i){var a;return Object(r.j)(this,n),(a=t.call(this,e,i)).node=null,a}return Object(r.i)(n,[{key:"parse",value:function(e,t){this.context=e;var n=e.parseNode,a=e.src,o=e.atLineStart,s=e.lineStart;o||this.type!==r.e.SEQ_ITEM||(this.error=new r.n(this,"Sequence items must not have preceding content on the same line"));for(var u=o?t-s:e.indent,c=r.b.endOfWhiteSpace(a,t+1),l=a[c],f="#"===l,p=[],h=null;"\n"===l||"#"===l;){if("#"===l){var d=r.b.endOfLine(a,c+1);p.push(new r.d(c,d)),c=d}else{o=!0,s=c+1,"\n"===a[r.b.endOfWhiteSpace(a,s)]&&0===p.length&&(s=(h=new i).parse({src:a},s)),c=r.b.endOfIndent(a,s)}l=a[c]}if(r.b.nextNodeIsIndented(l,c-(s+u),this.type!==r.e.SEQ_ITEM)?this.node=n({atLineStart:o,inCollection:!1,indent:u,lineStart:s,parent:this},c):l&&s>t+1&&(c=s-1),this.node){if(h){var v=e.parent.items||e.parent.contents;v&&v.push(h)}p.length&&Array.prototype.push.apply(this.props,p),c=this.node.range.end}else if(f){var m=p[0];this.props.push(m),c=m.end}else c=r.b.endOfLine(a,t+1);var b=this.node?this.node.valueRange.end:c;return this.valueRange=new r.d(t,b),c}},{key:"setOrigRanges",value:function(e,t){return t=Object(r.s)(Object(r.t)(n.prototype),"setOrigRanges",this).call(this,e,t),this.node?this.node.setOrigRanges(e,t):t}},{key:"toString",value:function(){var e=this.context.src,t=this.node,n=this.range,i=this.value;if(null!=i)return i;var a=t?e.slice(n.start,t.range.start)+String(t):e.slice(n.start,n.end);return r.b.addStringTerminator(e,n.end,a)}},{key:"includesTrailingLines",get:function(){return!!this.node&&this.node.includesTrailingLines}}]),n}(r.b),o=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(){return Object(r.j)(this,n),t.call(this,r.e.COMMENT)}return Object(r.i)(n,[{key:"parse",value:function(e,t){this.context=e;var n=this.parseComment(t);return this.range=new r.d(t,n),n}}]),n}(r.b);function s(e){for(var t=e;t instanceof a;)t=t.node;if(!(t instanceof u))return null;for(var n=t.items.length,i=-1,o=n-1;o>=0;--o){var s=t.items[o];if(s.type===r.e.COMMENT){var c=s.context,l=c.indent,f=c.lineStart;if(l>0&&s.range.start>=f+l)break;i=o}else{if(s.type!==r.e.BLANK_LINE)break;i=o}}if(-1===i)return null;for(var p=t.items.splice(i,n-i),h=p[0].range.start;t.range.end=h,t.valueRange&&t.valueRange.end>h&&(t.valueRange.end=h),t!==e;)t=t.context.parent;return p}var u=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(e){var i;Object(r.j)(this,n),i=t.call(this,e.type===r.e.SEQ_ITEM?r.e.SEQ:r.e.MAP);for(var a=e.props.length-1;a>=0;--a)if(e.props[a].start<e.context.lineStart){i.props=e.props.slice(0,a+1),e.props=e.props.slice(a+1);var o=e.props[0]||e.valueRange;e.range.start=o.start;break}i.items=[e];var u=s(e);return u&&Array.prototype.push.apply(i.items,u),i}return Object(r.i)(n,null,[{key:"nextContentHasIndent",value:function(e,t,i){var a=r.b.endOfLine(e,t)+1,o=e[t=r.b.endOfWhiteSpace(e,a)];return!!o&&(t>=a+i||("#"===o||"\n"===o)&&n.nextContentHasIndent(e,t,i))}}]),Object(r.i)(n,[{key:"parse",value:function(e,t){this.context=e;var a=e.parseNode,u=e.src,c=r.b.startOfLine(u,t),l=this.items[0];l.context.parent=this,this.valueRange=r.d.copy(l.valueRange);for(var f=l.range.start-l.context.lineStart,p=t,h=u[p=r.b.normalizeOffset(u,p)],d=r.b.endOfWhiteSpace(u,c)===p,v=!1;h;){for(;"\n"===h||"#"===h;){if(d&&"\n"===h&&!v){var m=new i;if(p=m.parse({src:u},p),this.valueRange.end=p,p>=u.length){h=null;break}this.items.push(m),p-=1}else if("#"===h){if(p<c+f&&!n.nextContentHasIndent(u,p,f))return p;var b=new o;if(p=b.parse({indent:f,lineStart:c,src:u},p),this.items.push(b),this.valueRange.end=p,p>=u.length){h=null;break}}if(c=p+1,p=r.b.endOfIndent(u,c),r.b.atBlank(u,p)){var g=r.b.endOfWhiteSpace(u,p),y=u[g];y&&"\n"!==y&&"#"!==y||(p=g)}h=u[p],d=!0}if(!h)break;if(p!==c+f&&(d||":"!==h)){if(p<c+f){c>t&&(p=c);break}if(!this.error){this.error=new r.f(this,"All collection items must start at the same column")}}if(l.type===r.e.SEQ_ITEM){if("-"!==h){c>t&&(p=c);break}}else if("-"===h&&!this.error){var O=u[p+1];if(!O||"\n"===O||"\t"===O||" "===O){this.error=new r.f(this,"A collection cannot be both a mapping and a sequence")}}var w=a({atLineStart:d,inCollection:!0,indent:f,lineStart:c,parent:this},p);if(!w)return p;if(this.items.push(w),this.valueRange.end=w.valueRange.end,h=u[p=r.b.normalizeOffset(u,w.range.end)],d=!1,v=w.includesTrailingLines,h){for(var j=p-1,x=u[j];" "===x||"\t"===x;)x=u[--j];"\n"===x&&(c=j+1,d=!0)}var E=s(w);E&&Array.prototype.push.apply(this.items,E)}return p}},{key:"setOrigRanges",value:function(e,t){return t=Object(r.s)(Object(r.t)(n.prototype),"setOrigRanges",this).call(this,e,t),this.items.forEach((function(n){t=n.setOrigRanges(e,t)})),t}},{key:"toString",value:function(){var e=this.context.src,t=this.items,n=this.range,i=this.value;if(null!=i)return i;for(var a=e.slice(n.start,t[0].range.start)+String(t[0]),o=1;o<t.length;++o){var s=t[o],u=s.context,c=u.atLineStart,l=u.indent;if(c)for(var f=0;f<l;++f)a+=" ";a+=String(s)}return r.b.addStringTerminator(e,n.end,a)}},{key:"includesTrailingLines",get:function(){return this.items.length>0}}]),n}(r.b),c=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(){var e;return Object(r.j)(this,n),(e=t.call(this,r.e.DIRECTIVE)).name=null,e}return Object(r.i)(n,[{key:"parseName",value:function(e){for(var t=this.context.src,n=e,r=t[n];r&&"\n"!==r&&"\t"!==r&&" "!==r;)r=t[n+=1];return this.name=t.slice(e,n),n}},{key:"parseParameters",value:function(e){for(var t=this.context.src,n=e,i=t[n];i&&"\n"!==i&&"#"!==i;)i=t[n+=1];return this.valueRange=new r.d(e,n),n}},{key:"parse",value:function(e,t){this.context=e;var n=this.parseName(t+1);return n=this.parseParameters(n),n=this.parseComment(n),this.range=new r.d(t,n),n}},{key:"parameters",get:function(){var e=this.rawValue;return e?e.trim().split(/[ \t]+/):[]}}]),n}(r.b),l=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(){var e;return Object(r.j)(this,n),(e=t.call(this,r.e.DOCUMENT)).directives=null,e.contents=null,e.directivesEndMarker=null,e.documentEndMarker=null,e}return Object(r.i)(n,null,[{key:"startCommentOrEndBlankLine",value:function(e,t){var n=r.b.endOfWhiteSpace(e,t),i=e[n];return"#"===i||"\n"===i?n:t}}]),Object(r.i)(n,[{key:"parseDirectives",value:function(e){var t=this.context.src;this.directives=[];for(var a=!0,s=!1,u=e;!r.b.atDocumentBoundary(t,u,r.a.DIRECTIVES_END);)switch(t[u=n.startCommentOrEndBlankLine(t,u)]){case"\n":if(a){var l=new i;(u=l.parse({src:t},u))<t.length&&this.directives.push(l)}else u+=1,a=!0;break;case"#":var f=new o;u=f.parse({src:t},u),this.directives.push(f),a=!1;break;case"%":var p=new c;u=p.parse({parent:this,src:t},u),this.directives.push(p),s=!0,a=!1;break;default:return s?this.error=new r.n(this,"Missing directives-end indicator line"):this.directives.length>0&&(this.contents=this.directives,this.directives=[]),u}return t[u]?(this.directivesEndMarker=new r.d(u,u+3),u+3):(s?this.error=new r.n(this,"Missing directives-end indicator line"):this.directives.length>0&&(this.contents=this.directives,this.directives=[]),u)}},{key:"parseContents",value:function(e){var t=this.context,a=t.parseNode,u=t.src;this.contents||(this.contents=[]);for(var c=e;"-"===u[c-1];)c-=1;var l=r.b.endOfWhiteSpace(u,e),f=c===e;for(this.valueRange=new r.d(l);!r.b.atDocumentBoundary(u,l,r.a.DOCUMENT_END);){switch(u[l]){case"\n":if(f){var p=new i;(l=p.parse({src:u},l))<u.length&&this.contents.push(p)}else l+=1,f=!0;c=l;break;case"#":var h=new o;l=h.parse({src:u},l),this.contents.push(h),f=!1;break;default:var d=r.b.endOfIndent(u,l),v=a({atLineStart:f,indent:-1,inFlow:!1,inCollection:!1,lineStart:c,parent:this},d);if(!v)return this.valueRange.end=d;this.contents.push(v),l=v.range.end,f=!1;var m=s(v);m&&Array.prototype.push.apply(this.contents,m)}l=n.startCommentOrEndBlankLine(u,l)}if(this.valueRange.end=l,u[l]&&(this.documentEndMarker=new r.d(l,l+3),u[l+=3])){if("#"===u[l=r.b.endOfWhiteSpace(u,l)]){var b=new o;l=b.parse({src:u},l),this.contents.push(b)}switch(u[l]){case"\n":l+=1;break;case void 0:break;default:this.error=new r.f(this,"Document end marker line cannot have a non-comment suffix")}}return l}},{key:"parse",value:function(e,t){e.root=this,this.context=e;var n=65279===e.src.charCodeAt(t)?t+1:t;return n=this.parseDirectives(n),n=this.parseContents(n)}},{key:"setOrigRanges",value:function(e,t){return t=Object(r.s)(Object(r.t)(n.prototype),"setOrigRanges",this).call(this,e,t),this.directives.forEach((function(n){t=n.setOrigRanges(e,t)})),this.directivesEndMarker&&(t=this.directivesEndMarker.setOrigRange(e,t)),this.contents.forEach((function(n){t=n.setOrigRanges(e,t)})),this.documentEndMarker&&(t=this.documentEndMarker.setOrigRange(e,t)),t}},{key:"toString",value:function(){var e=this.contents,t=this.directives,n=this.value;if(null!=n)return n;var i=t.join("");return e.length>0&&((t.length>0||e[0].type===r.e.COMMENT)&&(i+="---\n"),i+=e.join("")),"\n"!==i[i.length-1]&&(i+="\n"),i}}]),n}(r.b),f=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(){return Object(r.j)(this,n),t.apply(this,arguments)}return Object(r.i)(n,[{key:"parse",value:function(e,t){this.context=e;var n=e.src,i=r.b.endOfIdentifier(n,t+1);return this.valueRange=new r.d(t+1,i),i=r.b.endOfWhiteSpace(n,i),i=this.parseComment(i)}}]),n}(r.b),p="CLIP",h="KEEP",d="STRIP",v=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(e,i){var a;return Object(r.j)(this,n),(a=t.call(this,e,i)).blockIndent=null,a.chomping=p,a.header=null,a}return Object(r.i)(n,[{key:"parseBlockHeader",value:function(e){for(var t=this.context.src,n=e+1,i="";;){var a=t[n];switch(a){case"-":this.chomping=d;break;case"+":this.chomping=h;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":i+=a;break;default:return this.blockIndent=Number(i)||null,this.header=new r.d(e,n),n}n+=1}}},{key:"parseBlockValue",value:function(e){for(var t=this.context,n=t.indent,i=t.src,a=!!this.blockIndent,o=e,s=e,u=1,c=i[o];"\n"===c&&(o+=1,!r.b.atDocumentBoundary(i,o));c=i[o]){var l=r.b.endOfBlockIndent(i,n,o);if(null===l)break;var f=i[l],p=l-(o+n);if(this.blockIndent){if(f&&"\n"!==f&&p<this.blockIndent){if("#"===i[l])break;if(!this.error){var d="Block scalars must not be less indented than their ".concat(a?"explicit indentation indicator":"first line");this.error=new r.n(this,d)}}}else if("\n"!==i[l]){if(p<u){this.error=new r.n(this,"Block scalars with more-indented leading empty lines must use an explicit indentation indicator")}this.blockIndent=p}else p>u&&(u=p);o="\n"===i[l]?l:s=r.b.endOfLine(i,l)}return this.chomping!==h&&(o=i[s]?s+1:s),this.valueRange=new r.d(e+1,o),o}},{key:"parse",value:function(e,t){this.context=e;var n=e.src,i=this.parseBlockHeader(t);return i=r.b.endOfWhiteSpace(n,i),i=this.parseComment(i),i=this.parseBlockValue(i)}},{key:"setOrigRanges",value:function(e,t){return t=Object(r.s)(Object(r.t)(n.prototype),"setOrigRanges",this).call(this,e,t),this.header?this.header.setOrigRange(e,t):t}},{key:"includesTrailingLines",get:function(){return this.chomping===h}},{key:"strValue",get:function(){if(!this.valueRange||!this.context)return null;var e=this.valueRange,t=e.start,n=e.end,i=this.context,a=i.indent,o=i.src;if(this.valueRange.isEmpty())return"";for(var s=null,u=o[n-1];"\n"===u||"\t"===u||" "===u;){if((n-=1)<=t){if(this.chomping===h)break;return""}"\n"===u&&(s=n),u=o[n-1]}var c=n+1;s&&(this.chomping===h?(c=s,n=this.valueRange.end):n=s);for(var l=a+this.blockIndent,f=this.type===r.e.BLOCK_FOLDED,p=!0,v="",m="",b=!1,g=t;g<n;++g){for(var y=0;y<l&&" "===o[g];++y)g+=1;var O=o[g];if("\n"===O)"\n"===m?v+="\n":m="\n";else{var w=r.b.endOfLine(o,g),j=o.slice(g,w);g=w,f&&(" "===O||"\t"===O)&&g<c?(" "===m?m="\n":b||p||"\n"!==m||(m="\n\n"),v+=m+j,m=w<n&&o[w]||"",b=!0):(v+=m+j,m=f&&g<c?" ":"\n",b=!1),p&&""!==j&&(p=!1)}}return this.chomping===d?v:v+"\n"}}]),n}(r.b),m=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(e,i){var a;return Object(r.j)(this,n),(a=t.call(this,e,i)).items=null,a}return Object(r.i)(n,[{key:"prevNodeIsJsonLike",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.items.length,t=this.items[e-1];return!!t&&(t.jsonLike||t.type===r.e.COMMENT&&this.prevNodeIsJsonLike(e-1))}},{key:"parse",value:function(e,t){this.context=e;var n=e.parseNode,a=e.src,s=e.indent,u=e.lineStart,c=a[t];this.items=[{char:c,offset:t}];var l=r.b.endOfWhiteSpace(a,t+1);for(c=a[l];c&&"]"!==c&&"}"!==c;){switch(c){case"\n":if(u=l+1,"\n"===a[r.b.endOfWhiteSpace(a,u)]){var f=new i;u=f.parse({src:a},u),this.items.push(f)}if((l=r.b.endOfIndent(a,u))<=u+s&&(c=a[l],l<u+s||"]"!==c&&"}"!==c)){this.error=new r.n(this,"Insufficient indentation in flow collection")}break;case",":this.items.push({char:c,offset:l}),l+=1;break;case"#":var p=new o;l=p.parse({src:a},l),this.items.push(p);break;case"?":case":":var h=a[l+1];if("\n"===h||"\t"===h||" "===h||","===h||":"===c&&this.prevNodeIsJsonLike()){this.items.push({char:c,offset:l}),l+=1;break}default:var d=n({atLineStart:!1,inCollection:!1,inFlow:!0,indent:-1,lineStart:u,parent:this},l);if(!d)return this.valueRange=new r.d(t,l),l;this.items.push(d),l=r.b.normalizeOffset(a,d.range.end)}c=a[l=r.b.endOfWhiteSpace(a,l)]}return this.valueRange=new r.d(t,l+1),c&&(this.items.push({char:c,offset:l}),l=r.b.endOfWhiteSpace(a,l+1),l=this.parseComment(l)),l}},{key:"setOrigRanges",value:function(e,t){return t=Object(r.s)(Object(r.t)(n.prototype),"setOrigRanges",this).call(this,e,t),this.items.forEach((function(n){if(n instanceof r.b)t=n.setOrigRanges(e,t);else if(0===e.length)n.origOffset=n.offset;else{for(var i=t;i<e.length&&!(e[i]>n.offset);)++i;n.origOffset=n.offset+i,t=i}})),t}},{key:"toString",value:function(){var e=this.context.src,t=this.items,n=this.range,i=this.value;if(null!=i)return i;var a=t.filter((function(e){return e instanceof r.b})),o="",s=n.start;return a.forEach((function(t){var n=e.slice(s,t.range.start);s=t.range.end,"\n"===(o+=n+String(t))[o.length-1]&&"\n"!==e[s-1]&&"\n"===e[s]&&(s+=1)})),o+=e.slice(s,n.end),r.b.addStringTerminator(e,n.end,o)}}]),n}(r.b),b=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(){return Object(r.j)(this,n),t.apply(this,arguments)}return Object(r.i)(n,[{key:"parseCharCode",value:function(e,t,n){var i=this.context.src,a=i.substr(e,t),o=a.length===t&&/^[0-9a-fA-F]+$/.test(a)?parseInt(a,16):NaN;return isNaN(o)?(n.push(new r.f(this,"Invalid escape sequence ".concat(i.substr(e-2,t+2)))),i.substr(e-2,t+2)):String.fromCodePoint(o)}},{key:"parse",value:function(e,t){this.context=e;var i=e.src,a=n.endOfQuote(i,t+1);return this.valueRange=new r.d(t,a),a=r.b.endOfWhiteSpace(i,a),a=this.parseComment(a)}},{key:"strValue",get:function(){if(!this.valueRange||!this.context)return null;var e=[],t=this.valueRange,n=t.start,i=t.end,a=this.context,o=a.indent,s=a.src;'"'!==s[i-1]&&e.push(new r.f(this,'Missing closing "quote'));for(var u="",c=n+1;c<i-1;++c){var l=s[c];if("\n"===l){r.b.atDocumentBoundary(s,c+1)&&e.push(new r.n(this,"Document boundary indicators are not allowed within string values"));var f=r.b.foldNewline(s,c,o);u+=f.fold,c=f.offset,f.error&&e.push(new r.n(this,"Multi-line double-quoted string needs to be sufficiently indented"))}else if("\\"===l)switch(s[c+=1]){case"0":u+="\0";break;case"a":u+="";break;case"b":u+="\b";break;case"e":u+="";break;case"f":u+="\f";break;case"n":u+="\n";break;case"r":u+="\r";break;case"t":u+="\t";break;case"v":u+="\v";break;case"N":u+="";break;case"_":u+=" ";break;case"L":u+="\u2028";break;case"P":u+="\u2029";break;case" ":u+=" ";break;case'"':u+='"';break;case"/":u+="/";break;case"\\":u+="\\";break;case"\t":u+="\t";break;case"x":u+=this.parseCharCode(c+1,2,e),c+=2;break;case"u":u+=this.parseCharCode(c+1,4,e),c+=4;break;case"U":u+=this.parseCharCode(c+1,8,e),c+=8;break;case"\n":for(;" "===s[c+1]||"\t"===s[c+1];)c+=1;break;default:e.push(new r.f(this,"Invalid escape sequence ".concat(s.substr(c-1,2)))),u+="\\"+s[c]}else if(" "===l||"\t"===l){for(var p=c,h=s[c+1];" "===h||"\t"===h;)h=s[(c+=1)+1];"\n"!==h&&(u+=c>p?s.slice(p,c+1):l)}else u+=l}return e.length>0?{errors:e,str:u}:u}}],[{key:"endOfQuote",value:function(e,t){for(var n=e[t];n&&'"'!==n;)n=e[t+="\\"===n?2:1];return t+1}}]),n}(r.b),g=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(){return Object(r.j)(this,n),t.apply(this,arguments)}return Object(r.i)(n,[{key:"parse",value:function(e,t){this.context=e;var i=e.src,a=n.endOfQuote(i,t+1);return this.valueRange=new r.d(t,a),a=r.b.endOfWhiteSpace(i,a),a=this.parseComment(a)}},{key:"strValue",get:function(){if(!this.valueRange||!this.context)return null;var e=[],t=this.valueRange,n=t.start,i=t.end,a=this.context,o=a.indent,s=a.src;"'"!==s[i-1]&&e.push(new r.f(this,"Missing closing 'quote"));for(var u="",c=n+1;c<i-1;++c){var l=s[c];if("\n"===l){r.b.atDocumentBoundary(s,c+1)&&e.push(new r.n(this,"Document boundary indicators are not allowed within string values"));var f=r.b.foldNewline(s,c,o);u+=f.fold,c=f.offset,f.error&&e.push(new r.n(this,"Multi-line single-quoted string needs to be sufficiently indented"))}else if("'"===l)u+=l,"'"!==s[c+=1]&&e.push(new r.f(this,"Unescaped single quote? This should not happen."));else if(" "===l||"\t"===l){for(var p=c,h=s[c+1];" "===h||"\t"===h;)h=s[(c+=1)+1];"\n"!==h&&(u+=c>p?s.slice(p,c+1):l)}else u+=l}return e.length>0?{errors:e,str:u}:u}}],[{key:"endOfQuote",value:function(e,t){for(var n=e[t];n;)if("'"===n){if("'"!==e[t+1])break;n=e[t+=2]}else n=e[t+=1];return t+1}}]),n}(r.b);function y(e,t){switch(e){case r.e.ALIAS:return new f(e,t);case r.e.BLOCK_FOLDED:case r.e.BLOCK_LITERAL:return new v(e,t);case r.e.FLOW_MAP:case r.e.FLOW_SEQ:return new m(e,t);case r.e.MAP_KEY:case r.e.MAP_VALUE:case r.e.SEQ_ITEM:return new a(e,t);case r.e.COMMENT:case r.e.PLAIN:return new r.c(e,t);case r.e.QUOTE_DOUBLE:return new b(e,t);case r.e.QUOTE_SINGLE:return new g(e,t);default:return null}}var O=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=i.atLineStart,o=i.inCollection,s=i.inFlow,c=i.indent,l=i.lineStart,f=i.parent;Object(r.j)(this,e),Object(r.l)(this,"parseNode",(function(n,i){if(r.b.atDocumentBoundary(t.src,i))return null;var a=new e(t,n),o=a.parseProps(i),s=o.props,c=o.type,l=o.valueStart,f=y(c,s),p=f.parse(a,l);if(f.range=new r.d(i,p),p<=i&&(f.error=new Error("Node#parse consumed no characters"),f.error.parseEnd=p,f.error.source=f,f.range.end=i+1),a.nodeStartsCollection(f)){f.error||a.atLineStart||a.parent.type!==r.e.DOCUMENT||(f.error=new r.f(f,"Block collection must not have preceding content here (e.g. directives-end indicator)"));var h=new u(f);return p=h.parse(new e(a),p),h.range=new r.d(i,p),h}return f})),this.atLineStart=null!=a?a:n.atLineStart||!1,this.inCollection=null!=o?o:n.inCollection||!1,this.inFlow=null!=s?s:n.inFlow||!1,this.indent=null!=c?c:n.indent,this.lineStart=null!=l?l:n.lineStart,this.parent=null!=f?f:n.parent||{},this.root=n.root,this.src=n.src}return Object(r.i)(e,null,[{key:"parseType",value:function(e,t,n){switch(e[t]){case"*":return r.e.ALIAS;case">":return r.e.BLOCK_FOLDED;case"|":return r.e.BLOCK_LITERAL;case"{":return r.e.FLOW_MAP;case"[":return r.e.FLOW_SEQ;case"?":return!n&&r.b.atBlank(e,t+1,!0)?r.e.MAP_KEY:r.e.PLAIN;case":":return!n&&r.b.atBlank(e,t+1,!0)?r.e.MAP_VALUE:r.e.PLAIN;case"-":return!n&&r.b.atBlank(e,t+1,!0)?r.e.SEQ_ITEM:r.e.PLAIN;case'"':return r.e.QUOTE_DOUBLE;case"'":return r.e.QUOTE_SINGLE;default:return r.e.PLAIN}}}]),Object(r.i)(e,[{key:"nodeStartsCollection",value:function(e){var t=this.inCollection,n=this.inFlow,i=this.src;if(t||n)return!1;if(e instanceof a)return!0;var o=e.range.end;return"\n"!==i[o]&&"\n"!==i[o-1]&&":"===i[o=r.b.endOfWhiteSpace(i,o)]}},{key:"parseProps",value:function(t){for(var n=this.inFlow,i=this.parent,a=this.src,o=[],s=!1,u=a[t=this.atLineStart?r.b.endOfIndent(a,t):r.b.endOfWhiteSpace(a,t)];u===r.a.ANCHOR||u===r.a.COMMENT||u===r.a.TAG||"\n"===u;){if("\n"===u){var c=t+1,l=r.b.endOfIndent(a,c),f=l-(c+this.indent),p=i.type===r.e.SEQ_ITEM&&i.context.atLineStart;if(!r.b.nextNodeIsIndented(a[l],f,!p))break;this.atLineStart=!0,this.lineStart=c,s=!1,t=l}else if(u===r.a.COMMENT){var h=r.b.endOfLine(a,t+1);o.push(new r.d(t,h)),t=h}else{var d=r.b.endOfIdentifier(a,t+1);u===r.a.TAG&&","===a[d]&&/^[a-zA-Z0-9-]+\.[a-zA-Z0-9-]+,\d\d\d\d(-\d\d){0,2}\/\S/.test(a.slice(t+1,d+13))&&(d=r.b.endOfIdentifier(a,d+5)),o.push(new r.d(t,d)),s=!0,t=r.b.endOfWhiteSpace(a,d)}u=a[t]}return s&&":"===u&&r.b.atBlank(a,t+1,!0)&&(t-=1),{props:o,type:e.parseType(a,t,n),valueStart:t}}}]),e}();function w(e){var t=[];-1!==e.indexOf("\r")&&(e=e.replace(/\r\n?/g,(function(e,n){return e.length>1&&t.push(n),"\n"})));var n=[],r=0;do{var i=new l,a=new O({src:e});r=i.parse(a,r),n.push(i)}while(r<e.length);return n.setOrigRanges=function(){if(0===t.length)return!1;for(var e=1;e<t.length;++e)t[e]-=e;for(var r=0,i=0;i<n.length;++i)r=n[i].setOrigRanges(t,r);return t.splice(0,t.length),!0},n.toString=function(){return n.join("...\n")},n}var j=n(1),x=n(4);var E={createNode:function(e,t,n){var i=new j.k(e);if(t instanceof Map){var a,o=Object(r.g)(t);try{for(o.s();!(a=o.n()).done;){var s=Object(r.o)(a.value,2),u=s[0],c=s[1];i.items.push(e.createPair(u,c,n))}}catch(e){o.e(e)}finally{o.f()}}else if(t&&"object"===Object(r.h)(t))for(var l=0,f=Object.keys(t);l<f.length;l++){var p=f[l];i.items.push(e.createPair(p,t[p],n))}return"function"==typeof e.sortMapEntries&&i.items.sort(e.sortMapEntries),i},default:!0,nodeClass:j.k,tag:"tag:yaml.org,2002:map",resolve:j.n};var S={createNode:function(e,t,n){var i=new j.g(e);if(t&&t[Symbol.iterator]){var a,o=Object(r.g)(t);try{for(o.s();!(a=o.n()).done;){var s=a.value,u=e.createNode(s,n.wrapScalars,null,n);i.items.push(u)}}catch(e){o.e(e)}finally{o.f()}}return i},default:!0,nodeClass:j.g,tag:"tag:yaml.org,2002:seq",resolve:j.o},P={identify:function(e){return"string"==typeof e},default:!0,tag:"tag:yaml.org,2002:str",resolve:j.q,stringify:function(e,t,n,r){return t=Object.assign({actualString:!0},t),Object(j.j)(e,t,n,r)},options:j.v},k=[E,S,P],A=function(e){return"bigint"==typeof e||Number.isInteger(e)},N=function(e,t,n){return j.p.asBigInt?BigInt(e):parseInt(t,n)};function V(e,t,n){var r=e.value;return A(r)&&r>=0?n+r.toString(t):Object(j.r)(e)}var D={identify:function(e){return null==e},createNode:function(e,t,n){return n.wrapScalars?new j.f(null):null},default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:function(){return null},options:j.t,stringify:function(){return j.t.nullStr}},T={identify:function(e){return"boolean"==typeof e},default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:function(e){return"t"===e[0]||"T"===e[0]},options:j.h,stringify:function(e){return e.value?j.h.trueStr:j.h.falseStr}},L={identify:function(e){return A(e)&&e>=0},default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o([0-7]+)$/,resolve:function(e,t){return N(e,t,8)},options:j.p,stringify:function(e){return V(e,8,"0o")}},R={identify:A,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:function(e){return N(e,e,10)},options:j.p,stringify:j.r},I={identify:function(e){return A(e)&&e>=0},default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x([0-9a-fA-F]+)$/,resolve:function(e,t){return N(e,t,16)},options:j.p,stringify:function(e){return V(e,16,"0x")}},M={identify:function(e){return"number"==typeof e},default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.inf|(\.nan))$/i,resolve:function(e,t){return t?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY},stringify:j.r},_={identify:function(e){return"number"==typeof e},default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:function(e){return parseFloat(e)},stringify:function(e){var t=e.value;return Number(t).toExponential()}},C={identify:function(e){return"number"==typeof e},default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.([0-9]+)|[0-9]+\.([0-9]*))$/,resolve:function(e,t,n){var r=t||n,i=new j.f(parseFloat(e));return r&&"0"===r[r.length-1]&&(i.minFractionDigits=r.length),i},stringify:j.r},B=k.concat([D,T,L,R,I,M,_,C]),U=function(e){return"bigint"==typeof e||Number.isInteger(e)},q=function(e){var t=e.value;return JSON.stringify(t)},$=[E,S,{identify:function(e){return"string"==typeof e},default:!0,tag:"tag:yaml.org,2002:str",resolve:j.q,stringify:q},{identify:function(e){return null==e},createNode:function(e,t,n){return n.wrapScalars?new j.f(null):null},default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:function(){return null},stringify:q},{identify:function(e){return"boolean"==typeof e},default:!0,tag:"tag:yaml.org,2002:bool",test:/^true|false$/,resolve:function(e){return"true"===e},stringify:q},{identify:U,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:function(e){return j.p.asBigInt?BigInt(e):parseInt(e,10)},stringify:function(e){var t=e.value;return U(t)?t.toString():JSON.stringify(t)}},{identify:function(e){return"number"==typeof e},default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:function(e){return parseFloat(e)},stringify:q}];$.scalarFallback=function(e){throw new SyntaxError("Unresolved plain scalar ".concat(JSON.stringify(e)))};var K=function(e){return e.value?j.h.trueStr:j.h.falseStr},F=function(e){return"bigint"==typeof e||Number.isInteger(e)};function Y(e,t,n){var r=t.replace(/_/g,"");if(j.p.asBigInt){switch(n){case 2:r="0b".concat(r);break;case 8:r="0o".concat(r);break;case 16:r="0x".concat(r)}var i=BigInt(r);return"-"===e?BigInt(-1)*i:i}var a=parseInt(r,n);return"-"===e?-1*a:a}function W(e,t,n){var r=e.value;if(F(r)){var i=r.toString(t);return r<0?"-"+n+i.substr(1):n+i}return Object(j.r)(e)}var J=k.concat([{identify:function(e){return null==e},createNode:function(e,t,n){return n.wrapScalars?new j.f(null):null},default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:function(){return null},options:j.t,stringify:function(){return j.t.nullStr}},{identify:function(e){return"boolean"==typeof e},default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:function(){return!0},options:j.h,stringify:K},{identify:function(e){return"boolean"==typeof e},default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/i,resolve:function(){return!1},options:j.h,stringify:K},{identify:F,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^([-+]?)0b([0-1_]+)$/,resolve:function(e,t,n){return Y(t,n,2)},stringify:function(e){return W(e,2,"0b")}},{identify:F,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^([-+]?)0([0-7_]+)$/,resolve:function(e,t,n){return Y(t,n,8)},stringify:function(e){return W(e,8,"0")}},{identify:F,default:!0,tag:"tag:yaml.org,2002:int",test:/^([-+]?)([0-9][0-9_]*)$/,resolve:function(e,t,n){return Y(t,n,10)},stringify:j.r},{identify:F,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^([-+]?)0x([0-9a-fA-F_]+)$/,resolve:function(e,t,n){return Y(t,n,16)},stringify:function(e){return W(e,16,"0x")}},{identify:function(e){return"number"==typeof e},default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.inf|(\.nan))$/i,resolve:function(e,t){return t?NaN:"-"===e[0]?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY},stringify:j.r},{identify:function(e){return"number"==typeof e},default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?([0-9][0-9_]*)?(\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:function(e){return parseFloat(e.replace(/_/g,""))},stringify:function(e){var t=e.value;return Number(t).toExponential()}},{identify:function(e){return"number"==typeof e},default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.([0-9_]*)$/,resolve:function(e,t){var n=new j.f(parseFloat(e.replace(/_/g,"")));if(t){var r=t.replace(/_/g,"");"0"===r[r.length-1]&&(n.minFractionDigits=r.length)}return n},stringify:j.r}],x.b,x.e,x.f,x.g,x.d,x.c,x.h),Q={core:B,failsafe:k,json:$,yaml11:J},G={binary:x.b,bool:T,float:C,floatExp:_,floatNaN:M,floatTime:x.c,int:R,intHex:I,intOct:L,intTime:x.d,map:E,null:D,omap:x.e,pairs:x.f,seq:S,set:x.g,timestamp:x.h};function z(e,t,n){if(e instanceof j.d)return e;var i=n.defaultPrefix,a=n.onTagObj,o=n.prevObjects,s=n.schema,u=n.wrapScalars;t&&t.startsWith("!!")&&(t=i+t.slice(2));var c=function(e,t,n){if(t){var r=n.filter((function(e){return e.tag===t})),i=r.find((function(e){return!e.format}))||r[0];if(!i)throw new Error("Tag ".concat(t," not found"));return i}return n.find((function(t){return(t.identify&&t.identify(e)||t.class&&e instanceof t.class)&&!t.format}))}(e,t,s.tags);if(!c){if("function"==typeof e.toJSON&&(e=e.toJSON()),"object"!==Object(r.h)(e))return u?new j.f(e):e;c=e instanceof Map?E:e[Symbol.iterator]?S:E}a&&(a(c),delete n.onTagObj);var l={};if(e&&"object"===Object(r.h)(e)&&o){var f=o.get(e);if(f){var p=new j.a(f);return n.aliasNodes.push(p),p}l.value=e,o.set(e,l)}return l.node=c.createNode?c.createNode(n.schema,e,n):u?new j.f(e):e,t&&l.node instanceof j.d&&(l.node.tag=t),l.node}var H=function(e,t){return e.key<t.key?-1:e.key>t.key?1:0},Z=function(){function e(t){var n=t.customTags,i=t.merge,a=t.schema,o=t.sortMapEntries,s=t.tags;Object(r.j)(this,e),this.merge=!!i,this.name=a,this.sortMapEntries=!0===o?H:o||null,!n&&s&&Object(x.a)("tags","customTags"),this.tags=function(e,t,n,i){var a=e[i.replace(/\W/g,"")];if(!a){var o=Object.keys(e).map((function(e){return JSON.stringify(e)})).join(", ");throw new Error('Unknown schema "'.concat(i,'"; use one of ').concat(o))}if(Array.isArray(n)){var s,u=Object(r.g)(n);try{for(u.s();!(s=u.n()).done;){var c=s.value;a=a.concat(c)}}catch(e){u.e(e)}finally{u.f()}}else"function"==typeof n&&(a=n(a.slice()));for(var l=0;l<a.length;++l){var f=a[l];if("string"==typeof f){var p=t[f];if(!p){var h=Object.keys(t).map((function(e){return JSON.stringify(e)})).join(", ");throw new Error('Unknown custom tag "'.concat(f,'"; use one of ').concat(h))}a[l]=p}}return a}(Q,G,n||s,a)}return Object(r.i)(e,[{key:"createNode",value:function(t,n,r,i){var a={defaultPrefix:e.defaultPrefix,schema:this,wrapScalars:n};return z(t,r,i?Object.assign(i,a):a)}},{key:"createPair",value:function(e,t,n){n||(n={wrapScalars:!0});var r=this.createNode(e,n.wrapScalars,null,n),i=this.createNode(t,n.wrapScalars,null,n);return new j.e(r,i)}}]),e}();Object(r.l)(Z,"defaultPrefix",r.k),Object(r.l)(Z,"defaultTags",r.u);var X={anchorPrefix:"a",customTags:null,indent:2,indentSeq:!0,keepCstNodes:!1,keepNodeTypes:!0,keepBlobsInJSON:!0,mapAsMap:!1,maxAliasCount:100,prettyErrors:!1,simpleKeys:!1,version:"1.2"},ee={get binary(){return j.i},set binary(e){Object.assign(j.i,e)},get bool(){return j.h},set bool(e){Object.assign(j.h,e)},get int(){return j.p},set int(e){Object.assign(j.p,e)},get null(){return j.t},set null(e){Object.assign(j.t,e)},get str(){return j.v},set str(e){Object.assign(j.v,e)}},te={"1.0":{schema:"yaml-1.1",merge:!0,tagPrefixes:[{handle:"!",prefix:r.k},{handle:"!!",prefix:"tag:private.yaml.org,2002:"}]},1.1:{schema:"yaml-1.1",merge:!0,tagPrefixes:[{handle:"!",prefix:"!"},{handle:"!!",prefix:r.k}]},1.2:{schema:"core",merge:!1,tagPrefixes:[{handle:"!",prefix:"!"},{handle:"!!",prefix:r.k}]}};function ne(e,t){if("1.0"===(e.version||e.options.version)){var n=t.match(/^tag:private\.yaml\.org,2002:([^:/]+)$/);if(n)return"!"+n[1];var r=t.match(/^tag:([a-zA-Z0-9-]+)\.yaml\.org,2002:(.*)/);return r?"!".concat(r[1],"/").concat(r[2]):"!".concat(t.replace(/^tag:/,""))}var i=e.tagPrefixes.find((function(e){return 0===t.indexOf(e.prefix)}));if(!i){var a=e.getDefaults().tagPrefixes;i=a&&a.find((function(e){return 0===t.indexOf(e.prefix)}))}if(!i)return"!"===t[0]?t:"!<".concat(t,">");var o=t.substr(i.prefix.length).replace(/[!,[\]{}]/g,(function(e){return{"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"}[e]}));return i.handle+o}function re(e,t,n,i){var a,o=t.doc,s=o.anchors,u=o.schema;if(!(e instanceof j.d)){var c={aliasNodes:[],onTagObj:function(e){return a=e},prevObjects:new Map};e=u.createNode(e,!0,null,c);var l,f=Object(r.g)(c.aliasNodes);try{for(f.s();!(l=f.n()).done;){var p=l.value;p.source=p.source.node;var h=s.getName(p.source);h||(h=s.newName(),s.map[h]=p.source)}}catch(e){f.e(e)}finally{f.f()}}if(e instanceof j.e)return e.toString(t,n,i);a||(a=function(e,t){if(t instanceof j.a)return j.a;if(t.tag){var n=e.filter((function(e){return e.tag===t.tag}));if(n.length>0)return n.find((function(e){return e.format===t.format}))||n[0]}var i,a;if(t instanceof j.f){a=t.value;var o=e.filter((function(e){return e.identify&&e.identify(a)||e.class&&a instanceof e.class}));i=o.find((function(e){return e.format===t.format}))||o.find((function(e){return!e.format}))}else a=t,i=e.find((function(e){return e.nodeClass&&a instanceof e.nodeClass}));if(!i){var s=a&&a.constructor?a.constructor.name:Object(r.h)(a);throw new Error("Tag not resolved for ".concat(s," value"))}return i}(u.tags,e));var d=function(e,t,n){var r=n.anchors,i=n.doc,a=[],o=i.anchors.getName(e);return o&&(r[o]=e,a.push("&".concat(o))),e.tag?a.push(ne(i,e.tag)):t.default||a.push(ne(i,t.tag)),a.join(" ")}(e,a,t);d.length>0&&(t.indentAtStart=(t.indentAtStart||0)+d.length+1);var v="function"==typeof a.stringify?a.stringify(e,t,n,i):e instanceof j.f?Object(j.j)(e,t,n,i):e.toString(t,n,i);return d?e instanceof j.f||"{"===v[0]||"["===v[0]?"".concat(d," ").concat(v):"".concat(d,"\n").concat(t.indent).concat(v):v}var ie=function(){function e(t){Object(r.j)(this,e),Object(r.l)(this,"map",{}),this.prefix=t}return Object(r.i)(e,null,[{key:"validAnchorNode",value:function(e){return e instanceof j.f||e instanceof j.g||e instanceof j.k}}]),Object(r.i)(e,[{key:"createAlias",value:function(e,t){return this.setAnchor(e,t),new j.a(e)}},{key:"createMergePair",value:function(){for(var e=this,t=new j.c,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.value.items=r.map((function(t){if(t instanceof j.a){if(t.source instanceof j.k)return t}else if(t instanceof j.k)return e.createAlias(t);throw new Error("Merge sources must be Map nodes or their Aliases")})),t}},{key:"getName",value:function(e){var t=this.map;return Object.keys(t).find((function(n){return t[n]===e}))}},{key:"getNames",value:function(){return Object.keys(this.map)}},{key:"getNode",value:function(e){return this.map[e]}},{key:"newName",value:function(e){e||(e=this.prefix);for(var t=Object.keys(this.map),n=1;;++n){var r="".concat(e).concat(n);if(!t.includes(r))return r}}},{key:"resolveNodes",value:function(){var e=this.map,t=this._cstAliases;Object.keys(e).forEach((function(t){e[t]=e[t].resolved})),t.forEach((function(e){e.source=e.source.resolved})),delete this._cstAliases}},{key:"setAnchor",value:function(t,n){if(null!=t&&!e.validAnchorNode(t))throw new Error("Anchors may only be set for Scalar, Seq and Map nodes");if(n&&/[\x00-\x19\s,[\]{}]/.test(n))throw new Error("Anchor names must not contain whitespace or control characters");var r=this.map,i=t&&Object.keys(r).find((function(e){return r[e]===t}));if(i){if(!n)return i;i!==n&&(delete r[i],r[n]=t)}else{if(!n){if(!t)return null;n=this.newName()}r[n]=t}return n}}]),e}(),ae=function(e){return Object.keys(function e(t,n){if(t&&"object"===Object(r.h)(t)){var i=t.tag;t instanceof j.b?(i&&(n[i]=!0),t.items.forEach((function(t){return e(t,n)}))):t instanceof j.e?(e(t.key,n),e(t.value,n)):t instanceof j.f&&i&&(n[i]=!0)}return n}(e,{}))};function oe(e,t){var n=e.tagPrefixes,i=Object(r.o)(t.parameters,2),a=i[0],o=i[1];if(!a||!o){throw new r.n(t,"Insufficient parameters given for %TAG directive")}if(n.some((function(e){return e.handle===a}))){throw new r.n(t,"The %TAG directive must only be given at most once per handle in the same document.")}return{handle:a,prefix:o}}function se(e,t){var n=Object(r.o)(t.parameters,1)[0];if("YAML:1.0"===t.name&&(n="1.0"),!n){throw new r.n(t,"Insufficient parameters given for %YAML directive")}if(!te[n]){var i=e.version||e.options.version,a="Document will be parsed as YAML ".concat(i," rather than YAML ").concat(n);e.warnings.push(new r.m(t,a))}return n}function ue(e){if(e instanceof j.b)return!0;throw new Error("Expected a YAML collection as document contents")}var ce=function(){function e(t){Object(r.j)(this,e),this.anchors=new ie(t.anchorPrefix),this.commentBefore=null,this.comment=null,this.contents=null,this.directivesEndMarker=null,this.errors=[],this.options=t,this.schema=null,this.tagPrefixes=[],this.version=null,this.warnings=[]}return Object(r.i)(e,[{key:"add",value:function(e){return ue(this.contents),this.contents.add(e)}},{key:"addIn",value:function(e,t){ue(this.contents),this.contents.addIn(e,t)}},{key:"delete",value:function(e){return ue(this.contents),this.contents.delete(e)}},{key:"deleteIn",value:function(e){return Object(j.l)(e)?null!=this.contents&&(this.contents=null,!0):(ue(this.contents),this.contents.deleteIn(e))}},{key:"getDefaults",value:function(){return e.defaults[this.version]||e.defaults[this.options.version]||{}}},{key:"get",value:function(e,t){return this.contents instanceof j.b?this.contents.get(e,t):void 0}},{key:"getIn",value:function(e,t){return Object(j.l)(e)?!t&&this.contents instanceof j.f?this.contents.value:this.contents:this.contents instanceof j.b?this.contents.getIn(e,t):void 0}},{key:"has",value:function(e){return this.contents instanceof j.b&&this.contents.has(e)}},{key:"hasIn",value:function(e){return Object(j.l)(e)?void 0!==this.contents:this.contents instanceof j.b&&this.contents.hasIn(e)}},{key:"set",value:function(e,t){ue(this.contents),this.contents.set(e,t)}},{key:"setIn",value:function(e,t){Object(j.l)(e)?this.contents=t:(ue(this.contents),this.contents.setIn(e,t))}},{key:"setSchema",value:function(e,t){if(e||t||!this.schema){"number"==typeof e&&(e=e.toFixed(1)),"1.0"===e||"1.1"===e||"1.2"===e?(this.version?this.version=e:this.options.version=e,delete this.options.schema):e&&"string"==typeof e&&(this.options.schema=e),Array.isArray(t)&&(this.options.customTags=t);var n=Object.assign({},this.getDefaults(),this.options);this.schema=new Z(n)}}},{key:"parse",value:function(e,t){this.options.keepCstNodes&&(this.cstNode=e),this.options.keepNodeTypes&&(this.type="DOCUMENT");var n=e.directives,i=void 0===n?[]:n,a=e.contents,o=void 0===a?[]:a,s=e.directivesEndMarker,u=e.error,c=e.valueRange;if(u&&(u.source||(u.source=this),this.errors.push(u)),function(e,t,n){var i,a=[],o=!1,s=Object(r.g)(t);try{for(s.s();!(i=s.n()).done;){var u=i.value,c=u.comment,l=u.name;switch(l){case"TAG":try{e.tagPrefixes.push(oe(e,u))}catch(t){e.errors.push(t)}o=!0;break;case"YAML":case"YAML:1.0":if(e.version){e.errors.push(new r.n(u,"The %YAML directive must only be given at most once per document."))}try{e.version=se(e,u)}catch(t){e.errors.push(t)}o=!0;break;default:if(l){var f="YAML only supports %TAG and %YAML directives, and not %".concat(l);e.warnings.push(new r.m(u,f))}}c&&a.push(c)}}catch(e){s.e(e)}finally{s.f()}if(n&&!o&&"1.1"===(e.version||n.version||e.options.version)){e.tagPrefixes=n.tagPrefixes.map((function(e){return{handle:e.handle,prefix:e.prefix}})),e.version=n.version}e.commentBefore=a.join("\n")||null}(this,i,t),s&&(this.directivesEndMarker=!0),this.range=c?[c.start,c.end]:null,this.setSchema(),this.anchors._cstAliases=[],function(e,t){var n,i={before:[],after:[]},a=void 0,o=!1,s=Object(r.g)(t);try{for(s.s();!(n=s.n()).done;){var u=n.value;if(u.valueRange){if(void 0!==a){e.errors.push(new r.f(u,"Document contains trailing content not separated by a ... or --- line"));break}var c=Object(j.u)(e,u);o&&(c.spaceBefore=!0,o=!1),a=c}else if(null!==u.comment){(void 0===a?i.before:i.after).push(u.comment)}else u.type===r.e.BLANK_LINE&&(o=!0,void 0===a&&i.before.length>0&&!e.commentBefore&&(e.commentBefore=i.before.join("\n"),i.before=[]))}}catch(e){s.e(e)}finally{s.f()}if(e.contents=a||null,a){var l=i.before.join("\n");if(l){var f=a instanceof j.b&&a.items[0]?a.items[0]:a;f.commentBefore=f.commentBefore?"".concat(l,"\n").concat(f.commentBefore):l}e.comment=i.after.join("\n")||null}else e.comment=i.before.concat(i.after).join("\n")||null}(this,o),this.anchors.resolveNodes(),this.options.prettyErrors){var l,f=Object(r.g)(this.errors);try{for(f.s();!(l=f.n()).done;){var p=l.value;p instanceof r.p&&p.makePretty()}}catch(e){f.e(e)}finally{f.f()}var h,d=Object(r.g)(this.warnings);try{for(d.s();!(h=d.n()).done;){var v=h.value;v instanceof r.p&&v.makePretty()}}catch(e){d.e(e)}finally{d.f()}}return this}},{key:"listNonDefaultTags",value:function(){return ae(this.contents).filter((function(e){return 0!==e.indexOf(Z.defaultPrefix)}))}},{key:"setTagPrefix",value:function(e,t){if("!"!==e[0]||"!"!==e[e.length-1])throw new Error("Handle must start and end with !");if(t){var n=this.tagPrefixes.find((function(t){return t.handle===e}));n?n.prefix=t:this.tagPrefixes.push({handle:e,prefix:t})}else this.tagPrefixes=this.tagPrefixes.filter((function(t){return t.handle!==e}))}},{key:"toJSON",value:function(e,t){var n=this,i=this.options,a=i.keepBlobsInJSON,o=i.mapAsMap,s=i.maxAliasCount,u=a&&("string"!=typeof e||!(this.contents instanceof j.f)),c={doc:this,indentStep:"  ",keep:u,mapAsMap:u&&!!o,maxAliasCount:s,stringify:re},l=Object.keys(this.anchors.map);l.length>0&&(c.anchors=new Map(l.map((function(e){return[n.anchors.map[e],{alias:[],aliasCount:0,count:1}]}))));var f=Object(j.w)(this.contents,e,c);if("function"==typeof t&&c.anchors){var p,h=Object(r.g)(c.anchors.values());try{for(h.s();!(p=h.n()).done;){var d=p.value,v=d.count;t(d.res,v)}}catch(e){h.e(e)}finally{h.f()}}return f}},{key:"toString",value:function(){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");var e=this.options.indent;if(!Number.isInteger(e)||e<=0){var t=JSON.stringify(e);throw new Error('"indent" option must be a positive integer, not '.concat(t))}this.setSchema();var n=[],r=!1;if(this.version){var i="%YAML 1.2";"yaml-1.1"===this.schema.name&&("1.0"===this.version?i="%YAML:1.0":"1.1"===this.version&&(i="%YAML 1.1")),n.push(i),r=!0}var a=this.listNonDefaultTags();this.tagPrefixes.forEach((function(e){var t=e.handle,i=e.prefix;a.some((function(e){return 0===e.indexOf(i)}))&&(n.push("%TAG ".concat(t," ").concat(i)),r=!0)})),(r||this.directivesEndMarker)&&n.push("---"),this.commentBefore&&(!r&&this.directivesEndMarker||n.unshift(""),n.unshift(this.commentBefore.replace(/^/gm,"#")));var o={anchors:{},doc:this,indent:"",indentStep:" ".repeat(e),stringify:re},s=!1,u=null;if(this.contents){this.contents instanceof j.d&&(this.contents.spaceBefore&&(r||this.directivesEndMarker)&&n.push(""),this.contents.commentBefore&&n.push(this.contents.commentBefore.replace(/^/gm,"#")),o.forceBlockIndent=!!this.comment,u=this.contents.comment);var c=u?null:function(){return s=!0},l=re(this.contents,o,(function(){return u=null}),c);n.push(Object(j.m)(l,"",u))}else void 0!==this.contents&&n.push(re(this.contents,o));return this.comment&&(s&&!u||""===n[n.length-1]||n.push(""),n.push(this.comment.replace(/^/gm,"#"))),n.join("\n")+"\n"}}]),e}();Object(r.l)(ce,"defaults",te);var le=function(e){Object(r.q)(n,e);var t=Object(r.r)(n);function n(e){return Object(r.j)(this,n),t.call(this,Object.assign({},X,e))}return n}(ce);function fe(e,t){var n=w(e),i=new le(t).parse(n[0]);if(n.length>1){i.errors.unshift(new r.n(n[1],"Source contains multiple documents; please use YAML.parseAllDocuments()"))}return i}var pe={createNode:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;void 0===n&&"string"==typeof t&&(n=t,t=!0);var r=Object.assign({},ce.defaults[X.version],X),i=new Z(r);return i.createNode(e,t,n)},defaultOptions:X,Document:le,parse:function(e,t){var n=fe(e,t);if(n.warnings.forEach((function(e){return Object(x.i)(e)})),n.errors.length>0)throw n.errors[0];return n.toJSON()},parseAllDocuments:function(e,t){var n,i,a=[],o=Object(r.g)(w(e));try{for(o.s();!(i=o.n()).done;){var s=i.value,u=new le(t);u.parse(s,n),a.push(u),n=u}}catch(e){o.e(e)}finally{o.f()}return a},parseCST:w,parseDocument:fe,scalarOptions:ee,stringify:function(e,t){var n=new le(t);return n.contents=e,String(n)}}}]);